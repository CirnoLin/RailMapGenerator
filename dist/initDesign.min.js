(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["initDesign"],{

/***/ "./src/PageInitialiser/design.ts":
/*!***************************************!*\
  !*** ./src/PageInitialiser/design.ts ***!
  \***************************************/
/*! exports provided: common, mtr, gzmtr */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "common", function() { return common; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mtr", function() { return mtr; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "gzmtr", function() { return gzmtr; });
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils */ "./src/utils.ts");
/* harmony import */ var _material_list__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @material/list */ "@material/list");
/* harmony import */ var _material_list__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_material_list__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _material_dialog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @material/dialog */ "@material/dialog");
/* harmony import */ var _material_dialog__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_material_dialog__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _material_select__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @material/select */ "@material/select");
/* harmony import */ var _material_select__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_material_select__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _material_textfield__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @material/textfield */ "@material/textfield");
/* harmony import */ var _material_textfield__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_material_textfield__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _material_switch__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @material/switch */ "@material/switch");
/* harmony import */ var _material_switch__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_material_switch__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _material_ripple__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @material/ripple */ "@material/ripple");
/* harmony import */ var _material_ripple__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_material_ripple__WEBPACK_IMPORTED_MODULE_6__);







function common() {
    // mdc instances
    const designList = _material_list__WEBPACK_IMPORTED_MODULE_1__["MDCList"].attachTo($('#design_list')[0]);
    const [themeDialog, lineNameDialog] = ['#design_theme_diag', '#line_name_diag'].map(selector => _material_dialog__WEBPACK_IMPORTED_MODULE_2__["MDCDialog"].attachTo($(selector)[0]));
    const [themeCitySelect, themeLineSelect] = ['#theme_city', '#theme_line'].map(selector => new _material_select__WEBPACK_IMPORTED_MODULE_3__["MDCSelect"]($(selector)[0]));
    // const themeCitySelect = new MDCSelect($('#theme_city')[0]);
    // const themeLineSelect = new MDCSelect($('#theme_line')[0]);
    const [lineNameZHTextField, lineNameENTextField] = ['#name_zh', '#name_en'].map(selector => _material_textfield__WEBPACK_IMPORTED_MODULE_4__["MDCTextField"].attachTo($('#line_name_diag').find(selector)[0]));
    const platformNumTextField = _material_textfield__WEBPACK_IMPORTED_MODULE_4__["MDCTextField"].attachTo($('#platform_num')[0]);
    $('#panel_design .mdc-list li').map((_, el) => new _material_ripple__WEBPACK_IMPORTED_MODULE_6__["MDCRipple"](el));
    // helper functions
    const getDirectionText = (direc) => {
        return $('#design_list')
            .find(`li#direc p#${direc}`)
            .text();
    };
    // init values
    Promise.resolve(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])())
        .then(param => {
        $('#design_list')
            .find('li#name .mdc-list-item__secondary-text')
            .text(param.line_name.join());
        lineNameZHTextField.value = param.line_name[0];
        lineNameENTextField.value = param.line_name[1];
        $('#design_list')
            .find('li#direc .mdc-list-item__secondary-text')
            .text(getDirectionText(param.direction));
        platformNumTextField.value = param.platform_num;
    });
    $.getJSON('data/city_list.json', (data) => {
        let lang = window.urlParams.get('lang');
        data.forEach(c => {
            $('#theme_city__selection').append($('<li>', {
                class: 'mdc-list-item',
                'data-value': c.id
            }).text(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["countryCode2Emoji"])(c.country) + Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getTransText"])(c.name, lang)));
        });
        $('#theme_city__selection li').map((_, el) => new _material_ripple__WEBPACK_IMPORTED_MODULE_6__["MDCRipple"](el));
        var [themeCity] = Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])().theme;
        var cityIdx = $(`#theme_city__selection > [data-value="${themeCity}"]`).index();
        themeCitySelect.selectedIndex = cityIdx;
    });
    // add event listeners
    designList.listen('MDCList:action', (event) => {
        switch (event.detail.index) {
            case 0:
                themeDialog.open();
                break;
            case 1:
                lineNameDialog.open();
                break;
            case 2:
                if (Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])().direction == 'r') {
                    console.log('right to left');
                    window.myLine.direction = 'l';
                    $('#design_list').find('li#direc .mdc-list-item__secondary-text').text(getDirectionText('l'));
                }
                else {
                    console.log('left to right');
                    window.myLine.direction = 'r';
                    $('#design_list').find('li#direc .mdc-list-item__secondary-text').text(getDirectionText('r'));
                }
                break;
            case 4:
                window.myLine.reverseStns();
                break;
        }
    });
    themeDialog.listen('MDCDialog:opened', () => {
        [themeCitySelect, themeLineSelect].map(select => select.layout());
    });
    themeCitySelect.listen("MDCSelect:change", (event) => {
        let city = event.detail.value;
        $('#theme_line__selection').empty();
        $.getJSON(`data/${city}.json`, (data) => {
            var lang = window.urlParams.get('lang');
            data.forEach(l => {
                $('#theme_line__selection').append($('<li>', {
                    class: 'mdc-list-item',
                    'data-value': l.id
                }).append($('<span>').css({
                    background: l.colour,
                    color: l.fg || '#fff'
                }).text('\u00a0' + Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getTransText"])(l.name, lang) + '\u00a0')));
            });
            $('#theme_line__selection li').map((_, el) => new _material_ripple__WEBPACK_IMPORTED_MODULE_6__["MDCRipple"](el));
            var param = Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])();
            param.theme[0] = city;
            Object(_utils__WEBPACK_IMPORTED_MODULE_0__["putParams"])(param);
            var lineIdx = $(`#theme_line__selection > [data-value="${param.theme[1]}"]`).index();
            themeLineSelect.selectedIndex = lineIdx == -1 ? 0 : lineIdx;
        });
    });
    themeLineSelect.listen("MDCSelect:change", (event) => {
        let lineIdx = event.detail.index;
        var param = Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])();
        param.theme[1] = event.detail.value;
        Object(_utils__WEBPACK_IMPORTED_MODULE_0__["putParams"])(param);
        window.myLine.themeLine = event.detail.value;
        window.myLine.themeColour = ['background-color', 'color']
            .map(prop => $('#theme_line__selection span').eq(lineIdx).css(prop))
            .map(_utils__WEBPACK_IMPORTED_MODULE_0__["rgb2Hex"]);
        $('#design_list')
            .find('li#theme .mdc-list-item__secondary-text')
            .html($('#theme_city__selection li').eq(themeCitySelect.selectedIndex).text() +
            ' ' +
            $('#theme_line__selection li').eq(lineIdx).html().trim());
    });
    lineNameDialog.listen('MDCDialog:opened', event => {
        [lineNameZHTextField, lineNameENTextField].map(textfield => textfield.layout());
    });
    $('#line_name_diag')
        .find('.mdc-text-field')
        .on('input', () => {
        let lineNames = [lineNameZHTextField, lineNameENTextField].map(textfield => textfield.value);
        window.myLine.lineNames = lineNames;
        $('#design_list')
            .find('li#name .mdc-list-item__secondary-text')
            .text(lineNames.join());
    });
    $(platformNumTextField.root_).find('input')
        .on('input', event => window.myLine.platformNum = event.target.value);
}
function mtr() {
    // mdc instances
    const designListMTRList = _material_list__WEBPACK_IMPORTED_MODULE_1__["MDCList"].attachTo($('#design_list_mtr')[0]);
    const charDialog = _material_dialog__WEBPACK_IMPORTED_MODULE_2__["MDCDialog"].attachTo($('#design_char_diag')[0]);
    const legacySwitch = new _material_switch__WEBPACK_IMPORTED_MODULE_5__["MDCSwitch"]($('#legacy')[0]);
    // helper functions
    const getCharText = (char) => {
        return $('#design_char_diag')
            .find('li')
            .filter((_, el) => el.dataset.mdcDialogAction === char)
            .find('span')
            .text();
    };
    // init values
    Promise.resolve(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])())
        .then(param => {
        // $('#design_list_mtr')
        //     .find('li#char .mdc-list-item__secondary-text')
        //     .text(getCharText(param.char_form));
        $('#design_char_diag')[0].dispatchEvent(new CustomEvent('MDCDialog:closed', { detail: { action: param.char_form } }));
        // charDialog.close(param.char_form);
        legacySwitch.checked = param.dest_legacy;
    });
    // add event listeners
    designListMTRList.listen('MDCList:action', (event) => {
        switch (event.detail.index) {
            case 0:
                window.myLine.txtFlip = !Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])().txt_flip;
                break;
            case 1:
                charDialog.open();
                break;
        }
    });
    charDialog.listen('MDCDialog:closed', (event) => {
        let char = event.detail.action;
        if (char == 'close') {
            return;
        }
        window.myLine.charForm = char;
        $('#design_list_mtr')
            .find('li#char .mdc-list-item__secondary-text')
            .text(getCharText(char));
    });
    $(legacySwitch.root_).find('input')
        .on('change', event => window.myLine.destLegacy = event.target.checked);
}
function gzmtr() {
    // mdc instances
    const designListGZMTRList = _material_list__WEBPACK_IMPORTED_MODULE_1__["MDCList"].attachTo($('#design_list_gzmtr')[0]);
    const panelTypeDialog = _material_dialog__WEBPACK_IMPORTED_MODULE_2__["MDCDialog"].attachTo($('#panel_type_diag')[0]);
    const [psdNumTextField, lineNumTextField] = ['#psd_num', '#line_num'].map(selector => _material_textfield__WEBPACK_IMPORTED_MODULE_4__["MDCTextField"].attachTo($(selector)[0]));
    // init values
    Promise.resolve(Object(_utils__WEBPACK_IMPORTED_MODULE_0__["getParams"])())
        .then(param => {
        psdNumTextField.value = param.psd_num;
        lineNumTextField.value = param.line_num;
    });
    // add event listeners
    designListGZMTRList.listen('MDCList:action', (event) => {
        switch (event.detail.index) {
            case 1:
                panelTypeDialog.open();
                break;
        }
    });
    $(lineNumTextField.root_).find('input')
        .on('input', event => window.myLine.lineNum = event.target.value);
    $(psdNumTextField.root_).find('input')
        .on('input', event => window.myLine.psdNum = event.target.value);
    panelTypeDialog.listen('MDCDialog:closed', (event) => {
        if (event.detail.action === 'close') {
            return;
        }
        window.myLine.infoPanelType = event.detail.action;
    });
}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvUGFnZUluaXRpYWxpc2VyL2Rlc2lnbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFnRztBQUd2RDtBQUNJO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFHdEMsU0FBUyxNQUFNO0lBQ2xCLGdCQUFnQjtJQUNoQixNQUFNLFVBQVUsR0FBRyxzREFBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMxRCxNQUFNLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxHQUMvQixDQUFDLG9CQUFvQixFQUFFLGlCQUFpQixDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsMERBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsRyxNQUFNLENBQUMsZUFBZSxFQUFFLGVBQWUsQ0FBQyxHQUNwQyxDQUFDLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxJQUFJLDBEQUFTLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNsRiw4REFBOEQ7SUFDOUQsOERBQThEO0lBQzlELE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxtQkFBbUIsQ0FBQyxHQUM1QyxDQUFDLFVBQVUsRUFBRSxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxnRUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFD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LENBQUMsS0FBa0IsRUFBRSxFQUFFO1FBQzlELElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEtBQUssT0FBTyxFQUFFO1lBQUMsT0FBTztTQUFDO1FBQ2xDLE1BQU0sQ0FBQyxNQUFPLENBQUMsYUFBYSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQ25FLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyIsImZpbGUiOiJpbml0RGVzaWduLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFBhcmFtcywgcHV0UGFyYW1zLCBjb3VudHJ5Q29kZTJFbW9qaSwgZ2V0VHJhbnNUZXh0LCByZ2IySGV4LCBOYW1lIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBDaXR5RW50cnksIExpbmVFbnRyeSB9IGZyb20gJy4uL3V0aWxzJztcclxuaW1wb3J0IHsgUk1HTGluZUdaIH0gZnJvbSAnLi4vTGluZS9MaW5lR1onO1xyXG5pbXBvcnQgeyBNRENMaXN0IH0gZnJvbSAnQG1hdGVyaWFsL2xpc3QnO1xyXG5pbXBvcnQgeyBNRENEaWFsb2cgfSBmcm9tICdAbWF0ZXJpYWwvZGlhbG9nJztcclxuaW1wb3J0IHsgTURDU2VsZWN0IH0gZnJvbSAnQG1hdGVyaWFsL3NlbGVjdCc7XHJcbmltcG9ydCB7IE1EQ1RleHRGaWVsZCB9IGZyb20gJ0BtYXRlcmlhbC90ZXh0ZmllbGQnO1xyXG5pbXBvcnQgeyBNRENTd2l0Y2ggfSBmcm9tICdAbWF0ZXJpYWwvc3dpdGNoJztcclxuaW1wb3J0IHsgTURDUmlwcGxlIH0gZnJvbSAnQG1hdGVyaWFsL3JpcHBsZSc7XHJcbmltcG9ydCB7IFJNR0xpbmVISyB9IGZyb20gJy4uL0xpbmUvTGluZUhLJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21tb24oKSB7XHJcbiAgICAvLyBtZGMgaW5zdGFuY2VzXHJcbiAgICBjb25zdCBkZXNpZ25MaXN0ID0gTURDTGlzdC5hdHRhY2hUbygkKCcjZGVzaWduX2xpc3QnKVswXSk7XHJcbiAgICBjb25zdCBbdGhlbWVEaWFsb2csIGxpbmVOYW1lRGlhbG9nXSA9IFxyXG4gICAgICAgIFsnI2Rlc2lnbl90aGVtZV9kaWFnJywgJyNsaW5lX25hbWVfZGlhZyddLm1hcChzZWxlY3RvciA9PiBNRENEaWFsb2cuYXR0YWNoVG8oJChzZWxlY3RvcilbMF0pKTtcclxuICAgIGNvbnN0IFt0aGVtZUNpdHlTZWxlY3QsIHRoZW1lTGluZVNlbGVjdF0gPSBcclxuICAgICAgICBbJyN0aGVtZV9jaXR5JywgJyN0aGVtZV9saW5lJ10ubWFwKHNlbGVjdG9yID0+IG5ldyBNRENTZWxlY3QoJChzZWxlY3RvcilbMF0pKTtcclxuICAgIC8vIGNvbnN0IHRoZW1lQ2l0eVNlbGVjdCA9IG5ldyBNRENTZWxlY3QoJCgnI3RoZW1lX2NpdHknKVswXSk7XHJcbiAgICAvLyBjb25zdCB0aGVtZUxpbmVTZWxlY3QgPSBuZXcgTURDU2VsZWN0KCQoJyN0aGVtZV9saW5lJylbMF0pO1xyXG4gICAgY29uc3QgW2xpbmVOYW1lWkhUZXh0RmllbGQsIGxpbmVOYW1lRU5UZXh0RmllbGRdID0gXHJcbiAgICAgICAgWycjbmFtZV96aCcsICcjbmFtZV9lbiddLm1hcChzZWxlY3RvciA9PiBNRENUZXh0RmllbGQuYXR0YWNoVG8oJCgnI2xpbmVfbmFtZV9kaWFnJykuZmluZChzZWxlY3RvcilbMF0pKTtcclxuICAgIGNvbnN0IHBsYXRmb3JtTnVtVGV4dEZpZWxkID0gTURDVGV4dEZpZWxkLmF0dGFjaFRvKCQoJyNwbGF0Zm9ybV9udW0nKVswXSk7XHJcbiAgICAkKCcjcGFuZWxfZGVzaWduIC5tZGMtbGlzdCBsaScpLm1hcCgoXyxlbCkgPT4gbmV3IE1EQ1JpcHBsZShlbCkpO1xyXG5cclxuICAgIC8vIGhlbHBlciBmdW5jdGlvbnNcclxuICAgIGNvbnN0IGdldERpcmVjdGlvblRleHQgPSAoZGlyZWM6ICdsJyB8ICdyJykgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGVzaWduX2xpc3QnKVxyXG4gICAgICAgICAgICAuZmluZChgbGkjZGlyZWMgcCMke2RpcmVjfWApXHJcbiAgICAgICAgICAgIC50ZXh0KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGluaXQgdmFsdWVzXHJcbiAgICBQcm9taXNlLnJlc29sdmUoZ2V0UGFyYW1zKCkpXHJcbiAgICAgICAgLnRoZW4ocGFyYW0gPT4ge1xyXG4gICAgICAgICAgICAkKCcjZGVzaWduX2xpc3QnKVxyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2xpI25hbWUgLm1kYy1saXN0LWl0ZW1fX3NlY29uZGFyeS10ZXh0JylcclxuICAgICAgICAgICAgICAgIC50ZXh0KHBhcmFtLmxpbmVfbmFtZS5qb2luKCkpO1xyXG4gICAgICAgICAgICBsaW5lTmFtZVpIVGV4dEZpZWxkLnZhbHVlID0gcGFyYW0ubGluZV9uYW1lWzBdO1xyXG4gICAgICAgICAgICBsaW5lTmFtZUVOVGV4dEZpZWxkLnZhbHVlID0gcGFyYW0ubGluZV9uYW1lWzFdO1xyXG5cclxuICAgICAgICAgICAgJCgnI2Rlc2lnbl9saXN0JylcclxuICAgICAgICAgICAgICAgIC5maW5kKCdsaSNkaXJlYyAubWRjLWxpc3QtaXRlbV9fc2Vjb25kYXJ5LXRleHQnKVxyXG4gICAgICAgICAgICAgICAgLnRleHQoZ2V0RGlyZWN0aW9uVGV4dChwYXJhbS5kaXJlY3Rpb24pKTtcclxuXHJcbiAgICAgICAgICAgIHBsYXRmb3JtTnVtVGV4dEZpZWxkLnZhbHVlID0gcGFyYW0ucGxhdGZvcm1fbnVtO1xyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAkLmdldEpTT04oJ2RhdGEvY2l0eV9saXN0Lmpzb24nLCAoZGF0YTogQ2l0eUVudHJ5W10pID0+IHtcclxuICAgICAgICBsZXQgbGFuZyA9IHdpbmRvdy51cmxQYXJhbXMuZ2V0KCdsYW5nJyk7XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGMgPT4ge1xyXG4gICAgICAgICAgICAkKCcjdGhlbWVfY2l0eV9fc2VsZWN0aW9uJykuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPGxpPicsIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ21kYy1saXN0LWl0ZW0nLCBcclxuICAgICAgICAgICAgICAgICAgICAnZGF0YS12YWx1ZSc6IGMuaWRcclxuICAgICAgICAgICAgICAgIH0pLnRleHQoY291bnRyeUNvZGUyRW1vamkoYy5jb3VudHJ5KSArIGdldFRyYW5zVGV4dChjLm5hbWUsIGxhbmcpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKCcjdGhlbWVfY2l0eV9fc2VsZWN0aW9uIGxpJykubWFwKChfLGVsKSA9PiBuZXcgTURDUmlwcGxlKGVsKSk7XHJcblxyXG4gICAgICAgIHZhciBbdGhlbWVDaXR5XSA9IGdldFBhcmFtcygpLnRoZW1lXHJcbiAgICAgICAgdmFyIGNpdHlJZHggPSAkKGAjdGhlbWVfY2l0eV9fc2VsZWN0aW9uID4gW2RhdGEtdmFsdWU9XCIke3RoZW1lQ2l0eX1cIl1gKS5pbmRleCgpO1xyXG4gICAgICAgIHRoZW1lQ2l0eVNlbGVjdC5zZWxlY3RlZEluZGV4ID0gY2l0eUlkeDtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGFkZCBldmVudCBsaXN0ZW5lcnNcclxuICAgIGRlc2lnbkxpc3QubGlzdGVuKCdNRENMaXN0OmFjdGlvbicsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LmRldGFpbC5pbmRleCkge1xyXG4gICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICB0aGVtZURpYWxvZy5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgbGluZU5hbWVEaWFsb2cub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgIGlmIChnZXRQYXJhbXMoKS5kaXJlY3Rpb24gPT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JpZ2h0IHRvIGxlZnQnKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubXlMaW5lLmRpcmVjdGlvbiA9ICdsJztcclxuICAgICAgICAgICAgICAgICAgICAkKCcjZGVzaWduX2xpc3QnKS5maW5kKCdsaSNkaXJlYyAubWRjLWxpc3QtaXRlbV9fc2Vjb25kYXJ5LXRleHQnKS50ZXh0KGdldERpcmVjdGlvblRleHQoJ2wnKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsZWZ0IHRvIHJpZ2h0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm15TGluZS5kaXJlY3Rpb24gPSAncic7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnI2Rlc2lnbl9saXN0JykuZmluZCgnbGkjZGlyZWMgLm1kYy1saXN0LWl0ZW1fX3NlY29uZGFyeS10ZXh0JykudGV4dChnZXREaXJlY3Rpb25UZXh0KCdyJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5teUxpbmUucmV2ZXJzZVN0bnMoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoZW1lRGlhbG9nLmxpc3RlbignTURDRGlhbG9nOm9wZW5lZCcsICgpID0+IHtcclxuICAgICAgICBbdGhlbWVDaXR5U2VsZWN0LCB0aGVtZUxpbmVTZWxlY3RdLm1hcChzZWxlY3QgPT4gc2VsZWN0LmxheW91dCgpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoZW1lQ2l0eVNlbGVjdC5saXN0ZW4oXCJNRENTZWxlY3Q6Y2hhbmdlXCIsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICBsZXQgY2l0eSA9IGV2ZW50LmRldGFpbC52YWx1ZTtcclxuICAgICAgICAkKCcjdGhlbWVfbGluZV9fc2VsZWN0aW9uJykuZW1wdHkoKTtcclxuICAgICAgICAkLmdldEpTT04oYGRhdGEvJHtjaXR5fS5qc29uYCwgKGRhdGE6IExpbmVFbnRyeVtdKSA9PiB7XHJcbiAgICAgICAgICAgIHZhciBsYW5nID0gd2luZG93LnVybFBhcmFtcy5nZXQoJ2xhbmcnKTtcclxuICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGwgPT4ge1xyXG4gICAgICAgICAgICAgICAgJCgnI3RoZW1lX2xpbmVfX3NlbGVjdGlvbicpLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICAkKCc8bGk+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogJ21kYy1saXN0LWl0ZW0nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS12YWx1ZSc6IGwuaWRcclxuICAgICAgICAgICAgICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJzxzcGFuPicpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBsLmNvbG91ciwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogbC5mZyB8fCAnI2ZmZidcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudGV4dCgnXFx1MDBhMCcgKyBnZXRUcmFuc1RleHQobC5uYW1lLCBsYW5nKSArICdcXHUwMGEwJylcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQoJyN0aGVtZV9saW5lX19zZWxlY3Rpb24gbGknKS5tYXAoKF8sZWwpID0+IG5ldyBNRENSaXBwbGUoZWwpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBwYXJhbSA9IGdldFBhcmFtcygpO1xyXG4gICAgICAgICAgICBwYXJhbS50aGVtZVswXSA9IGNpdHk7XHJcbiAgICAgICAgICAgIHB1dFBhcmFtcyhwYXJhbSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbGluZUlkeCA9ICQoYCN0aGVtZV9saW5lX19zZWxlY3Rpb24gPiBbZGF0YS12YWx1ZT1cIiR7cGFyYW0udGhlbWVbMV19XCJdYCkuaW5kZXgoKTtcclxuICAgICAgICAgICAgdGhlbWVMaW5lU2VsZWN0LnNlbGVjdGVkSW5kZXggPSBsaW5lSWR4PT0tMSA/IDAgOiBsaW5lSWR4O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhlbWVMaW5lU2VsZWN0Lmxpc3RlbihcIk1EQ1NlbGVjdDpjaGFuZ2VcIiwgKGV2ZW50OiBDdXN0b21FdmVudCkgPT4ge1xyXG4gICAgICAgIGxldCBsaW5lSWR4ID0gZXZlbnQuZGV0YWlsLmluZGV4O1xyXG5cclxuICAgICAgICB2YXIgcGFyYW0gPSBnZXRQYXJhbXMoKTtcclxuICAgICAgICBwYXJhbS50aGVtZVsxXSA9IGV2ZW50LmRldGFpbC52YWx1ZTtcclxuICAgICAgICBwdXRQYXJhbXMocGFyYW0pO1xyXG5cclxuICAgICAgICB3aW5kb3cubXlMaW5lLnRoZW1lTGluZSA9IGV2ZW50LmRldGFpbC52YWx1ZTtcclxuICAgICAgICB3aW5kb3cubXlMaW5lLnRoZW1lQ29sb3VyID0gWydiYWNrZ3JvdW5kLWNvbG9yJywgJ2NvbG9yJ11cclxuICAgICAgICAgICAgLm1hcChwcm9wID0+ICQoJyN0aGVtZV9saW5lX19zZWxlY3Rpb24gc3BhbicpLmVxKGxpbmVJZHgpLmNzcyhwcm9wKSlcclxuICAgICAgICAgICAgLm1hcChyZ2IySGV4KTtcclxuXHJcbiAgICAgICAgJCgnI2Rlc2lnbl9saXN0JylcclxuICAgICAgICAgICAgLmZpbmQoJ2xpI3RoZW1lIC5tZGMtbGlzdC1pdGVtX19zZWNvbmRhcnktdGV4dCcpXHJcbiAgICAgICAgICAgIC5odG1sKFxyXG4gICAgICAgICAgICAgICAgJCgnI3RoZW1lX2NpdHlfX3NlbGVjdGlvbiBsaScpLmVxKHRoZW1lQ2l0eVNlbGVjdC5zZWxlY3RlZEluZGV4KS50ZXh0KCkgK1xyXG4gICAgICAgICAgICAgICAgJyAnICtcclxuICAgICAgICAgICAgICAgICQoJyN0aGVtZV9saW5lX19zZWxlY3Rpb24gbGknKS5lcShsaW5lSWR4KS5odG1sKCkudHJpbSgpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsaW5lTmFtZURpYWxvZy5saXN0ZW4oJ01EQ0RpYWxvZzpvcGVuZWQnLCBldmVudCA9PiB7XHJcbiAgICAgICAgW2xpbmVOYW1lWkhUZXh0RmllbGQsIGxpbmVOYW1lRU5UZXh0RmllbGRdLm1hcCh0ZXh0ZmllbGQgPT4gdGV4dGZpZWxkLmxheW91dCgpKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNsaW5lX25hbWVfZGlhZycpXHJcbiAgICAgICAgLmZpbmQoJy5tZGMtdGV4dC1maWVsZCcpXHJcbiAgICAgICAgLm9uKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGxpbmVOYW1lcyA9IFtsaW5lTmFtZVpIVGV4dEZpZWxkLCBsaW5lTmFtZUVOVGV4dEZpZWxkXS5tYXAodGV4dGZpZWxkID0+IHRleHRmaWVsZC52YWx1ZSkgYXMgTmFtZTtcclxuICAgICAgICAgICAgd2luZG93Lm15TGluZS5saW5lTmFtZXMgPSBsaW5lTmFtZXM7XHJcbiAgICAgICAgICAgICQoJyNkZXNpZ25fbGlzdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2xpI25hbWUgLm1kYy1saXN0LWl0ZW1fX3NlY29uZGFyeS10ZXh0JylcclxuICAgICAgICAgICAgICAgICAgICAudGV4dChsaW5lTmFtZXMuam9pbigpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAoJChwbGF0Zm9ybU51bVRleHRGaWVsZC5yb290XykuZmluZCgnaW5wdXQnKSBhcyBKUXVlcnk8SFRNTElucHV0RWxlbWVudD4pXHJcbiAgICAgICAgLm9uKCdpbnB1dCcsIGV2ZW50ID0+IHdpbmRvdy5teUxpbmUucGxhdGZvcm1OdW0gPSBldmVudC50YXJnZXQudmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbXRyKCkge1xyXG4gICAgLy8gbWRjIGluc3RhbmNlc1xyXG4gICAgY29uc3QgZGVzaWduTGlzdE1UUkxpc3QgPSBNRENMaXN0LmF0dGFjaFRvKCQoJyNkZXNpZ25fbGlzdF9tdHInKVswXSk7XHJcbiAgICBjb25zdCBjaGFyRGlhbG9nID0gTURDRGlhbG9nLmF0dGFjaFRvKCQoJyNkZXNpZ25fY2hhcl9kaWFnJylbMF0pO1xyXG4gICAgY29uc3QgbGVnYWN5U3dpdGNoID0gbmV3IE1EQ1N3aXRjaCgkKCcjbGVnYWN5JylbMF0pO1xyXG5cclxuICAgIC8vIGhlbHBlciBmdW5jdGlvbnNcclxuICAgIGNvbnN0IGdldENoYXJUZXh0ID0gKGNoYXI6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGVzaWduX2NoYXJfZGlhZycpXHJcbiAgICAgICAgICAgIC5maW5kKCdsaScpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoKF8sIGVsOiBIVE1MRWxlbWVudCkgPT4gZWwuZGF0YXNldC5tZGNEaWFsb2dBY3Rpb24gPT09IGNoYXIpXHJcbiAgICAgICAgICAgIC5maW5kKCdzcGFuJylcclxuICAgICAgICAgICAgLnRleHQoKVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBpbml0IHZhbHVlc1xyXG4gICAgUHJvbWlzZS5yZXNvbHZlKGdldFBhcmFtcygpKVxyXG4gICAgICAgIC50aGVuKHBhcmFtID0+IHtcclxuICAgICAgICAgICAgLy8gJCgnI2Rlc2lnbl9saXN0X210cicpXHJcbiAgICAgICAgICAgIC8vICAgICAuZmluZCgnbGkjY2hhciAubWRjLWxpc3QtaXRlbV9fc2Vjb25kYXJ5LXRleHQnKVxyXG4gICAgICAgICAgICAvLyAgICAgLnRleHQoZ2V0Q2hhclRleHQocGFyYW0uY2hhcl9mb3JtKSk7XHJcbiAgICAgICAgICAgICQoJyNkZXNpZ25fY2hhcl9kaWFnJylbMF0uZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ01EQ0RpYWxvZzpjbG9zZWQnLCB7IGRldGFpbDoge2FjdGlvbjogcGFyYW0uY2hhcl9mb3JtfX0pKTtcclxuICAgICAgICAgICAgLy8gY2hhckRpYWxvZy5jbG9zZShwYXJhbS5jaGFyX2Zvcm0pO1xyXG4gICAgICAgICAgICBsZWdhY3lTd2l0Y2guY2hlY2tlZCA9IHBhcmFtLmRlc3RfbGVnYWN5O1xyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBhZGQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICBkZXNpZ25MaXN0TVRSTGlzdC5saXN0ZW4oJ01EQ0xpc3Q6YWN0aW9uJywgKGV2ZW50OiBDdXN0b21FdmVudCkgPT4ge1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZGV0YWlsLmluZGV4KSB7XHJcbiAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICg8Uk1HTGluZUhLPndpbmRvdy5teUxpbmUpLnR4dEZsaXAgPSAhZ2V0UGFyYW1zKCkudHh0X2ZsaXA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgY2hhckRpYWxvZy5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjaGFyRGlhbG9nLmxpc3RlbignTURDRGlhbG9nOmNsb3NlZCcsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICBsZXQgY2hhciA9IGV2ZW50LmRldGFpbC5hY3Rpb247XHJcbiAgICAgICAgaWYgKGNoYXIgPT0gJ2Nsb3NlJykge3JldHVybjt9XHJcblxyXG4gICAgICAgICg8Uk1HTGluZUhLPndpbmRvdy5teUxpbmUpLmNoYXJGb3JtID0gY2hhcjtcclxuICAgICAgICAkKCcjZGVzaWduX2xpc3RfbXRyJylcclxuICAgICAgICAgICAgLmZpbmQoJ2xpI2NoYXIgLm1kYy1saXN0LWl0ZW1fX3NlY29uZGFyeS10ZXh0JylcclxuICAgICAgICAgICAgLnRleHQoZ2V0Q2hhclRleHQoY2hhcikpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgKCQobGVnYWN5U3dpdGNoLnJvb3RfKS5maW5kKCdpbnB1dCcpIGFzIEpRdWVyeTxIVE1MSW5wdXRFbGVtZW50PilcclxuICAgICAgICAub24oJ2NoYW5nZScsIGV2ZW50ID0+ICg8Uk1HTGluZUhLPndpbmRvdy5teUxpbmUpLmRlc3RMZWdhY3kgPSBldmVudC50YXJnZXQuY2hlY2tlZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnem10cigpIHtcclxuICAgIC8vIG1kYyBpbnN0YW5jZXNcclxuICAgIGNvbnN0IGRlc2lnbkxpc3RHWk1UUkxpc3QgPSBNRENMaXN0LmF0dGFjaFRvKCQoJyNkZXNpZ25fbGlzdF9nem10cicpWzBdKTtcclxuICAgIGNvbnN0IHBhbmVsVHlwZURpYWxvZyA9IE1EQ0RpYWxvZy5hdHRhY2hUbygkKCcjcGFuZWxfdHlwZV9kaWFnJylbMF0pO1xyXG4gICAgY29uc3QgW3BzZE51bVRleHRGaWVsZCwgbGluZU51bVRleHRGaWVsZF0gPSBcclxuICAgICAgICBbJyNwc2RfbnVtJywgJyNsaW5lX251bSddLm1hcChzZWxlY3RvciA9PiBNRENUZXh0RmllbGQuYXR0YWNoVG8oJChzZWxlY3RvcilbMF0pKTtcclxuXHJcbiAgICAvLyBpbml0IHZhbHVlc1xyXG4gICAgUHJvbWlzZS5yZXNvbHZlKGdldFBhcmFtcygpKVxyXG4gICAgICAgIC50aGVuKHBhcmFtID0+IHtcclxuICAgICAgICAgICAgcHNkTnVtVGV4dEZpZWxkLnZhbHVlID0gcGFyYW0ucHNkX251bTtcclxuICAgICAgICAgICAgbGluZU51bVRleHRGaWVsZC52YWx1ZSA9IHBhcmFtLmxpbmVfbnVtO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIC8vIGFkZCBldmVudCBsaXN0ZW5lcnNcclxuICAgIGRlc2lnbkxpc3RHWk1UUkxpc3QubGlzdGVuKCdNRENMaXN0OmFjdGlvbicsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50LmRldGFpbC5pbmRleCkge1xyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICBwYW5lbFR5cGVEaWFsb2cub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgKCQobGluZU51bVRleHRGaWVsZC5yb290XykuZmluZCgnaW5wdXQnKSBhcyBKUXVlcnk8SFRNTElucHV0RWxlbWVudD4pXHJcbiAgICAgICAgLm9uKCdpbnB1dCcsIGV2ZW50ID0+ICg8Uk1HTGluZUdaPndpbmRvdy5teUxpbmUpLmxpbmVOdW0gPSBldmVudC50YXJnZXQudmFsdWUpO1xyXG5cclxuICAgICgkKHBzZE51bVRleHRGaWVsZC5yb290XykuZmluZCgnaW5wdXQnKSBhcyBKUXVlcnk8SFRNTElucHV0RWxlbWVudD4pXHJcbiAgICAgICAgLm9uKCdpbnB1dCcsIGV2ZW50ID0+ICg8Uk1HTGluZUdaPndpbmRvdy5teUxpbmUpLnBzZE51bSA9IGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcblxyXG4gICAgcGFuZWxUeXBlRGlhbG9nLmxpc3RlbignTURDRGlhbG9nOmNsb3NlZCcsIChldmVudDogQ3VzdG9tRXZlbnQpID0+IHtcclxuICAgICAgICBpZiAoZXZlbnQuZGV0YWlsLmFjdGlvbiA9PT0gJ2Nsb3NlJykge3JldHVybjt9XHJcbiAgICAgICAgKDxSTUdMaW5lR1o+d2luZG93Lm15TGluZSkuaW5mb1BhbmVsVHlwZSA9IGV2ZW50LmRldGFpbC5hY3Rpb247XHJcbiAgICB9KTtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=