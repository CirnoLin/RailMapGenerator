(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{76:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(3),i=n(1),l=n(5),o=n(4),s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function c(){return Math.floor(Math.random()*Math.pow(36,4)).toString(36).padStart(4,"0")}function u(e){var t=["癸","甲","乙","丙","丁","戊","己","庚","辛","壬","日","月","金","木","水","火","土","竹","戈","十","大","中","一","弓","人","心","手","口","尸","廿","山","女","田","難","卜","重"],n=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Alfa","Bravo","Charlie","Delta","Echo","Foxtrot","Golf","Hotel","India","Juliett","Kilo","Lima","Mike","November","Oscar","Papa","Quebec","Romeo","Sierra","Tango","Uniform","Victor","Whiskey","X-ray","Yankee","Zulu"];return[e.split("").map((function(e){return t[parseInt(e,36)]})).join(""),e.split("").map((function(e){return n[parseInt(e,36)]})).join(" ")]}var h=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return l},p=r.memo((function(e){var t=Object(a.useTranslation)().t,n={centre:t("stations.add.centre"),upper:t("stations.add.upper"),lower:t("stations.add.lower"),newupper:t("stations.add.newUpper"),newlower:t("stations.add.newLower")},p=h(r.useState("before"),2),d=p[0],f=p[1],m=h(r.useState(e.tpo[0]),2),g=m[0],b=m[1],E=h(r.useState(Object.keys(n)[0]),2),y=E[0],v=E[1],O=h(r.useState(Array(5).fill(!0)),2),S=O[0],C=O[1],k=h(r.useState(""),2),w=k[0],D=k[1],I=h(r.useState([]),2),L=I[0],T=I[1],j=r.useMemo((function(){return function(e,t,n){switch(n[t]?n[t]["before"===e?"parents":"children"].length:0){case 2:return[1,1,1,[],[]];case 1:var r=Object(o.c)(t,n);if(0==r){var a=function(e,t,n){var r=[];if("before"==e){for(;1==n[t].parents.length;)t=n[t].parents[0],r.unshift(t);r.pop()}else{for(;1==n[t].children.length;)t=n[t].children[0],r.push(t);r.shift()}return r}(e,t,n);return[1,0,0,a=a.length?a:[],a]}return r<0?"before"==e?[n[n[t].parents[0]].children.length-1,0,1,[],[]]:[n[n[t].children[0]].parents.length-1,0,1,[],[]]:"before"==e?[n[n[t].parents[0]].children.length-1,1,0,[],[]]:[n[n[t].children[0]].parents.length-1,1,0,[],[]]}return[0,0,0,[],[]]}(d,g,e.stnList)}),[d,g,e.stnList]);r.useEffect((function(){console.log("new"),C(j.map((function(e){return"number"==typeof e?Boolean(e):Boolean(e.length)}))),T(j[3])}),[j.toString()]),r.useEffect((function(){v(Object.keys(n)[S.indexOf(!0)])}),[S]),r.useEffect((function(){0!==L.length&&D(L[0])}),[L]),r.useEffect((function(){g in e.stnList||b(e.tpo[0])}),[Object.keys(e.stnList).toString()]);var x=function(t){if("close"===t)e.onClose("close");else{var n=h(function(e,t,n,r,a){for(var i,l=c();Object.keys(a).includes(l);)l=c();var h={name:u(l),num:"00",services:["local"],parents:[],children:[],branch:{left:[],right:[]},transfer:{info:[[]],type:"none",tick_direc:"r",paid_area:!0,osi_names:[]},facility:""},p=JSON.parse(JSON.stringify(a));return"before"===e?"centre"===n?(h.parents=a[t].parents,0===a[t].parents.length&&0!==Object(o.c)(t,a)?h.children=a.linestart.children:0!==Object(o.c)(t,a)?(h.children=a[a[t].parents[0]].children.slice(),h.branch.right=a[h.parents[0]].branch.right,p[h.parents[0]].branch.right=[]):(h.children=[t],h.branch.left=a[t].branch.left,p[t].branch.left=[]),h.parents.forEach((function(e){p[e].children=[l]})),h.children.forEach((function(e){p[e].parents=[l]}))):"upper"===n?2===a[t].parents.length?(a[t].branch.left[1]===a[t].parents[0]&&(p[t].branch.left[1]=l),h.parents=a[t].parents.slice(0,1),h.children=[t],h.parents.forEach((function(e){p[e].children=[l]})),p[t].parents[0]=l):(h.parents=a[t].parents,h.children=[t],h.parents.forEach((function(e){p[e].children[0]=l,a[e].branch.right[1]===t&&(p[e].branch.right[1]=l)})),h.children.forEach((function(e){p[e].parents=[l]}))):"lower"===n?2===a[t].parents.length?(a[t].branch.left[1]==a[t].parents[1]&&(p[t].branch.left[1]=l),h.parents=a[t].parents.slice(1),h.children=[t],h.parents.forEach((function(e){p[e].children=[l]})),p[t].parents[1]=l):(h.parents=a[t].parents,h.children=[t],h.parents.forEach((function(e){var n=a[e].children.length;p[e].children[n-1]=l,a[e].branch.right[1]===t&&(p[e].branch.right[1]=l)})),h.children.forEach((function(e){p[e].parents=[l]}))):(p[t].branch.left=["through",l],p[r].branch.right=["through",l],h.parents=[r],h.children=[t],"newupper"===n?(p[r].children.unshift(l),p[t].parents.unshift(l)):(p[r].children.push(l),p[t].parents.push(l))):"centre"===n?(h.children=a[t].children,0===a[t].children.length&&0!=Object(o.c)(t,a)?h.parents=a.lineend.parents:0!=Object(o.c)(t,a)?(h.parents=a[a[t].children[0]].parents,h.branch.left=a[h.children[0]].branch.left,p[h.children[0]].branch.left=[]):(h.parents=[t],h.branch.right=a[t].branch.right,p[t].branch.right=[]),h.children.forEach((function(e){p[e].parents=[l]})),h.parents.forEach((function(e){p[e].children=[l]}))):"upper"===n?2===a[t].children.length?(a[t].branch.right[1]==a[t].children[0]&&(p[t].branch.right[1]=l),h.children=a[t].children.slice(0,1),h.parents=[t],h.children.forEach((function(e){p[e].parents=[l]})),p[t].children[0]=l):(h.children=a[t].children,h.parents=[t],h.children.forEach((function(e){p[e].parents[0]=l,a[e].branch.left[1]===t&&(p[e].branch.left[1]=l)})),h.parents.forEach((function(e){p[e].children=[l]}))):"lower"===n?2===a[t].children.length?(a[t].branch.right[1]==a[t].children[1]&&(p[t].branch.right[1]=l),h.children=a[t].children.slice(1),h.parents=[t],h.children.forEach((function(e){p[e].parents=[l]})),p[t].children[1]=l):(h.children=a[t].children,h.parents=[t],h.children.forEach((function(e){p[e].parents[1===a[e].parents.length?0:1]=l,a[e].branch.left[1]===t&&(p[e].branch.left[1]=l)})),h.parents.forEach((function(e){p[e].children=[l]}))):(p[t].branch.right=["through",l],p[r].branch.left=["through",l],h.children=[r],h.parents=[t],"newupper"===n?(p[r].parents.unshift(l),p[t].children.unshift(l)):(p[r].parents.push(l),p[t].children.push(l))),[l,s(s({},p),(i={},i[l]=h,i))]}(d,g,y,w,e.stnList),2),r=n[0],a=n[1];e.paramUpdate("stn_list",a),e.onClose(r)}};return r.createElement(i.Dialog,{open:e.open,onClose:function(){return x("close")}},r.createElement(i.DialogTitle,null,t("stations.add.title")),r.createElement(i.DialogContent,{dividers:!0},r.createElement(i.List,null,r.createElement(i.ListItem,null,r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"control_camera")),r.createElement(i.TextField,{select:!0,style:{width:"100%"},variant:"outlined",label:t("stations.add.prep"),onChange:function(e){return f(e.target.value)},value:d},r.createElement(i.MenuItem,{key:"before",value:"before"},t("stations.add.before")),r.createElement(i.MenuItem,{key:"after",value:"after"},t("stations.add.after")))),r.createElement(i.ListItem,null,r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"near_me")),r.createElement(i.TextField,{select:!0,style:{width:"100%"},variant:"outlined",label:t("stations.add.pivot"),onChange:function(e){return b(e.target.value)},value:g},e.tpo.map((function(t){return r.createElement(i.MenuItem,{key:t,value:t},Object(l.a)(e.stnList[t]))})))),r.createElement(i.ListItem,null,r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"share")),r.createElement(i.TextField,{select:!0,style:{width:"100%"},variant:"outlined",label:t("stations.add.loc"),onChange:function(e){return v(e.target.value)},value:y},Object.keys(n).map((function(e,t){return r.createElement(i.MenuItem,{key:e,value:e,disabled:!S[t]},n[e])})))),r.createElement(i.ListItem,{style:{display:["newupper","newlower"].includes(y)?"flex":"none"}},r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"undo")),r.createElement(i.TextField,{select:!0,style:{width:"100%"},variant:"outlined",label:t("stations.add.end"),onChange:function(e){return D(e.target.value)},value:w},L.map((function(t){return r.createElement(i.MenuItem,{key:t,value:t},Object(l.a)(e.stnList[t]))})))))),r.createElement(i.DialogActions,null,r.createElement(i.Button,{onClick:function(){return x("close")},color:"primary"},t("dialog.cancel")),r.createElement(i.Button,{onClick:function(){return x("accept")},color:"primary",autoFocus:!0},t("dialog.ok"))))}),(function(e,t){if(e.open!==t.open)return!1;var n={},r={};return Object.keys(t.stnList).forEach((function(e){var n=t.stnList[e],a=n.name,i=n.num,l=n.parents,o=n.children;r[e]={name:a,num:i,parents:l,children:o}})),Object.keys(e.stnList).forEach((function(t){var r=e.stnList[t],a=r.name,i=r.num,l=r.parents,o=r.children;n[t]={name:a,num:i,parents:l,children:o}})),JSON.stringify(n)===JSON.stringify(r)})),d=n(2),f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},m=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return l},g=r.lazy((function(){return n.e(62).then(n.bind(null,85))})),b=r.lazy((function(){return n.e(60).then(n.bind(null,73))})),E=r.lazy((function(){return n.e(59).then(n.bind(null,74))})),y=r.lazy((function(){return n.e(61).then(n.bind(null,75))})),v=Object(i.makeStyles)((function(e){return Object(i.createStyles)({tab:{padding:"6px 24px",height:48,minWidth:"calc(100% / 4)","& .MuiTab-wrapper":{flexDirection:"row"},"&.MuiTab-labelIcon":{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}}})}));var O=function(e){var t=Object(a.useTranslation)().t,n=r.useContext(d.b),l=n.param,o=n.dispatch,s=l.stn_list[e.stnId],c=m(r.useState(0),2),u=c[0],h=c[1],p=v(),O=Object(i.useTheme)(),S=Object(i.useMediaQuery)(O.breakpoints.down("sm")),C=r.useMemo((function(){return r.createElement(i.Tabs,{value:u,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return h(t)},variant:"scrollable",scrollButtons:"off"},[["name","title"],["interchange","transfer_within_a_station"],["branch","share"],["more","more_horiz"]].map((function(e,n){return r.createElement(i.Tab,{label:r.createElement("span",null,t("stations.edit.tab."+e[0])),icon:r.createElement(i.Icon,null,e[1]),key:n,className:p.tab})})))}),[u,p.tab]),k=function(t){var n=f(f({},t),{info:t.info.map((function(e){return e.map((function(e){return 0===Object.values(e).length?l.theme.concat(["轉綫","Line"]):e}))}))});o({type:"UPDATE_STATION_TRANSFER",stnId:e.stnId,transfer:n})};return r.createElement(i.Dialog,{onClose:e.onClose,open:e.open,fullScreen:S},r.createElement(i.DialogTitle,null,t("stations.edit.title")),r.createElement(i.DialogContent,{dividers:!0,style:{padding:"0 16px"}},C,r.createElement(i.Typography,{component:"div",role:"tabpanel"},r.createElement(r.Suspense,{fallback:r.createElement(i.CircularProgress,null)},function(t){switch(t){case 0:return r.createElement(g,{stnId:e.stnId});case 1:return r.createElement(b,{stnTrans:s.transfer,onUpdate:k,stnId:e.stnId});case 2:return r.createElement(E,{stnId:e.stnId});case 3:return r.createElement(y,{facility:s.facility,services:new Set(s.services),onUpdate:function(t,n){return e.onUpdate(t,n)},stnId:e.stnId})}}(u)))),r.createElement(i.DialogActions,null,r.createElement(i.Button,{onClick:e.onClose,color:"primary",autoFocus:!0},t("dialog.done"))))},S=Object(i.makeStyles)((function(e){return Object(i.createStyles)({root:{backgroundColor:e.palette.background.paper,height:55,borderRadius:8,boxShadow:e.shadows[1]},rootSize:{margin:8,width:"calc((100% - 96px) / 6)"},rootSizeTablet:{margin:6,width:"calc((100% - 48px) / 4)"},rootSizeMobile:{margin:6,width:"calc((100% - 24px) / 2)"},stnChipText:{display:"block",textAlign:"center"},stnChipTextZH:{fontSize:18,fontWeight:500,lineHeight:"1.2rem"},stnChipTextEN:{fontSize:".75rem",lineHeight:".9rem",whiteSpace:"pre",overflow:"hidden"},addChipLabel:{fontWeight:500,fontSize:"1rem",lineHeight:"1.2rem",textAlign:"center",width:"100%"},stnChipLabel:{width:"100%"}})})),C=r.memo((function(e){var t=Object(i.useMediaQuery)("(max-width: 839px) and (min-width: 480px)"),n=Object(i.useMediaQuery)("(max-width: 480px)"),a=S();return r.createElement("div",null,e.tpo.map((function(l,o){var s,c,u,h=r.createElement("span",null,r.createElement("span",{className:a.stnChipText+" "+a.stnChipTextZH},(null===(s=e.stnList[l])||void 0===s?void 0:s.name[0])||""),r.createElement("span",{className:a.stnChipText+" "+a.stnChipTextEN},(null===(c=e.stnList[l])||void 0===c?void 0:c.name[1].replace("\\","\r\n"))||""));return r.createElement(i.Chip,{key:l,icon:"gzmtr"!==window.urlParams.get("style")?r.createElement(r.Fragment,null):r.createElement(i.Avatar,{style:{backgroundColor:"unset"}},(null===(u=e.stnList[l])||void 0===u?void 0:u.num)||"00"),label:h,onClick:e.onSelection(l),classes:{label:a.stnChipLabel},className:a.root+" "+(n?a.rootSizeMobile:t?a.rootSizeTablet:a.rootSize)})})))}),(function(e,t){if(e.tpo.toString()!==t.tpo.toString())return!1;var n={},r={};return Object.keys(t.stnList).forEach((function(e){var n=t.stnList[e],a=n.name,i=n.num;r[e]={name:a,num:i}})),Object.keys(e.stnList).forEach((function(t){var r=e.stnList[t],a=r.name,i=r.num;n[t]={name:a,num:i}})),JSON.stringify(n)===JSON.stringify(r)}));function k(e){var t=Object(a.useTranslation)().t;return r.createElement(i.Dialog,{open:e.open},r.createElement(i.DialogTitle,null,t("stations.remove.title")),r.createElement(i.DialogContent,null,r.createElement(i.DialogContentText,null,r.createElement(a.Trans,{i18nKey:"stations.remove.msg"},{name:e.stnInfo.name.join()}))),r.createElement(i.DialogActions,null,r.createElement(i.Button,{onClick:function(){return e.onClose("close")},color:"primary",autoFocus:!0},t("dialog.cancel")),r.createElement(i.Button,{onClick:function(){return e.onClose("accept")},color:"primary"},t("stations.remove.button"))))}function w(e){var t=Object(a.useTranslation)().t;return r.createElement(i.Dialog,{open:e.open,onClose:e.onClose},r.createElement(i.DialogTitle,null,t("stations.remove.error.title")),r.createElement(i.DialogContent,null,r.createElement(i.DialogContentText,null,t("stations.remove.error.msg"))),r.createElement(i.DialogActions,null,r.createElement(i.Button,{onClick:e.onClose,color:"primary",autoFocus:!0},t("dialog.ok"))))}var D,I=function(e){var t=Object(a.useTranslation)().t,n=r.useContext(d.b),l=n.dispatch,o=n.branches,s=function(t){var n=o[0];n.forEach((function(e,r){var a;a="ascend"===t?r.toString().padStart(2,"0"):(n.length-1-r).toString().padStart(2,"0"),l({type:"UPDATE_STATION_NUM",stnId:e,num:a})})),e.onClose()};return r.useMemo((function(){return r.createElement(i.Dialog,{onClose:e.onClose,open:e.open},r.createElement(i.DialogTitle,null,t("design.autoNum.title")),r.createElement(i.DialogContent,null,r.createElement(i.DialogContentText,null,t("design.autoNum.msg"))),r.createElement(i.DialogActions,null,r.createElement(i.Button,{onClick:e.onClose,color:"primary",autoFocus:!0},t("dialog.cancel")),r.createElement(i.Button,{onClick:function(){return s("ascend")},color:"primary"},t("design.autoNum.ascend")),r.createElement(i.Button,{onClick:function(){return s("descend")},color:"primary"},t("design.autoNum.descend"))))}),[e.open])},L=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return l},T=Object(i.makeStyles)((function(e){return Object(i.createStyles)({fab:{position:"fixed",right:e.spacing(2),bottom:e.spacing(2)}})})),j=r.memo((function(e){var t=Object(a.useTranslation)().t,n=T(),l=L(r.useState(null),2),o=l[0],s=l[1],c=function(t){return function(){s(null),e.onAction(t)}};return r.createElement(r.Fragment,null,r.createElement(i.Tooltip,{title:t("stations.fabs.tooltip"),"aria-label":"options"},r.createElement(i.Fab,{color:"primary",className:n.fab,onClick:function(e){return s(e.target)}},r.createElement(i.Icon,null,"more_vert"))),r.createElement(i.Menu,{anchorEl:o,open:Boolean(o),onClose:function(){return s(null)}},r.createElement(i.MenuItem,{onClick:c("add")},r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"add_box")),r.createElement(i.ListItemText,{primary:t("stations.fabs.add")})),r.createElement(i.MenuItem,{onClick:c("reverse")},r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"cached")),r.createElement(i.ListItemText,{primary:t("stations.fabs.reverse")})),"gzmtr"===window.urlParams.get("style")&&r.createElement(i.MenuItem,{onClick:c("autonum")},r.createElement(i.ListItemIcon,null,r.createElement(i.Icon,null,"filter_1")),r.createElement(i.ListItemText,{primary:t("design.autoNum.button")}))))}),(function(){return!0})),x=(D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},N=function(e){function t(t){var n=e.call(this,t)||this;return n.stnChipSetSelection=function(e){return function(){console.log(e),n.setState({snackBarOpened:!0,stationSelected:e})}},n.state={stationSelected:"",snackBarOpened:!1,stnAddDialogOpened:!1,stnEditDialogOpened:!1,stnDeleteDialogOpened:!1,stnDeleteErrDialogOpened:!1,autoNumDialogOpened:!1},n}return x(t,e),t.prototype.snackBarClose=function(e){"clickaway"!==e&&(this.setState({snackBarOpened:!1}),"current"===e?this.props.paramUpdate("current_stn_idx",this.state.stationSelected):"edit"===e?this.setState({stnEditDialogOpened:!0}):"delete"===e&&this.setState({stnDeleteDialogOpened:!0}))},t.prototype.stnAddDialogClose=function(e){"close"===e?this.setState({stnAddDialogOpened:!1}):this.setState({stnAddDialogOpened:!1,stnEditDialogOpened:!0,stationSelected:e})},t.prototype.stnEditDialogUpdate=function(e,t,n){var r,a,i=this.state.stationSelected;if("facility"===t&&this.props.paramUpdate("stn_list",_(_({},this.props.stnList),((r={})[i]=_(_({},this.props.stnList[i]),{facility:e}),r))),"services"===t){var l=new Set(this.props.stnList[i].services);!1===e.selected?l.delete(e.chipId):l.add(e.chipId),this.props.paramUpdate("stn_list",_(_({},this.props.stnList),((a={})[i]=_(_({},this.props.stnList[i]),{services:Array.from(l)}),a)))}},t.prototype.stnDeleteClose=function(e){var t=this.state.stationSelected;if(this.setState({stnDeleteDialogOpened:!1}),"accept"===e){var n=function(e,t){var n=JSON.parse(JSON.stringify(t)),r=n[e].parents,a=n[e].children,i=!0;for(var l in n)if(![e,"linestart","lineend"].includes(l)&&0===Object(o.c)(l,n)){i=!1;break}if(2==r.length&&2==a.length)return!1;if(i)return!1;if(4==Object.keys(n).length)return!1;if(2==r.length||2==a.length)console.log("this case"),r.forEach((function(e){n[e].children=a})),a.forEach((function(e){n[e].parents=r})),1==r.length&&(n[r[0]].branch.right=n[e].branch.right),1==a.length&&(n[a[0]].branch.left=n[e].branch.left);else if(2==n[r[0]].children.length&&2==n[a[0]].parents.length){var s=n[r[0]].children.indexOf(e),c=n[a[0]].parents.indexOf(e);n[r[0]].children.splice(s,1),n[a[0]].parents.splice(c,1),n[r[0]].branch.right=[],n[a[0]].branch.left=[]}else r.forEach((function(t){var r=n[t].children.indexOf(e);a.length?n[t].children[r]=a[0]:n[t].children.splice(r,1),n[t].branch.right[1]===e&&(n[t].branch.right[1]=a[0])})),a.forEach((function(t){var a=n[t].parents.indexOf(e);r.length?n[t].parents[a]=r[0]:n[t].parents.splice(a,1),n[t].branch.left[1]===e&&(n[t].branch.left[1]=r[0])}));return delete n[e],n}(t,this.props.stnList);if(!1===n)this.setState({stnDeleteErrDialogOpened:!0});else{if(this.props.currentId===t){var r=Object.keys(n).filter((function(e){return!["linestart","lineend"].includes(e)}))[0];this.props.paramUpdate("current_stn_idx",r)}this.props.paramUpdate("stn_list",n)}}},t.prototype.fabsAction=function(e){if("add"===e&&this.setState({stnAddDialogOpened:!0}),"reverse"===e){var t=function(e){var t=JSON.parse(JSON.stringify(e));return Object.keys(e).forEach((function(n){var r=s({},e[n]);if("linestart"===n)t.lineend.parents=r.children.reverse(),t.lineend.branch={left:r.branch.right,right:[]};else if("lineend"===n)t.linestart.children=r.parents.reverse(),t.linestart.branch={left:[],right:r.branch.left};else{var a=r.children.reverse().map((function(e){switch(e){case"linestart":return"lineend";case"lineend":return"linestart";default:return e}}));t[n].children=r.parents.reverse().map((function(e){switch(e){case"linestart":return"lineend";case"lineend":return"linestart";default:return e}})),t[n].parents=a,t[n].branch.left=r.branch.right,t[n].branch.right=r.branch.left}})),t}(this.props.stnList);this.props.paramUpdate("stn_list",t)}"autonum"===e&&this.setState({autoNumDialogOpened:!0})},t.prototype.render=function(){var e=this;return r.createElement("div",{style:{width:"100%"}},r.createElement(C,{stnList:this.props.stnList,tpo:this.props.tpo,onSelection:this.stnChipSetSelection.bind(this),addStationClick:function(){return e.setState({stnAddDialogOpened:!0})}}),r.createElement(i.Snackbar,{open:this.state.snackBarOpened,onClose:function(t,n){return e.snackBarClose(n)},autoHideDuration:5e3,message:Object(l.a)(this.props.stnList[this.state.stationSelected]),action:r.createElement(r.Fragment,null,r.createElement(i.Button,{color:"secondary",size:"small",onClick:function(){return e.snackBarClose("current")}},this.props.t("stations.current")),r.createElement(i.Button,{color:"secondary",size:"small",onClick:function(){return e.snackBarClose("edit")}},this.props.t("stations.edit.button")),r.createElement(i.Button,{color:"secondary",size:"small",onClick:function(){return e.snackBarClose("delete")}},this.props.t("stations.remove.button")),r.createElement(i.IconButton,{size:"small","aria-label":"close",color:"inherit",onClick:function(){return e.snackBarClose("close")}},r.createElement(i.Icon,{fontSize:"small"},"close")))}),r.createElement(j,{onAction:this.fabsAction.bind(this)}),r.createElement(p,{open:this.state.stnAddDialogOpened,stnList:this.props.stnList,tpo:this.props.tpo,onClose:this.stnAddDialogClose.bind(this),paramUpdate:this.props.paramUpdate}),r.createElement(O,{open:this.state.stnEditDialogOpened,onClose:function(){return e.setState({stnEditDialogOpened:!1})},onUpdate:this.stnEditDialogUpdate.bind(this),stnId:this.state.stationSelected}),r.createElement(k,{open:this.state.stnDeleteDialogOpened,onClose:this.stnDeleteClose.bind(this),stnInfo:this.props.stnList[this.state.stationSelected]||this.props.stnList.linestart}),r.createElement(w,{open:this.state.stnDeleteErrDialogOpened,onClose:function(){return e.setState({stnDeleteErrDialogOpened:!1})}}),"gzmtr"===window.urlParams.get("style")&&r.createElement(I,{open:this.state.autoNumDialogOpened,onClose:function(){return e.setState({autoNumDialogOpened:!1})}}))},t}(r.Component),A=Object(a.withTranslation)()(N);t.default=A}}]);