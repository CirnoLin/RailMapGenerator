(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{20:function(t,e,s){"use strict";s.r(e);var n=s(4),r=s(0),i=s(5);class a extends i.a{constructor(t,e){super(t,e)}}class o extends a{constructor(t,e){super(t,e),this._intInfo=e.transfer.info[0][0]}get _dy(){return 0}get intTickHTML(){var t=this.namePos?180:0,e=this._intInfo[r.b.colour],s=$("<use>",{"xlink:href":"#inttick_hk",stroke:e,transform:`translate(${this.x},${this.y+this._dy})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&s.addClass("rmg-line__pass"),s}get _nameClass(){return-1==this.state?"Pass":"Future"}get intNameHTML(){var[t,e,s]=Object(r.k)([this._intInfo[r.b.nameZH],this._intInfo[r.b.nameEN]],10,7),n=this.namePos?-37.703125-13*(e-1)-7*(s-1):30.953125;return n+=this._dy,$("<g>",{"text-anchor":"middle",transform:`translate(${this.x},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get ungrpHTML(){return[this.intTickHTML,this.iconHTML,this.nameHTML,this.intNameHTML]}}class h extends a{constructor(t,e){super(t,e),this._intInfos=e.transfer.info[0]}get iconHTML(){let t=this.namePos?180:0;return $("<use>",{"xlink:href":"#int3_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:this.iconClass})}get _tickRotation(){return 0}get _dy(){return 0}get _dx(){return 0}get _tickFlip(){return 1}get intTickHTML(){let t=[];return this._intInfos.map(t=>t[r.b.colour]).forEach((e,s)=>{if(s>=2)return;let n=-1===this.state?"#aaa":e,r=this.namePos?-18*(2-s):18*(s+1);r+=this._dy,r*=this._tickFlip,t.push($("<use>",{"xlink:href":"#inttick_hk",stroke:n,transform:`translate(${this.x+this._dx},${this.y+r})rotate(${this._tickRotation})`,class:"rmg-line rmg-line__mtr rmg-line__change"}))}),t}get _txtAnchor(){return"middle"}get _intNameDX(){return 0}get _nameClass(){return-1==this.state?"Pass":"Future"}get intNameHTML(){let t=[],e=this._nameClass;return this._intInfos.map(t=>[t[r.b.nameZH],t[r.b.nameEN]]).forEach((s,n)=>{if(n>=2)return;let[i,a,o]=Object(r.k)(s,10,7);var h=this.namePos?-18*(2-n):18*(n+1);h+=this._dy,h*=this._tickFlip,h+=5.953125-(19.65625+13*(a-1)+7*(o-1))/2,t.push($("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x+this._intNameDX},${this.y+h})`,class:"Name "+e}).html(i[0]))}),t}get ungrpHTML(){return[...this.intTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML]}}class _ extends h{get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}}class m extends h{get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}}class c extends o{constructor(t,e){e.transfer.info[0].push(e.transfer.info[1][0]),super(t,e),this._osiNames=e.transfer.osi_names[0],this._osiType=e.transfer.paid_area?"p":"u"}get osiClass(){return"u"==this._osiType?"rmg-stn__mtr--unpaid-osi":"rmg-stn__mtr--paid-osi"}get iconHTML(){var t=this.namePos?180:0;return $("<use>",{"xlink:href":"#osi11_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _dy(){return this.namePos?-26:26}get _txtAnchor(){return"middle"}get _osiNameDX(){return 0}get osiNameHTML(){var t=this._dy+8.34375-12.515625;return $("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x+this._osiNameDX},${this.y+t})`,class:"Name "+this._nameClass}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1]))}get ungrpHTML(){return[this.intTickHTML,this.iconHTML,this.nameHTML,this.intNameHTML,this.osiNameHTML]}}class l extends c{get _txtAnchor(){return"end"}get _osiNameDX(){return-13}}class g extends c{get _txtAnchor(){return"start"}get _osiNameDX(){return 13}}class d extends h{constructor(t,e){e.transfer.info[0].unshift(...e.transfer.info[1].slice(0,2)),super(t,e),this._osiNames=e.transfer.osi_names[0],this._osiType=e.transfer.paid_area?"p":"u"}get osiClass(){return"u"==this._osiType?"rmg-stn__mtr--unpaid-osi":"rmg-stn__mtr--paid-osi"}get iconHTML(){var t=this.namePos?180:0;return $("<use>",{"xlink:href":"#osi12_hk",transform:`translate(${this.x},${this.y})rotate(${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _dy(){return this.namePos?-8:8}get _osiDY(){return this.namePos?-70.6875:62.34375}get _osiTxtAnchor(){return"middle"}get _osiDX(){return 0}get osiNameHTML(){var t=-1==this.state?"Pass":"Future";return $("<g>",{"text-anchor":this._osiTxtAnchor,transform:`translate(${this.x+this._dx+this._osiDX},${this.y+this._osiDY})`,class:`Name ${t}`}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1].split("\\")[0]).append($("<tspan>",{x:0,dy:10}).text(this._osiNames[1].split("\\")[1]||"")))}get ungrpHTML(){return[...this.intTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.osiNameHTML]}}class u extends d{get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}}class p extends d{get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}}class x extends d{constructor(t,e){super(t,e),this._origIntInfo=e.transfer.info[0][2]}get _nameTxtAnchor(){return this._osiTxtAnchor}get _nameDY(){return this.namePos?11.515625:-11.515625}get origIntTickHTML(){var t=this.namePos?0:180,e=this._origIntInfo[r.b.colour],s=$("<use>",{"xlink:href":"#inttick_hk",stroke:e,transform:`translate(${this.x},${this.y})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&s.addClass("rmg-line__pass"),s}get origIntNameHTML(){var[t,e,s]=Object(r.k)([this._origIntInfo[r.b.nameZH],this._origIntInfo[r.b.nameEN]],10,7),n=this.namePos?30.953125:-37.703125-13*(e-1)-7*(s-1);return $("<g>",{"text-anchor":this._txtAnchor,transform:`translate(${this.x-this._nameDX},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get _osiNameDX(){return 0}get osiNameHTML(){var t=this._dy-(this.namePos?27:-27)+8.34375-12.515625;return $("<g>",{"text-anchor":this._osiTxtAnchor,transform:`translate(${this.x+this._osiNameDX},${this.y+t})`,class:"Name "+this._nameClass}).append($("<text>").addClass("rmg-name__zh rmg-name__mtr--osi").text(this._osiNames[0])).append($("<text>",{x:0,dy:12,class:"rmg-name__en rmg-name__mtr--osi"}).text(this._osiNames[1]))}get ungrpHTML(){return[...this.intTickHTML,this.origIntTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.origIntNameHTML,this.osiNameHTML]}}class f extends x{get _nameDX(){return 3}get _tickRotation(){return 90}get _txtAnchor(){return"end"}get _intNameDX(){return-24}get _osiNameDX(){return 13}get _osiTxtAnchor(){return"start"}}class N extends x{get _nameDX(){return-3}get _tickRotation(){return-90}get _txtAnchor(){return"start"}get _intNameDX(){return 24}get _osiNameDX(){return-13}get _osiTxtAnchor(){return"end"}}class T extends d{constructor(t,e){super(t,e),[this._origIntCity,this._origIntLine,this._origIntColour,this._origIntFg,this._origIntNameZH,this._origIntNameEN]=e.transfer.info[0][2]}get origIntTickHTML(){var t=this.namePos?180:0,e=this._origIntColour,s=$("<use>",{"xlink:href":"#inttick_hk",stroke:e,transform:`translate(${this.x},${this.y})rotate(${t})`,class:"rmg-line rmg-line__mtr rmg-line__change"});return-1==this.state&&s.addClass("rmg-line__pass"),s}get origIntNameHTML(){var[t,e,s]=Object(r.k)([this._origIntNameZH,this._origIntNameEN],10,7),n=this.namePos?-37.703125-13*(e-1)-7*(s-1):30.953125;return $("<g>",{"text-anchor":"middle",transform:`translate(${this.x},${this.y+n})`,class:`Name ${this._nameClass}`}).html(t[0])}get iconHTML(){var t=this.namePos?1:-1,e="lineend"==this.children[0]?1:-1;this.children[0];return $("<use>",{"xlink:href":"#osi22end_hk",transform:`translate(${this.x},${this.y})scale(${e},${t})`,class:[this.iconClass,this.osiClass].join(" ")})}get _tickRotation(){return"lineend"==this.children[0]?-90:90}get _tickFlip(){return-1}get _dx(){return"lineend"==this.children[0]?41:-41}get _dy(){return this.namePos?18:-18}get _intNameDX(){return"lineend"==this.children[0]?65:-65}get _txtAnchor(){return"lineend"==this.children[0]?"start":"end"}get _osiDY(){return this.namePos?-26.6875:18.34375}get _osiTxtAnchor(){return"lineend"==this.children[0]?"start":"end"}get _osiDX(){return"lineend"==this.children[0]?-9:9}get ungrpHTML(){return[...this.intTickHTML,this.origIntTickHTML,this.iconHTML,this.nameHTML,...this.intNameHTML,this.origIntNameHTML,this.osiNameHTML]}}s.d(e,"RMGLineHK",(function(){return L}));class L extends n.a{constructor(t){super(t),this._txtFlip=t.txt_flip,this._charForm=t.char_form,this._destLegacy=t.dest_legacy}_initStnInstance(t,e){switch(e.transfer.type){case"int2":case"osi21":return new o(t,e);case"int3":case"osi31":return"l"===e.transfer.tick_direc?new _(t,e):new m(t,e);case"osi11":return"l"===e.transfer.tick_direc?new l(t,e):new g(t,e);case"osi12":case"osi13":return"l"===e.transfer.tick_direc?new u(t,e):new p(t,e);case"osi22":return"linestart"===e.parents[0]||"lineend"===e.children[0]?new T(t,e):"l"===e.transfer.tick_direc?new f(t,e):new N(t,e);default:return new a(t,e)}}_updateStnInstance(t){super._updateStnInstance(t),this.stations[t].namePos=this._txtFlip?!this._stnNamePos(t):this._stnNamePos(t)}set svgDestWidth(t){super.svgDestWidth=t,this.loadFonts()}set svgWidth(t){super.svgWidth=t,this.loadFonts(),this.updateStnNameBg()}set padding(t){super.padding=t,this.loadFonts(),this.updateStnNameBg()}set branchSpacing(t){super.branchSpacing=t,this.loadFonts(),this.updateStnNameBg()}set txtFlip(t){this._txtFlip=t,Object(r.n)("txt_flip",t);for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||(e.namePos=this._txtFlip?!this._stnNamePos(t):this._stnNamePos(t));$("#stn_icons").empty(),this.drawStns(),this.loadFonts(),this.updateStnNameBg()}set direction(t){super.direction=t,this.loadFonts()}set charForm(t){this._charForm=t,Object(r.n)("char_form",t),$(".rmg-name__char-trad, .rmg-name__char-cn, .rmg-name__char-tw, .rmg-name__char-jp").removeClass("rmg-name__char-trad rmg-name__char-cn rmg-name__char-tw rmg-name__char-jp").addClass(`rmg-name__char-${t}`)}set lineNames(t){super.lineNames=t,this._destLegacy&&(this.drawDestInfo(),this.loadFonts())}set destLegacy(t){this._destLegacy=t,Object(r.n)("dest_legacy",t),this.drawDestInfo(),this.loadFonts()}set currentStnId(t){super.currentStnId=t,this.loadFonts(),this.updateStnNameBg()}_stnNamePos(t){if("linestart"===t)return!0;let e=this,s=this.criticalPath.nodes.indexOf(t)%2;if(-1===s){let s=this.stations[t].parents[0];return 2===this._stnOutdegree(s)?e._stnNamePos(s):!e._stnNamePos(s)}return 1===s}loadFonts(){$(".rmg-name__zh").addClass(`rmg-name__char-${this._charForm}`)}updateStnNameBg(){var t=Object(r.j)($(`#stn_icons > #${this._currentStnId} g.Name`)[0],"railmap");$("#current_bg").attr({x:t.x-3,width:t.width+6})}drawDestInfo(){$("#dest_name > #platform > text").text(this._platformNum);let t=this[this._direction+"ValidDests"],e="l"===this._direction?"start":"end";var[s,n]=[0,1].map(e=>t.map(t=>this.stations[t].name[e].replace(/\\/g," ")).join("/"));if(this._destLegacy){var[r,i]=this._lineNames;i+=" "}else var r=i="";$("#dest_name > g:last-child text").eq(0).text(`${r}往${s}`),$("#dest_name > g:last-child text").eq(1).text(`${i}to ${n}`);var a=310+$("#dest_name > g:last-child")[0].getBoundingClientRect().width+45+50,o="l"==this._direction?1:-1,h=(this._svgDestWidth-o*a)/2,_=90*(1-o),m=h+285*o,c=m+120*o;$("#dest_name > use").attr("transform",`translate(${h},130)rotate(${_})`),$("#dest_name > #platform").attr("transform",`translate(${m},130)`),$("#dest_name > g:last-child").attr({transform:`translate(${c},105)`,"text-anchor":e})}_leftWideFactor(t){var e=0;let s=this.stations[t];return s instanceof _&&(e+=this._longInterval),s instanceof l&&(e+=this._longInterval),s instanceof u&&(e+=this._longInterval),s instanceof x&&(e+=this._longInterval),2==this._stnIndegree(t)&&(e+=this._longInterval/2),2==this._stnOutdegree(this.stations[t].parents[0])&&(e+=this._longInterval/2),e}_rightWideFactor(t){var e=0;let s=this.stations[t];return s instanceof m&&(e+=this._longInterval),s instanceof g&&(e+=this._longInterval),s instanceof p&&(e+=this._longInterval),s instanceof x&&(e+=this._longInterval),2==this._stnOutdegree(t)&&(e+=this._longInterval/2),2==this._stnIndegree(this.stations[t].children[0])&&(e+=this._longInterval/2),e}updateStnName(t,e,s){super.updateStnName(t,e,s),this.loadFonts(),t==this._currentStnId&&this.updateStnNameBg()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),this.loadFonts(),this.updateStnNameBg()}addStn(t,e,s,n){let r=super.addStn(t,e,s,n);return this.loadFonts(),this.updateStnNameBg(),r}removeStn(t){return!!super.removeStn(t)&&(this.loadFonts(),this.updateStnNameBg(),!0)}updateBranchType(t,e,s){return!!super.updateBranchType(t,e,s)&&(this.loadFonts(),!0)}updateBranchFirst(t,e,s){return!!super.updateBranchFirst(t,e,s)&&(this.loadFonts(),!0)}updateBranchPos(t,e,s){return!!super.updateBranchPos(t,e,s)&&(this.loadFonts(),!0)}static initSVG(t){super.initSVG(t),t.loadFonts(),t.updateStnNameBg()}}}}]);