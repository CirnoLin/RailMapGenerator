!function(e){function t(t){for(var n,a,l=t[0],i=t[1],o=0,c=[];o<l.length;o++)a=l[o],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&c.push(r[a][0]),r[a]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(s&&s(t);c.length;)c.shift()()}var n={},r={48:0};function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var l=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=l);var i,o=document.createElement("script");o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.src=function(e){return a.p+""+({0:"templates0",1:"colours0",2:"colours10",3:"colours12",4:"colours14",5:"colours16",6:"colours18",7:"colours2",8:"colours20",9:"colours22",10:"colours24",11:"colours26",12:"colours28",13:"colours30",14:"colours32",15:"colours34",16:"colours36",17:"colours38",18:"colours4",19:"colours40",20:"colours42",21:"colours6",22:"colours8",23:"templates10",24:"templates12",25:"templates14",26:"templates16",27:"templates18",28:"templates2",29:"templates20",30:"templates22",31:"templates24",32:"templates26",33:"templates28",34:"templates30",35:"templates32",36:"templates34",37:"templates36",38:"templates38",39:"templates4",40:"templates40",41:"templates42",42:"templates44",43:"templates46",44:"templates6",45:"templates8",46:"destinationMTR",47:"destinationSHMetro",49:"panelDesign",50:"panelDesignGZMTR",51:"panelDesignMTR",52:"panelInfo",53:"panelLayout",54:"panelLayoutGZMTR",55:"panelPreviewMTR",56:"panelSave",57:"panelSaveTemplateDialog",58:"panelStations",59:"panelStationsBranch",60:"panelStationsInterchange",61:"panelStationsMore",62:"panelStationsName",63:"railmapGZMTR",64:"railmapMTR",65:"railmapSHMetro",66:"runinMTR",67:"runinSHMetro"}[e]||e)+".min.js"}(e);var s=new Error;i=function(t){o.onerror=o.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+l+")",s.name="ChunkLoadError",s.type=a,s.request=l,n[1](s)}r[e]=void 0}};var c=setTimeout((function(){i({type:"timeout",target:o})}),12e4);o.onerror=o.onload=i,document.head.appendChild(o)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="./dist/",a.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var o=0;o<l.length;o++)t(l[o]);var s=i;a(a.s=10)}([function(e,t){e.exports=React},function(e,t){e.exports=MaterialUI},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(0),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},l=r.createContext(null),i=r.createContext(null),o=function(e,t){var n,r,l,i,o,s,c,u,f,m,h,p,d,g,_,y,v;switch(t.type){case"GLOBAL":return t.data;case"ANY":return a(a({},e),((n={})[t.key]=t.data,n));case"SET_HEIGHT":return a(a({},e),{svg_height:t.value});case"SET_WIDTH":return a(a({},e),{svgWidth:a(a({},e.svgWidth),(r={},r[t.targetId]=t.value,r))});case"SET_Y":return a(a({},e),{y_pc:t.value});case"SET_BRANCH_SPACING":return a(a({},e),{branch_spacing:t.value});case"SET_PADDING":return a(a({},e),{padding:t.value});case"SET_DIRECTION_GZ_X":return a(a({},e),{direction_gz_x:t.value});case"SET_DIRECTION_GZ_Y":return a(a({},e),{direction_gz_y:t.value});case"SET_LINE_NAME":return a(a({},e),{line_name:t.name});case"SET_THEME":return a(a({},e),{theme:t.theme});case"SET_DIRECTION":return a(a({},e),{direction:"l"===e.direction?"r":"l"});case"SET_PLATFORM":return a(a({},e),{platform_num:t.platform});case"SET_TEXT_FLIP":return a(a({},e),{txt_flip:!e.txt_flip});case"SET_DEST_LEGACY":return a(a({},e),{dest_legacy:t.isLegacy,customiseMTRDest:a(a({},e.customiseMTRDest),{isLegacy:t.isLegacy})});case"SET_TERMINAL_OVERRIDE":return a(a({},e),{customiseMTRDest:a(a({},e.customiseMTRDest),{terminal:t.terminal})});case"SET_LINE_NUM":return a(a({},e),{line_num:t.num});case"SET_PSD_NUM":return a(a({},e),{psd_num:t.num});case"SET_PANEL_TYPE":return a(a({},e),{info_panel_type:t.variant});case"ADD_NOTE_GZMTR":return a(a({},e),{notesGZMTR:e.notesGZMTR.concat([["","",0,0,!1]])});case"REMOVE_NOTE_GZMTR":return a(a({},e),{notesGZMTR:e.notesGZMTR.filter((function(e,n){return n!==t.idx}))});case"UPDATE_NOTE_GZMTR":return a(a({},e),{notesGZMTR:e.notesGZMTR.map((function(e,n){return n===t.idx?t.note:e}))});case"UPDATE_STATION_NAME":return a(a({},e),{stn_list:a(a({},e.stn_list),(l={},l[t.stnId]=a(a({},e.stn_list[t.stnId]),{name:t.name}),l))});case"UPDATE_STATION_NUM":return a(a({},e),{stn_list:a(a({},e.stn_list),(i={},i[t.stnId]=a(a({},e.stn_list[t.stnId]),{num:t.num}),i))});case"UPDATE_STATION_TRANSFER":return a(a({},e),{stn_list:a(a({},e.stn_list),(o={},o[t.stnId]=a(a({},e.stn_list[t.stnId]),{transfer:t.transfer}),o))});case"UPDATE_STATION_INTERCHANGE_INFO":return a(a({},e),{stn_list:a(a({},e.stn_list),(s={},s[t.stnId]=a(a({},e.stn_list[t.stnId]),{transfer:a(a({},e.stn_list[t.stnId].transfer),{info:e.stn_list[t.stnId].transfer.info.map((function(e,n){return n===t.setIdx?e.map((function(e,n){return n===t.intIdx?[0,1,2,3,4,5].map((function(n){return void 0===t.info[n]?e[n]:t.info[n]})):e})):e}))})}),s))});case"UPDATE_STATION_OSI_NAME":return a(a({},e),{stn_list:a(a({},e.stn_list),(c={},c[t.stnId]=a(a({},e.stn_list[t.stnId]),{transfer:a(a({},e.stn_list[t.stnId].transfer),{osi_names:[t.name]})}),c))});case"UPDATE_STATION_TICK_DIREC":return a(a({},e),{stn_list:a(a({},e.stn_list),(u={},u[t.stnId]=a(a({},e.stn_list[t.stnId]),{transfer:a(a({},e.stn_list[t.stnId].transfer),{tick_direc:t.direction})}),u))});case"UPDATE_STATION_PAID_AREA":return a(a({},e),{stn_list:a(a({},e.stn_list),(f={},f[t.stnId]=a(a({},e.stn_list[t.stnId]),{transfer:a(a({},e.stn_list[t.stnId].transfer),{paid_area:t.isPaid})}),f))});case"UPDATE_STATION_BRANCH_TYPE":return a(a({},e),{stn_list:a(a({},e.stn_list),(m={},m[t.stnId]=a(a({},e.stn_list[t.stnId]),{branch:a(a({},e.stn_list[t.stnId].branch),(h={},h[t.direction]=[t.branchType,e.stn_list[t.stnId].branch[t.direction][1]],h))}),m))});case"UPDATE_STATION_BRANCH_FIRST":return a(a({},e),{stn_list:a(a({},e.stn_list),(p={},p[t.branches[0].stnId]=a(a({},e.stn_list[t.branches[0].stnId]),{branch:a(a({},e.stn_list[t.branches[0].stnId].branch),(d={},d[t.branches[0].direction]=[e.stn_list[t.branches[0].stnId].branch[t.branches[0].direction][0],t.branches[0].first],d))}),p[t.branches[1].stnId]=a(a({},e.stn_list[t.branches[1].stnId]),{branch:a(a({},e.stn_list[t.branches[1].stnId].branch),(g={},g[t.branches[1].direction]=[e.stn_list[t.branches[1].stnId].branch[t.branches[1].direction][0],t.branches[1].first],g))}),p))});case"UPDATE_STATION_BRANCH_POS":return a(a({},e),{stn_list:a(a({},e.stn_list),(_={},_[t.left]=a(a({},e.stn_list[t.left]),{parents:e.stn_list[t.left].parents.slice().reverse()}),_[t.right]=a(a({},e.stn_list[t.right]),{children:e.stn_list[t.right].children.slice().reverse()}),_))});case"UPDATE_STATION_FACILITY":return a(a({},e),{stn_list:a(a({},e.stn_list),(y={},y[t.stnId]=a(a({},e.stn_list[t.stnId]),{facility:t.facility}),y))});case"UPDATE_STATION_SERVICES":return a(a({},e),{stn_list:a(a({},e.stn_list),(v={},v[t.stnId]=a(a({},e.stn_list[t.stnId]),{services:Array.from(t.isChecked?new Set(e.stn_list[t.stnId].services).add(t.serviceId):e.stn_list[t.stnId].services.filter((function(e){return e!==t.serviceId})))}),v))});case"UPDATE_STATION_LIST":return a(a({},e),{stn_list:t.stnList});default:return e}}},function(e,t){e.exports=ReactI18next},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n(0),a=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i},l=function(e,t){if(["linestart","lineend"].includes(e)||t[e].parents.length>1||t[e].children.length>1)return 0;var n=t[e].parents[0];return n?1==t[n].children.length?l(n,t):0==t[n].children.indexOf(e)?1:-1:0},i=function(e){console.log("computing branches");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),l=n[r].slice().reverse()[0]||null;for(l&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var i=e[l=a].children;switch(i.length){case 1:a=i[0];break;case 2:var o=e[l].branch.right[1];"through"===e[l].branch.right[0]?(n.push([a]),t.push(o)):0===r&&(n.push([l]),t.push(o)),a=i.filter((function(e){return e!=o}))[0]}if(n[r].push(a),l===e[a].branch.left[1])break}r++}return n},o=function(e){console.log("computing routes");for(var t=["linestart"],n=[["linestart"]],r=0;t.length;){var a=t.shift(),l=n[r].slice().reverse()[0]||null;for(l&&"linestart"!==a?n[r].push(a):n[r]=[a];"lineend"!==a;){var i=e[l=a].children;switch(i.length){case 1:a=i[0];break;case 2:var o=e[l].branch.right[1];"through"===e[l].branch.right[0]?(n.push(n[r].slice()),t.push(o)):0===r&&(n.push([l]),t.push(o)),a=i.filter((function(e){return e!=o}))[0]}if(n[r].push(a),l===e[a].branch.left[1]&&"nonthrough"===e[a].branch.left[0])break}r++}return n},s=function(e){var t=a(r.useState([]),2),n=t[0],l=t[1];return r.useEffect((function(){if(console.log("computing tpo"),1!==e.length){var t=e.reduce((function(e,t){var n=e.indexOf(t.slice(-1)[0]);return e.slice(0,n).concat(t.slice(1),e.slice(n+1))}),["lineend"]).slice(0,-1);l(t)}else l(e[0].slice(1,-1))}),[e.toString()]),n}},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i};function l(){var e,t,n,l,i,o,s,c,u,f,m,h,p,d,g,_,y,v,b=JSON.parse(localStorage.rmgParam);"line_name"in b||(b.line_name=["路線名","Name of Line"]),"dest_legacy"in b||(b.dest_legacy=!1),"char_form"in b||(b.char_form=function(e){switch(e){case"KR":return"trad";case"TC":return"tw";case"SC":return"cn";case"JP":return"jp"}}(b.fontZH[0].split(" ").reverse()[0])),delete b.fontZH,delete b.fontEN,delete b.weightZH,delete b.weightEN;try{for(var E=r(Object.entries(b.stn_list)),T=E.next();!T.done;T=E.next()){var S=a(T.value,2),I=S[0];"branch"in(P=S[1])||(b.stn_list[I].branch={left:[],right:[]},2==P.children.length?b.stn_list[I].branch.right=["through",P.children[1]]:b.stn_list[I].branch.right=[],2==P.parents.length?b.stn_list[I].branch.left=["through",P.parents[1]]:b.stn_list[I].branch.left=[])}}catch(t){e={error:t}}finally{try{T&&!T.done&&(t=E.return)&&t.call(E)}finally{if(e)throw e.error}}"psd_num"in b||(b.psd_num=1),"line_num"in b||(b.line_num=1),delete b.style,3==b.theme.length&&b.theme.push("#fff");try{for(var w=r(Object.entries(b.stn_list)),O=w.next();!O.done;O=w.next()){var x=a(O.value,2),P=(I=x[0],x[1]);["linestart","lineend"].includes(I)||("num"in P||(b.stn_list[I].num="00"))}}catch(e){n={error:e}}finally{try{O&&!O.done&&(l=w.return)&&l.call(w)}finally{if(n)throw n.error}}try{for(var M=r(Object.entries(b.stn_list)),N=M.next();!N.done;N=M.next()){var A=a(N.value,2);I=A[0];"interchange"in(P=A[1])&&P.interchange.map((function(e){e.map((function(e){5==e.length&&e.splice(3,0,"#fff")}))}))}}catch(e){i={error:e}}finally{try{N&&!N.done&&(o=M.return)&&o.call(M)}finally{if(i)throw i.error}}"info_panel_type"in b||(b.info_panel_type="panasonic");try{for(var j=r(Object.entries(b.stn_list)),R=j.next();!R.done;R=j.next()){var k=a(R.value,2);I=k[0];"osi22_end_p"===(P=k[1]).change_type&&(b.stn_list[I].change_type="osi22_pr"),"osi22_end_u"===P.change_type&&(b.stn_list[I].change_type="osi22_ur")}}catch(e){s={error:e}}finally{try{R&&!R.done&&(c=j.return)&&c.call(j)}finally{if(s)throw s.error}}try{for(var C=r(Object.entries(b.stn_list)),D=C.next();!D.done;D=C.next()){var z=a(D.value,2);I=z[0];"interchange"in(P=z[1])||(b.stn_list[I].interchange=[[]])}}catch(e){u={error:e}}finally{try{D&&!D.done&&(f=C.return)&&f.call(C)}finally{if(u)throw u.error}}"gz_1"===b.info_panel_type&&(b.info_panel_type="gz28"),"panasonic"===b.info_panel_type&&(b.info_panel_type="gz28"),"gz_2"===b.info_panel_type&&(b.info_panel_type="gzgf"),"gz_3"===b.info_panel_type&&(b.info_panel_type="gz3"),"direction_gz_x"in b||(b.direction_gz_x=50),"direction_gz_y"in b||(b.direction_gz_y=70);try{for(var L=r(Object.entries(b.stn_list)),G=L.next();!G.done;G=L.next()){var H=a(G.value,2);I=H[0];"transfer"in(P=H[1])||(b.stn_list[I].transfer={type:P.change_type.split("_")[0],tick_direc:"none"===P.change_type||"int2"===P.change_type?"r":P.change_type.split("_")[1].split("").slice().reverse()[0],paid_area:-1===P.change_type.indexOf("osi")||"p"===P.change_type.split("_")[1][0],osi_names:-1!==P.change_type.indexOf("osi")?[P.interchange[1][0]]:[],info:2===P.interchange.length?[P.interchange[0],P.interchange[1].slice(1)]:P.interchange})}}catch(e){m={error:e}}finally{try{G&&!G.done&&(h=L.return)&&h.call(L)}finally{if(m)throw m.error}}try{for(var B=r(Object.entries(b.stn_list)),U=B.next();!U.done;U=B.next()){var Z=a(U.value,2);I=Z[0];"services"in(P=Z[1])||(b.stn_list[I].services=["local"])}}catch(e){p={error:e}}finally{try{U&&!U.done&&(d=B.return)&&d.call(B)}finally{if(p)throw p.error}}try{for(var F=r(Object.entries(b.stn_list)),W=F.next();!W.done;W=F.next()){var J=a(W.value,2);I=J[0];"usage"in(P=J[1])||(b.stn_list[I].usage="")}}catch(e){g={error:e}}finally{try{W&&!W.done&&(_=F.return)&&_.call(F)}finally{if(g)throw g.error}}try{for(var Y=r(Object.entries(b.stn_list)),K=Y.next();!K.done;K=Y.next()){var X=a(K.value,2);I=X[0];"facility"in(P=X[1])||(b.stn_list[I].facility=P.usage)}}catch(e){y={error:e}}finally{try{K&&!K.done&&(v=Y.return)&&v.call(Y)}finally{if(y)throw y.error}}"customiseMTRDest"in b||(b.customiseMTRDest={isLegacy:b.dest_legacy,terminal:!1}),"svgWidth"in b||(b.svgWidth={destination:b.svg_dest_width,runin:b.svg_dest_width,railmap:b.svg_width}),"notesGZMTR"in b||(b.notesGZMTR=[]),b.notesGZMTR=b.notesGZMTR.map((function(e){return 4===e.length?e.concat([!1]):e})),localStorage.setItem("rmgParam",JSON.stringify(b))}var i=function(e,t){return t.reduce((function(t,n){return t||(e[n]?e[n]:t)}),"")},o=function(e){var t,n;return("gzmtr"===window.urlParams.get("style")?((null===(t=e)||void 0===t?void 0:t.num)||"-")+": ":"")+(null===(n=e)||void 0===n?void 0:n.name.join().replace("\\"," "))}},function(e,t){e.exports=i18next},function(e,t){e.exports=ReactDOM},function(e,t){e.exports=i18nextXHRBackend},function(e,t){e.exports=i18nextBrowserLanguageDetector},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(7),l=n(6),i=n.n(l),o=n(3),s=n(8),c=n.n(s),u=n(9),f=n.n(u);i.a.use(c.a).use(f.a).use(o.initReactI18next).init({fallbackLng:{"zh-CN":["zh-Hans","en"],"zh-Hant":["zh-HK","en"],"zh-HK":["zh-Hant","en"],"zh-TW":["zh-HK","zh-Hant"],default:["en"]},backend:{loadPath:"./locale/{{lng}}.json"},interpolation:{escapeValue:!1}}).then((function(e){document.title=e("title"),document.documentElement.setAttribute("lang",i.a.language)}));var m=n(1),h=n(2),p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i},d=Object(m.makeStyles)((function(e){return Object(m.createStyles)({rootLight:{backgroundColor:e.palette.primary.main},rootDark:{backgroundColor:e.palette.background.paper},title:{flexGrow:1,color:"#fff"},menuButton:{color:"#fff"}})})),g=function(){var e=Object(o.useTranslation)(),t=e.t,n=e.i18n,a=d(),l=Object(m.useMediaQuery)("(prefers-color-scheme: dark)");return r.useMemo((function(){return r.createElement(m.AppBar,{position:"sticky",className:l?a.rootDark:a.rootLight},r.createElement(m.Toolbar,{variant:"dense"},r.createElement(m.Typography,{variant:"h6",className:a.title,color:"textPrimary"},t("title")),r.createElement(_,null),r.createElement(y,null)))}),[l,n.language])},_=function(){var e=Object(o.useTranslation)().t,t=d(),n=r.useContext(h.a),a=n.canvasAvailable,l=n.setCanvasToShown,i=p(r.useState(null),2),s=i[0],c=i[1],u=function(e){return function(){l(e),c(null)}};return r.useMemo((function(){return r.createElement(r.Fragment,null,r.createElement(m.Tooltip,{title:e("toggle.tooltip")},r.createElement(m.IconButton,{onClick:function(e){return c(e.currentTarget)},className:t.menuButton},r.createElement(m.Icon,null,"photo_library"))),r.createElement(m.Menu,{anchorEl:s,open:Boolean(s),onClose:function(){return c(null)}},a.map((function(t){return r.createElement(m.MenuItem,{key:t,onClick:u(t)},e("toggle."+t))})),r.createElement(m.Divider,{style:{margin:"6px 0"}}),r.createElement(m.MenuItem,{onClick:u("all")},e("toggle.all"))))}),[a.toString(),s,t.menuButton])},y=function(){var e=Object(o.useTranslation)().t,t=d(),n=r.useContext(h.a).setCanvasScale;return r.useMemo((function(){return r.createElement(r.Fragment,null,r.createElement(m.Tooltip,{title:e("zoom.out")},r.createElement(m.IconButton,{onClick:function(){return n((function(e){return e<=.1?e:e-.1}))},className:t.menuButton},r.createElement(m.Icon,null,"zoom_out"))),r.createElement(m.Tooltip,{title:e("zoom.in")},r.createElement(m.IconButton,{onClick:function(){return n((function(e){return e+.1}))},className:t.menuButton},r.createElement(m.Icon,null,"zoom_in"))))}),[t.menuButton])},v=function(){return(v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},b=function(e){switch(window.urlParams.get("style")){case"shmetro":return r.lazy((function(){return n.e(47).then(n.bind(null,65))}));default:return r.lazy((function(){return n.e(46).then(n.bind(null,66))}))}}(),E=function(e){return r.createElement("svg",v({},e),e.children,r.createElement(b,null))},T=function(){return(T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},S=function(e){switch(window.urlParams.get("style")){case"shmetro":return r.lazy((function(){return n.e(67).then(n.bind(null,67))}));default:return r.lazy((function(){return n.e(66).then(n.bind(null,84))}))}}(),I=function(e){return r.createElement("svg",T({},e),e.children,r.createElement(S,null))},w=function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},O=function(e){switch(window.urlParams.get("style")){case"gzmtr":return r.lazy((function(){return n.e(63).then(n.bind(null,78))}));case"shmetro":return r.lazy((function(){return n.e(65).then(n.bind(null,82))}));default:return r.lazy((function(){return n.e(64).then(n.bind(null,79))}))}}(),x=function(e){return r.createElement("svg",w({},e),e.children,r.createElement(O,null))},P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},M=Object(m.makeStyles)((function(){return Object(m.createStyles)({root:{display:"flex",flexDirection:"row",overflowX:"scroll","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}}})})),N=function(){var e=M(),t=r.useContext(h.b).param,n=r.useContext(h.a),a=n.canvasAvailable,l=n.canvasToShown,i=n.canvasScale,o=function(e){var n;return{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:t.svg_height*i,viewBox:"0 0 "+t.svgWidth[e]+" "+t.svg_height,style:(n={},n["--rmg-svg-width"]=t.svgWidth[e]+"px",n["--rmg-svg-height"]=t.svg_height+"px",n["--rmg-theme-colour"]=t.theme[2],n["--rmg-theme-fg"]=t.theme[3],n),children:r.createElement("rect",{x:0,y:0,fill:"white",stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})}};return r.createElement("div",{className:e.root},a.map((function(e){return[e,"all"].includes(l)&&r.createElement(r.Suspense,{key:e,fallback:r.createElement(m.CircularProgress,null)},function(e){switch(e){case"destination":return r.createElement(E,P({},o(e)));case"runin":return r.createElement(I,P({},o(e)));case"railmap":return r.createElement(x,P({},o(e)))}}(e))})))},A=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i},j=r.lazy((function(){return n.e(56).then(n.bind(null,77))})),R=r.lazy((function(){return n.e(53).then(n.bind(null,80))})),k=r.lazy((function(){return n.e(49).then(n.bind(null,81))})),C=r.lazy((function(){return n.e(58).then(n.bind(null,76))})),D=r.lazy((function(){return n.e(52).then(n.bind(null,68))})),z=Object(m.makeStyles)((function(e){return Object(m.createStyles)({typography:{background:e.palette.background.default},tab:{padding:"6px 24px",height:48,minWidth:"calc(100% / 5)","& .MuiTab-wrapper":{flexDirection:"row"},"&.MuiTab-labelIcon":{minHeight:"unset","& .MuiTab-wrapper":{"& > *:first-child":{marginBottom:0},"& > *:not(first-child)":{paddingLeft:8}}}},box:{display:"flex",justifyContent:"center",alignItems:"center"}})}));function L(e){var t=Object(o.useTranslation)(),n=t.t,a=t.i18n,l=z(),i=A(r.useState(0),2),s=i[0],c=i[1],u=r.useMemo((function(){return r.createElement(m.Typography,{className:l.typography,component:"div"},r.createElement(m.Tabs,{value:s,indicatorColor:"primary",textColor:"primary",onChange:function(e,t){return c(t)},variant:"scrollable",scrollButtons:"off"},[["file","insert_drive_file"],["layout","panorama"],["design","brush"],["stations","directions_transit"],["info","info"]].map((function(e,t){return r.createElement(m.Tab,{label:r.createElement("span",null,n("tab."+e[0])),icon:r.createElement(m.Icon,null,e[1]),key:t,className:l.tab})})),"/>"))}),[s,a.language,l.tab]);return r.createElement(r.Fragment,null,u,r.createElement(m.Typography,{className:l.typography,component:"div",role:"tabpanel",style:{overflow:"auto"}},r.createElement(m.Box,{p:3,className:l.box},r.createElement(r.Suspense,{fallback:r.createElement(m.CircularProgress,null)},function(t){switch(t){case 0:return r.createElement(j,null);case 1:return r.createElement(R,null);case 2:return r.createElement(k,null);case 3:return r.createElement(C,{theme:e.param.theme,stnList:e.param.stn_list,currentId:e.param.current_stn_idx,paramUpdate:e.paramUpdate,tpo:e.tpo});case 4:return r.createElement(D,null);default:return r.createElement(j,null)}}(s)))))}var G=function(){return(G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},H=function(e){return r.createElement(r.Suspense,{fallback:r.createElement(m.CircularProgress,null)},r.createElement(L,G({},e)))},B=n(4),U=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i},Z=Object(m.createMuiTheme)({palette:{type:"dark",primary:{main:"#bb86fc"},secondary:{main:"#018786"},error:{main:"#cf6679"}},overrides:{MuiDialog:{paper:{minWidth:280}}}}),F=Object(m.createMuiTheme)({palette:{primary:{light:"#bb86fc",main:"#6200ee"},secondary:{main:"#018786"},error:{main:"#b00020"}},overrides:{MuiDialog:{paper:{minWidth:280}}}});function W(e){var t=Object(m.useMediaQuery)("(prefers-color-scheme: dark)")?Z:F,n=U(r.useState(e.canvas.includes(localStorage.rmgCanvas)?localStorage.rmgCanvas:"all"),2),a=n[0],l=n[1];r.useEffect((function(){return localStorage.setItem("rmgCanvas",a)}),[a]);var i=U(r.useState(Number(localStorage.rmgScale)>=.1?Number(localStorage.rmgScale):1),2),o=i[0],s=i[1];return r.useEffect((function(){return localStorage.setItem("rmgScale",o.toFixed(1))}),[o]),r.createElement(r.Fragment,null,r.createElement(m.ThemeProvider,{theme:t},r.createElement(h.a.Provider,{value:{canvasAvailable:e.canvas,canvasToShown:a,setCanvasToShown:l,canvasScale:o,setCanvasScale:s}},r.createElement(r.Suspense,{fallback:r.createElement(m.LinearProgress,null)},r.createElement(g,null)),r.createElement(Y,null))))}var J,Y=function(){var e=U(r.useReducer(h.c,JSON.parse(localStorage.rmgParam)),2),t=e[0],n=e[1],a=JSON.stringify(t);r.useEffect((function(){return localStorage.setItem("rmgParam",a)}),[a]);var l=Object.keys(t.stn_list).reduce((function(e,n){return e+n+function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.reduce((function(e,n){return e+JSON.stringify(t[n])}),"")}}("parents","children","branch")(t.stn_list[n])}),""),i=r.useMemo((function(){return Object(B.a)(t.stn_list)}),[l]),o=r.useMemo((function(){return Object(B.b)(t.stn_list)}),[l]),s=Object(B.d)(i);return r.createElement(r.Fragment,null,r.createElement(h.b.Provider,{value:{param:t,dispatch:n,branches:i,routes:o,deps:l}},r.createElement(N,null),r.createElement("div",{style:{flex:1,overflow:"auto",display:"flex",flexDirection:"column"}},r.createElement(H,{param:t,paramUpdate:function(e,t){return n({type:"ANY",key:e,data:t})},tpo:s}))),r.createElement("canvas",{style:{display:"none"}}))},K=n(5),X=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(a)throw a.error}}return i},V=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(X(arguments[t]));return e};switch(window.urlParams.get("style")){case"mtr":case"gzmtr":case"shmetro":break;default:window.urlParams.set("style","mtr")}history.pushState({url:window.location.href},null,"?"+window.urlParams.toString());var q=function(e){switch(window.urlParams.get("style")){case"mtr":return["destination","railmap"];case"gzmtr":return["runin","railmap"];case"shmetro":return["destination","runin","railmap"];default:return[]}}();(J=document.head).append.apply(J,V(V(["share"],q).map((function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href="styles/"+e+"_"+window.urlParams.get("style")+".css",t.id="css_"+e,t}))));var Q=function(){a.render(r.createElement(W,{canvas:q}),document.querySelectorAll("div#root")[0])};if(localStorage.rmgParam){try{Object(K.c)()}catch(e){alert(e+"Something error! Please refresh to start from a new canvas. "),console.error(e),localStorage.removeItem("rmgParam")}Q()}else n.e(0).then(n.bind(null,40)).then((function(e){localStorage.setItem("rmgParam",JSON.stringify(e.default)),Object(K.c)()})).then((function(){return Q()}))}]);