(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,e,s){"use strict";s.r(e);var n=s(7),a=s(1);class i extends a.l{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-60)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends i{constructor(t,e){super(t,e),this._intInfos=e.interchange[0][0]}get ungrpHTML(){return[this.iconHTML,this.nameHTML,...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[a.d.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){var t=1==this.namePos?180:0,e=this._intInfos[a.d.colour],s=$("<use>",{"xlink:href":"#int_sh",fill:e,transform:`translate(10,-10)rotate(${t})`,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&s.addClass("rmg-line__pass");var n=String(this._intInfos[a.d.nameZH]).match(/(\d*)\w+/);if(n)var i=n[0];else i=String(this._intInfos[a.d.nameZH]);return[s,$("<text>",{transform:`translate(15,10)rotate(${t})`,class:"rmg-name__zh rmg-name__shmetro--line_name"}).text(i)]}get _nameClass(){return-1==this.state?"Pass":"Future"}}s.d(e,"RMGLineSH",(function(){return h}));class h extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":return new r(t,e);default:return new i(t,e)}}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1]));var n=(a=this._linePath(e)).match(/[\d.]+/g);a=`M ${n[0]},${n[1]} H ${Number(n[2])+30}`,$("#line_main").append($("<path>",{d:a}));var a;n=(a=this._linePath(s)).match(/[\d.]+/g);a=`M ${Number(n[0])-30},${n[1]} H ${n[2]}`,$("#line_pass").append($("<path>",{d:a}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("path#int2_sh_pass").attr("stroke","#aaa"),$("#line_shmetro_left_use").attr("fill",this._themeColour),this._lineNames[0].match(/(\d*)\w+/)?$("#station_info_shmetro > #line_number > text").attr("fill","#fff"):$("#station_info_shmetro > #line_name_text").attr("fill","#fff")}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50,e="r"==this._direction?1:-1,s=(this._svgDestWidth-e*t)/20;s="r"==this._direction?s:this._svgDestWidth-20;var n=90*(1-e);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${s},135)rotate(${n})`);var a=s+285*e;if($("#station_info_shmetro > #platform").attr("transform",`translate(${a},130)`),"l"===this._direction)var i="end",r=.8*this._svgDestWidth;else i="start",r=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${r},135)`,"text-anchor":i});var[h,o]=["",""];if(this[`${this._direction}ValidDests`].forEach(t=>{h+=this.stations[t].name[0],o+=this.stations[t].name[1]}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${h}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${o}`),"l"===this._direction){i="end";var _=180}else i="start",_=this._svgDestWidth;var[l,m]=this._lineNames,d=l.match(/(\d*)\w+/);d?(_-=180,l="号线",$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${_-120},70)`}),$("#station_info_shmetro > #line_number > text").text(d[0]).attr("transform",`translate(${_-100},170)`)):(_-=280,$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${_-10},60)`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(l),$("#station_info_shmetro > #line_name_text > text:last-child").text(m),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${_},135)`,"text-anchor":i}),$("#line_shmetro_left_use").attr({transform:"translate(0,220)"})}updateStnNameBg(){$("#current_bg").hide()}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJuYW1lRU5MbiIsIm5hbWUiLCJzcGxpdCIsImxlbmd0aCIsImR4IiwiX25hbWVTaGlmdCIsIl90aWNrUm90YXRpb24iLCJNYXRoIiwiY29zIiwiaWNvblR5cGUiLCJudW1DbGFzcyIsInN0YXRlIiwic3RhdGlvbl9pZCIsIiQiLCJ0cmFuc2Zvcm0iLCJ4IiwiYXBwZW5kIiwiY2xhc3MiLCJkeSIsIl9keGR5IiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiX2ludEluZm9zIiwiaW50ZXJjaGFuZ2UiLCJpY29uSFRNTCIsIm5hbWVIVE1MIiwiaW50VGlja0hUTUwiLCJzdHJva2UiLCJjb2xvdXIiLCJ0aWNrUm90YXRpb24iLCJuYW1lUG9zIiwidGlja0NvbG91ciIsInRpY2siLCJmaWxsIiwibGluZU51bWJlciIsIlN0cmluZyIsIm5hbWVaSCIsIm1hdGNoIiwibGluZU5hbWUiLCJwYXJhbSIsInN0bklkIiwic3RuSW5mbyIsImNoYW5nZV90eXBlIiwicmVtb3ZlQ2xhc3MiLCJicmFuY2hlcyIsIm1hcCIsImJyYW5jaCIsImxpbmVNYWluU3RucyIsImZpbHRlciIsInN0YXRpb25zIiwibGluZVBhc3NTdG5zIiwiaW5kZXhPZiIsInB1c2giLCJ1bnNoaWZ0IiwicGF0aHMiLCJwYXRoIiwiX2xpbmVQYXRoIiwiTnVtYmVyIiwiZCIsImh0bWwiLCJmaWxsVGhlbWVDb2xvdXIiLCJhdHRyIiwiX3RoZW1lQ29sb3VyIiwiX2xpbmVOYW1lcyIsIl9wbGF0Zm9ybU51bSIsImZsYWdMZW5ndGgiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aWR0aCIsImlzTGVmdCIsIl9kaXJlY3Rpb24iLCJhcnJvd1giLCJfc3ZnRGVzdFdpZHRoIiwiYXJyb3dSb3RhdGUiLCJwbGF0Zm9ybU51bVgiLCJ0eHRBbmNob3IiLCJkZXN0TmFtZVgiLCJkZXN0aW5hdGlvbnNfemgiLCJkZXN0aW5hdGlvbnNfZW4iLCJmb3JFYWNoIiwic3RuIiwibGluZU5hbWVYIiwibGluZU5hbWVaSCIsImxpbmVOYW1lRU4iLCJoaWRlIl0sIm1hcHBpbmdzIjoia0hBS0EsTUFBTSxVQUFxQixJQUN2QixZQUFZQSxFQUFRQyxHQUNoQkMsTUFBTUYsRUFBSUMsR0FDVkUsS0FBS0MsT0FBU0gsRUFBS0ksSUFHdkIsaUJBQW1CLE9BQU8sRUFDMUIsb0JBQXNCLE9BQU9GLEtBQUtHLEVBQUksRUFBSSxJQUFNLEVBQ2hELFlBQ0ksSUFBSUMsRUFBV0osS0FBS0ssS0FBSyxHQUFHQyxNQUFNLE1BQU1DLE9BQ3hDLElBQUlDLEVBU0osT0FQSUEsRUFEQVIsS0FBS1MsV0FDdUIsSUFBdkJULEtBQUtVLGVBQXVCLEVBQUksR0FBc0IsSUFBaEJOLEVBQVcsR0FBVU8sS0FBS0MsS0FBSyxJQUU5QyxJQUF2QlosS0FBS1UsZUFBdUIsR0FBc0IsSUFBaEJOLEVBQVcsSUFBV08sS0FBS0MsS0FBSyxLQUFPLEVBSzNFLENBQUNKLEVBRndCLElBQXZCUixLQUFLVSxlQUF1QixVQUFrQyxJQUFoQk4sRUFBVyxHQUFVTyxLQUFLQyxLQUFLLElBQU8sTUFLakcsZUFDSSxJQUFLQyxFQUFVQyxJQUE0QixHQUFmZCxLQUFLZSxNQUFlLENBQUNDLGNBQXNCLFFBQVUsQ0F6QnRFLFNBeUJtRixVQUM5RixPQUFPQyxFQUFFLE1BQU8sQ0FBRUMsVUFBVyxhQUFhbEIsS0FBS21CLEtBQUtuQixLQUFLRyxPQUNwRGlCLE9BQU9ILEVBQUUsUUFBUyxDQUFFLGFBQWMsSUFBTUosRUFBVVEsTUFBTyxhQUdsRSxlQUNJLElBQUtiLEVBQUljLEdBQU10QixLQUFLdUIsTUFDcEIsT0FBT04sRUFBRSxNQUFPLENBQ1osVUFBYSxhQUFhakIsS0FBS21CLEVBQUlYLEtBQU1SLEtBQUtHLEVBQUltQixnQkFDbEQsY0FBc0MsSUFBdkJ0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QmpGLEtBQUt5RSxXQUNMLENBQUlLLEVBQVksTUFBaEIsSUFDSU0sRUFBWSxTQUVaTixFQUFZLFFBQ1pNLEVBQVlwRixLQUFLMkUsY0FFekIsSUFBS1UsRUFBWUMsR0FBY3RGLEtBQUttRSxXQUdoQzdCLEVBQWErQyxFQUFXNUMsTUFBTSxZQUM5QkgsR0FDQThDLEdBQWEsSUFDYkMsRUFBYSxLQUNicEUsRUFBRSwrQ0FBK0NnRCxLQUFLLENBQ2xELE1BQVMsUUFBUWpFLEtBQUtrRSxlQUN0QixVQUFhLGFBQWFrQixFQUFZLFlBRTFDbkUsRUFBRSwrQ0FDR1EsS0FBS2EsRUFBVyxJQUNoQjJCLEtBQUssWUFBYSxhQUFhbUIsRUFBWSxjQUVoREEsR0FBYSxJQUNibkUsRUFBRSwrQ0FBK0NnRCxLQUFLLENBQ2xELE1BQVMsUUFBUWpFLEtBQUtrRSxlQUN0QixVQUFhLGFBQWFrQixFQUFZLFNBQ3RDLE1BQVMsSUFDVCxPQUFVLE1BRWRuRSxFQUFFLCtDQUErQ3NFLE9BR2pEdEUsRUFBRSw2REFBNkRnRCxLQUFLLEtBQU0sS0FJOUVoRCxFQUFFLDhEQUE4RFEsS0FBSzRELEdBQ3JFcEUsRUFBRSw2REFBNkRRLEtBQUs2RCxHQUNwRXJFLEVBQUUsMkNBQTJDZ0QsS0FBSyxDQUM5Qy9DLFVBQVcsYUFBYWtFLFNBQ3hCLGNBQWVOLElBSW5CN0QsRUFBRSwwQkFBMEJnRCxLQUFLLENBQzdCL0MsVUFBVyxxQkFJbkIsa0JBQ0lELEVBQUUsZUFBZXNFIiwiZmlsZSI6IkxpbmVTSC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSTUdTdGF0aW9uLCBJbnRJbmZvVGFnLCBJbnRlcmNoYW5nZUluZm8gfSBmcm9tICcuL1N0YXRpb24nO1xyXG5pbXBvcnQgeyBJRCwgTmFtZSwgQnJhbmNoSW5mbywgU3RhdGlvbkluZm8gfSBmcm9tICcuLi91dGlscyc7XHJcblxyXG5jb25zdCBzdGF0aW9uX2lkID0gJ3N0bl9zaCdcclxuXHJcbmNsYXNzIFJNR1N0YXRpb25TSCBleHRlbmRzIFJNR1N0YXRpb24ge1xyXG4gICAgY29uc3RydWN0b3IoaWQ6IElELCBkYXRhOiBTdGF0aW9uSW5mbykge1xyXG4gICAgICAgIHN1cGVyKGlkLCBkYXRhKTtcclxuICAgICAgICB0aGlzLnN0bk51bSA9IGRhdGEubnVtO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZVNoaWZ0KCkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgIGdldCBfdGlja1JvdGF0aW9uKCkgeyByZXR1cm4gdGhpcy55ID4gMCA/IDE4MCA6IDA7IH1cclxuICAgIGdldCBfZHhkeSgpIHtcclxuICAgICAgICB2YXIgbmFtZUVOTG4gPSB0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKS5sZW5ndGg7XHJcbiAgICAgICAgbGV0IGR4OiBudW1iZXI7XHJcbiAgICAgICAgaWYgKHRoaXMuX25hbWVTaGlmdCkge1xyXG4gICAgICAgICAgICBkeCA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/IC05IDogMTYgKyAobmFtZUVOTG4gLSAxKSAqIDEyICogTWF0aC5jb3MoLTQ1KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkeCA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICgyNCArIChuYW1lRU5MbiAtIDEpICogMTIpICogTWF0aC5jb3MoLTQ1KSA6IC02O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBsZXQgZHggPSB0aGlzLl9uYW1lU2hpZnQgPyAtOCA6ICgyNCArIChuYW1lRU5Mbi0xKSoxMikgKiBNYXRoLmNvcygtNDUpO1xyXG4gICAgICAgIGxldCBkeSA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICgtNCAtIDIxLjkyMTg3NSAtIChuYW1lRU5MbiAtIDEpICogMTIgKiBNYXRoLmNvcygtNDUpKSA6IDE3LjU7XHJcbiAgICAgICAgLy8gdmFyIGR5ID0gKC00IC0gMjEuOTIxODc1IC0gKG5hbWVFTkxuLTEpKjEyKk1hdGguY29zKC00NSkpICogKHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/IDEgOiAtMSk7XHJcbiAgICAgICAgcmV0dXJuIFtkeCwgZHldXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGljb25IVE1MKCkge1xyXG4gICAgICAgIHZhciBbaWNvblR5cGUsIG51bUNsYXNzXSA9ICh0aGlzLnN0YXRlID09IC0xKSA/IFtzdGF0aW9uX2lkICsgJ19wYXNzJywgJ1Bhc3MnXSA6IFtzdGF0aW9uX2lkLCAnRnV0dXJlJ107XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54fSwke3RoaXMueX0pYCB9KVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzx1c2U+JywgeyAneGxpbms6aHJlZic6ICcjJyArIGljb25UeXBlLCBjbGFzczogJ3JtZy1zdG4nIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgbmFtZUhUTUwoKSB7XHJcbiAgICAgICAgbGV0IFtkeCwgZHldID0gdGhpcy5fZHhkeVxyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7dGhpcy54IC0gZHh9LCR7dGhpcy55ICsgZHl9KXJvdGF0ZSgtNjApYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gJ3N0YXJ0JyA6ICdlbmQnLFxyXG4gICAgICAgICAgICAvLyBjbGFzczogYE5hbWUgJHt0aGlzLm5hbWVDbGFzc31gXHJcbiAgICAgICAgICAgIGNsYXNzOiBgTmFtZSBGdXR1cmVgICAvLyB0b2RvOiBmaXggdGhpc1xyXG4gICAgICAgIH0pLmFwcGVuZChcclxuICAgICAgICAgICAgJCgnPHRleHQ+JykuYWRkQ2xhc3MoJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbicpLnRleHQodGhpcy5uYW1lWzBdKVxyXG4gICAgICAgICkuYXBwZW5kKFxyXG4gICAgICAgICAgICAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICBkeTogMTUsIGNsYXNzOiAncm1nLW5hbWVfX2VuIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJ1xyXG4gICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzBdKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dHNwYW4+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICd4JzogMCwgJ2R5JzogMTJcclxuICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMV0pXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBJbnRTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uU0gge1xyXG4gICAgcHJpdmF0ZSBfaW50SW5mb3M6IEludGVyY2hhbmdlSW5mb1tdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MgPSBkYXRhLmludGVyY2hhbmdlWzBdWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBnZXQgYWxsIGRyYXdpbmcgZnVuY3Rpb24gdG8gYmUgY2FsbGVkXHJcbiAgICBnZXQgdW5ncnBIVE1MKCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5pY29uSFRNTCwgdGhpcy5uYW1lSFRNTCwgLi4udGhpcy5pbnRUaWNrSFRNTF07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gaW50ZXJjaGFuZ2Ugc3RhdGlvbiBpY29uIG9uIG1haW4gbGluZVxyXG4gICAgZ2V0IGljb25IVE1MKCkge1xyXG4gICAgICAgIHZhciBbaWNvblR5cGUsIG51bUNsYXNzXSA9ICh0aGlzLnN0YXRlID09IC0xKSA/IFsnaW50Ml9zaF9wYXNzJywgJ1Bhc3MnXSA6IFsnaW50Ml9zaCcsICdGdXR1cmUnXTtcclxuICAgICAgICByZXR1cm4gJCgnPGc+JywgeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHt0aGlzLnh9LCR7dGhpcy55fSlgIH0pXHJcbiAgICAgICAgICAgIC5hcHBlbmQoJCgnPHVzZT4nLCB7ICd4bGluazpocmVmJzogJyMnICsgaWNvblR5cGUsIGNsYXNzOiAncm1nLXN0bicsIHN0cm9rZTogdGhpcy5faW50SW5mb3NbSW50SW5mb1RhZy5jb2xvdXJdIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZWd1bGFyIHN0YXRpb24gbmFtZVxyXG4gICAgZ2V0IG5hbWVIVE1MKCkge1xyXG4gICAgICAgIGxldCBbZHgsIGR5XSA9IHRoaXMuX2R4ZHk7XHJcbiAgICAgICAgLy8gd3JhcCB0aGUgbmFtZSwgZGVjcm9fbGluZSBhbmQgaW50X2xpbmUgdW5kZXIgZyBpbiBvcmRlciB0byByb3RhdGUgYXQgb25jZVxyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7dGhpcy54IC0gZHh9LCR7dGhpcy55ICsgZHl9KWAsICAvL3JvdGF0ZSgtNjApXHJcbiAgICAgICAgfSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgbmFtZSB0ZXh0XHJcbiAgICAgICAgICAgICQoJzxnPicsIHtcclxuICAgICAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICdzdGFydCcgOiAnZW5kJyxcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBgTmFtZSBGdXR1cmVgICAvLyB0b2RvOiBmaXggdGhpc1xyXG4gICAgICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dGV4dD4nKS5hZGRDbGFzcygncm1nLW5hbWVfX3poIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJykudGV4dCh0aGlzLm5hbWVbMF0pXHJcbiAgICAgICAgICAgICkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRleHQ+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIGR5OiAxNSwgY2xhc3M6ICdybWctbmFtZV9fZW4gcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nXHJcbiAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzBdKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgJCgnPHRzcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3gnOiAwLCAnZHknOiAxMlxyXG4gICAgICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMV0pXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaW50ZXJjaGFuZ2Ugc3RhdGlvbiBpY29uIGFmdGVyIHN0YXRpb24gbmFtZVxyXG4gICAgZ2V0IGludFRpY2tIVE1MKCkge1xyXG4gICAgICAgIC8vIHZhciBuYW1lVGV4dCA9ICQoYCNzdG5faWNvbnMgPiAjJHt0aGlzLmlkfSA+IGc6Zmlyc3QtY2hpbGRgKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGAjc3RuX2ljb25zID4gIyR7dGhpcy5pZH0gPiBnOmZpcnN0LWNoaWxkYCwgbmFtZVRleHQpXHJcblxyXG4gICAgICAgIC8vIGludGVyY2hhbmdlIGxpbmUgaWNvbiBhZnRlciBzdGF0aW9uIG5hbWVcclxuICAgICAgICB2YXIgdGlja1JvdGF0aW9uID0gKHRoaXMubmFtZVBvcyA9PSAxKSA/IDE4MCA6IDA7XHJcbiAgICAgICAgdmFyIHRpY2tDb2xvdXIgPSB0aGlzLl9pbnRJbmZvc1tJbnRJbmZvVGFnLmNvbG91cl07XHJcbiAgICAgICAgdmFyIHRpY2sgPSAkKCc8dXNlPicsIHtcclxuICAgICAgICAgICAgJ3hsaW5rOmhyZWYnOiAnI2ludF9zaCcsXHJcbiAgICAgICAgICAgIGZpbGw6IHRpY2tDb2xvdXIsXHJcbiAgICAgICAgICAgIC8vIFRvZG86IGZpeCB0aGlzIGhhcmQtY29kZWQgcG9zaXRpb24gYnkgZ2V0dGluZyB0aGUgbmFtZSB0ZXh0IGVsZW1cclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDEwLC0xMClyb3RhdGUoJHt0aWNrUm90YXRpb259KWAsXHJcbiAgICAgICAgICAgIGNsYXNzOiAncm1nLWxpbmVfX3NobWV0cm8gcm1nLWxpbmVfX2NoYW5nZScsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgdGljay5hZGRDbGFzcygncm1nLWxpbmVfX3Bhc3MnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGxpbmUgc3RhcnRzIHdpdGggbnVtYmVycyBvciBsZXR0ZXJzXHJcbiAgICAgICAgdmFyIGxpbmVOdW1iZXIgPSBTdHJpbmcodGhpcy5faW50SW5mb3NbSW50SW5mb1RhZy5uYW1lWkhdKS5tYXRjaCgvKFxcZCopXFx3Ky8pXHJcbiAgICAgICAgaWYgKGxpbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgdmFyIGxpbmVOYW1lID0gbGluZU51bWJlclswXVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTmFtZSA9IFN0cmluZyh0aGlzLl9pbnRJbmZvc1tJbnRJbmZvVGFnLm5hbWVaSF0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGludGVyY2hhbmdlIGxpbmUgbmFtZVxyXG4gICAgICAgIHZhciBsaW5lTmFtZUVsZW0gPSAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgIC8vIFRvZG86IGZpeCB0aGlzIGhhcmQtY29kZWQgcG9zaXRpb24gYnkgZ2V0dGluZyB0aGUgbmFtZSB0ZXh0IGVsZW1cclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDE1LDEwKXJvdGF0ZSgke3RpY2tSb3RhdGlvbn0pYCxcclxuICAgICAgICAgICAgY2xhc3M6ICdybWctbmFtZV9femggcm1nLW5hbWVfX3NobWV0cm8tLWxpbmVfbmFtZScsXHJcbiAgICAgICAgfSkudGV4dChsaW5lTmFtZSlcclxuXHJcbiAgICAgICAgcmV0dXJuIFt0aWNrLCBsaW5lTmFtZUVsZW1dO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZUNsYXNzKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PSAtMSkgPyAnUGFzcycgOiAnRnV0dXJlJztcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IFJNR1N0YXRpb25TSCwgSW50U3RhdGlvblNILCBzdGF0aW9uX2lkIH07XHJcbiIsImltcG9ydCB7IFJNR0xpbmUgfSBmcm9tICcuL0xpbmUnO1xyXG5pbXBvcnQgeyBSTUdTdGF0aW9uU0gsIEludFN0YXRpb25TSCwgc3RhdGlvbl9pZCB9IGZyb20gJy4uL1N0YXRpb24vU3RhdGlvblNIJztcclxuaW1wb3J0IHsgUk1HU3RhdGlvbiB9IGZyb20gJy4uL1N0YXRpb24vU3RhdGlvbic7XHJcblxyXG5pbXBvcnQgeyBJRCwgTmFtZSwgU3RhdGlvbkluZm8sIFJNR1BhcmFtIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJNR0xpbmVTSCBleHRlbmRzIFJNR0xpbmUge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW0pIHtcclxuICAgICAgICBzdXBlcihwYXJhbSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2luaXRTdG5JbnN0YW5jZShzdG5JZDogSUQsIHN0bkluZm86IFN0YXRpb25JbmZvKTogUk1HU3RhdGlvbiB7XHJcbiAgICAgICAgc3dpdGNoIChzdG5JbmZvLmNoYW5nZV90eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ludDInOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSTUdTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBkcmF3IHRoZSBsaW5lIGluIHJhaWxtYXBcclxuICAgIGRyYXdMaW5lKCkge1xyXG4gICAgICAgICQoJy5ybWctbGluZScpLnJlbW92ZUNsYXNzKCdybWctbGluZV9fbXRyJykuYWRkQ2xhc3MoJ3JtZy1saW5lX19zaG1ldHJvJyk7XHJcblxyXG4gICAgICAgIHRoaXMuYnJhbmNoZXMubWFwKGJyYW5jaCA9PiB7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTWFpblN0bnMgPSBicmFuY2guZmlsdGVyKHN0bklkID0+IHRoaXMuc3RhdGlvbnNbc3RuSWRdLnN0YXRlID49IDApO1xyXG4gICAgICAgICAgICB2YXIgbGluZVBhc3NTdG5zID0gYnJhbmNoLmZpbHRlcihzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5zdGF0ZSA8PSAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMgPSBicmFuY2g7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMuZmlsdGVyKHN0bklkID0+IGxpbmVQYXNzU3Rucy5pbmRleE9mKHN0bklkKSAhPT0gLTEpLmxlbmd0aCA9PSAwICYmIGxpbmVNYWluU3Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHR3byBzZXQgZGlzam9pbnRcclxuICAgICAgICAgICAgICAgIGlmIChsaW5lUGFzc1N0bnNbMF0gPT09IGJyYW5jaFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIC0xIC0xIDEgMVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3Rucy5wdXNoKGxpbmVNYWluU3Ruc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmVNYWluU3Ruc1swXSA9PT0gYnJhbmNoWzBdICYmIGxpbmVNYWluU3Ruc1tsaW5lTWFpblN0bnMubGVuZ3RoIC0gMV0gPT09IGJyYW5jaFticmFuY2gubGVuZ3RoIC0gMV0gJiYgbGluZVBhc3NTdG5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3RucyA9IGJyYW5jaDtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lTWFpblN0bnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMSAxIC0xIC0xXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zLnVuc2hpZnQobGluZU1haW5TdG5zW2xpbmVNYWluU3Rucy5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmV0Y2ggdGhlIG1haW4gbGluZVxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVNYWluU3RucylcclxuICAgICAgICAgICAgdmFyIHBhdGhzID0gcGF0aC5tYXRjaCgvW1xcZC5dKy9nKVxyXG4gICAgICAgICAgICBwYXRoID0gYE0gJHtwYXRoc1swXX0sJHtwYXRoc1sxXX0gSCAke051bWJlcihwYXRoc1syXSkgKyAzMH1gXHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBtYWluIGxpbmVcclxuICAgICAgICAgICAgJCgnI2xpbmVfbWFpbicpLmFwcGVuZCgkKCc8cGF0aD4nLCB7IGQ6IHBhdGggfSkpO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RyZXRjaCB0aGUgcGFzcyBsaW5lXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5fbGluZVBhdGgobGluZVBhc3NTdG5zKVxyXG4gICAgICAgICAgICB2YXIgcGF0aHMgPSBwYXRoLm1hdGNoKC9bXFxkLl0rL2cpXHJcbiAgICAgICAgICAgIHBhdGggPSBgTSAke051bWJlcihwYXRoc1swXSkgLSAzMH0sJHtwYXRoc1sxXX0gSCAke3BhdGhzWzJdfWBcclxuXHJcbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIHBhc3MgbGluZVxyXG4gICAgICAgICAgICAkKCcjbGluZV9wYXNzJykuYXBwZW5kKCQoJzxwYXRoPicsIHsgZDogcGF0aCB9KSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoJyNsaW5lX21haW4nKS5odG1sKCQoJyNsaW5lX21haW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyNsaW5lX3Bhc3MnKS5odG1sKCQoJyNsaW5lX3Bhc3MnKS5odG1sKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbGxUaGVtZUNvbG91cigpIHtcclxuICAgICAgICBzdXBlci5maWxsVGhlbWVDb2xvdXIoKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcyB3aWxsIGFkZCB0aGUgc3Ryb2tlIG9mIHRoZSBjaXJjbGVcclxuICAgICAgICAvLyBob3dldmVyIHRoZSBzdHJva2UgcGF0aCBpcyBkZWZpbmVkIGluIGluZGV4Lmh0bWxcclxuICAgICAgICAvLyB3aGljaCBtYWRlIGNoYW5naW5nIHN0YXRpb24gc3R5bGUgc3RyYW5nZVxyXG4gICAgICAgICQoJ3BhdGgjJyArIHN0YXRpb25faWQpLmF0dHIoJ3N0cm9rZScsIHRoaXMuX3RoZW1lQ29sb3VyKTtcclxuICAgICAgICAkKCdwYXRoI2ludDJfc2gnKS5hdHRyKCdzdHJva2UnLCB0aGlzLl90aGVtZUNvbG91cik7XHJcblxyXG4gICAgICAgIC8vIHBhc3Mgc3Ryb2tlIHNob3VsZCBiZSBhZGRlZCBzb21ld2hlcmUgZWxzZVxyXG4gICAgICAgIC8vIGJ1dCBJIGNhbid0IGZpZ3VyZSBpdCBvdXRcclxuICAgICAgICAkKCdwYXRoI3N0bl9zaF9wYXNzJykuYXR0cignc3Ryb2tlJywgJyNhYWEnKTtcclxuICAgICAgICAkKCdwYXRoI2ludDJfc2hfcGFzcycpLmF0dHIoJ3N0cm9rZScsICcjYWFhJyk7XHJcblxyXG4gICAgICAgIC8vIHRoZSBsYXN0IGRlY29yYXRpb24gbGluZVxyXG4gICAgICAgICQoJyNsaW5lX3NobWV0cm9fbGVmdF91c2UnKS5hdHRyKCdmaWxsJywgdGhpcy5fdGhlbWVDb2xvdXIpXHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9saW5lTmFtZXNbMF0ubWF0Y2goLyhcXGQqKVxcdysvKSkge1xyXG4gICAgICAgICAgICAvLyB0aGUgbGluZSBzdGFydHMgd2l0aCBudW1iZXJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhlIGxpbmUgc3RhcnRzIHdpdGggbGV0dGVyXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRyYXdEZXN0SW5mbygpIHtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjcGxhdGZvcm0gPiB0ZXh0JykudGV4dCh0aGlzLl9wbGF0Zm9ybU51bSk7XHJcblxyXG4gICAgICAgIHZhciBiY3IgPSAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0JylbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIGZsYWdMZW5ndGggPSAxNjAgKyAxNTAgKyBiY3Iud2lkdGggKyA0NSArIDUwO1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIGFycm93XHJcbiAgICAgICAgdmFyIGlzTGVmdCA9ICh0aGlzLl9kaXJlY3Rpb24gPT0gJ3InKSA/IDEgOiAtMTtcclxuICAgICAgICB2YXIgYXJyb3dYID0gKHRoaXMuX3N2Z0Rlc3RXaWR0aCAtIGlzTGVmdCAqIGZsYWdMZW5ndGgpIC8gMjA7XHJcbiAgICAgICAgYXJyb3dYID0gKHRoaXMuX2RpcmVjdGlvbiA9PSAncicpID8gYXJyb3dYIDogdGhpcy5fc3ZnRGVzdFdpZHRoIC0gMjA7XHJcbiAgICAgICAgdmFyIGFycm93Um90YXRlID0gOTAgKiAoMSAtIGlzTGVmdCk7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Fycm93X2xlZnRfdXNlJykuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke2Fycm93WH0sMTM1KXJvdGF0ZSgke2Fycm93Um90YXRlfSlgKTtcclxuXHJcbiAgICAgICAgLy8gbm90IGluIHVzZSBub3dcclxuICAgICAgICB2YXIgcGxhdGZvcm1OdW1YID0gYXJyb3dYICsgaXNMZWZ0ICogKDE2MCArIDUwICsgNzUpO1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNwbGF0Zm9ybScpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHtwbGF0Zm9ybU51bVh9LDEzMClgKTtcclxuXHJcbiAgICAgICAgLy8gbGlzdCB0aGUgZGVzdGluYXRpb24gdGV4dFxyXG4gICAgICAgIC8vIFRvZG86IGZpeCBzdmdfZGVzdF93aWR0aCowLjgsIHRoaXMgaGFzIG9ubHkgYmVlbiB0ZXN0ZWQgb24gMTAwMCB3aWR0aFxyXG4gICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICB2YXIgdHh0QW5jaG9yID0gJ2VuZCc7XHJcbiAgICAgICAgICAgIHZhciBkZXN0TmFtZVggPSB0aGlzLl9zdmdEZXN0V2lkdGggKiAwLjg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHR4dEFuY2hvciA9ICdzdGFydCc7XHJcbiAgICAgICAgICAgIHZhciBkZXN0TmFtZVggPSB0aGlzLl9zdmdEZXN0V2lkdGggKiAwLjI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7ZGVzdE5hbWVYfSwxMzUpYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdHh0QW5jaG9yXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGZvciBlYWNoIGxlZnQgdmFsaWQgZGVzdGluYXRpb25zLCBnZXQgdGhlIG5hbWUgZnJvbSBpZFxyXG4gICAgICAgIHZhciBbZGVzdGluYXRpb25zX3poLCBkZXN0aW5hdGlvbnNfZW5dID0gW1wiXCIsIFwiXCJdXHJcbiAgICAgICAgdGhpc1tgJHt0aGlzLl9kaXJlY3Rpb259VmFsaWREZXN0c2BdLmZvckVhY2goc3RuID0+IHtcclxuICAgICAgICAgICAgZGVzdGluYXRpb25zX3poICs9IHRoaXMuc3RhdGlvbnNbc3RuXS5uYW1lWzBdXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uc19lbiArPSB0aGlzLnN0YXRpb25zW3N0bl0ubmFtZVsxXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQgPiB0ZXh0OmZpcnN0LWNoaWxkJykudGV4dChg5b6AJHtkZXN0aW5hdGlvbnNfemh9YClcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykudGV4dChgVG8gJHtkZXN0aW5hdGlvbnNfZW59YClcclxuXHJcbiAgICAgICAgLy8gcHJlcGFyZSBmb3IgdGhlIGxpbmUgbmFtZVxyXG4gICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICB2YXIgdHh0QW5jaG9yID0gJ2VuZCc7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTmFtZVggPSAxODA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHR4dEFuY2hvciA9ICdzdGFydCc7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTmFtZVggPSB0aGlzLl9zdmdEZXN0V2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBbbGluZU5hbWVaSCwgbGluZU5hbWVFTl0gPSB0aGlzLl9saW5lTmFtZXM7XHJcblxyXG4gICAgICAgIC8vIGxpbmUgc3RhcnRzIHdpdGggbnVtYmVycyBvciBsZXR0ZXJzXHJcbiAgICAgICAgdmFyIGxpbmVOdW1iZXIgPSBsaW5lTmFtZVpILm1hdGNoKC8oXFxkKilcXHcrLylcclxuICAgICAgICBpZiAobGluZU51bWJlcikge1xyXG4gICAgICAgICAgICBsaW5lTmFtZVggLT0gMTgwO1xyXG4gICAgICAgICAgICBsaW5lTmFtZVpIID0gXCLlj7fnur9cIlxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiByZWN0JykuYXR0cih7XHJcbiAgICAgICAgICAgICAgICAnc3R5bGUnOiBgZmlsbDoke3RoaXMuX3RoZW1lQ29sb3VyfWAsXHJcbiAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogYHRyYW5zbGF0ZSgke2xpbmVOYW1lWCAtIDEyMH0sNzApYFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiB0ZXh0JylcclxuICAgICAgICAgICAgICAgIC50ZXh0KGxpbmVOdW1iZXJbMF0pXHJcbiAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke2xpbmVOYW1lWCAtIDEwMH0sMTcwKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGluZU5hbWVYIC09IDI4MDtcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gcmVjdCcpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgJ3N0eWxlJzogYGZpbGw6JHt0aGlzLl90aGVtZUNvbG91cn1gLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMH0sNjApYCxcclxuICAgICAgICAgICAgICAgICd3aWR0aCc6IDI2MCxcclxuICAgICAgICAgICAgICAgICdoZWlnaHQnOiAxNTBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpLmhpZGUoKVxyXG5cclxuICAgICAgICAgICAgLy8gVG9kbzogc2V0IHRoZSBlbmcgaW4gdGhlIG1pZGRsZVxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0Omxhc3QtY2hpbGQnKS5hdHRyKCdkeCcsIDEwKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0IHRoZSBsaW5lIG5hbWVcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0OmZpcnN0LWNoaWxkJykudGV4dChsaW5lTmFtZVpIKVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCA+IHRleHQ6bGFzdC1jaGlsZCcpLnRleHQobGluZU5hbWVFTilcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYfSwxMzUpYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdHh0QW5jaG9yXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHRoZSBsYXN0IGRlY29yYXRpb24gbGluZVxyXG4gICAgICAgICQoJyNsaW5lX3NobWV0cm9fbGVmdF91c2UnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDAsMjIwKWAsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTdG5OYW1lQmcoKSB7XHJcbiAgICAgICAgJCgnI2N1cnJlbnRfYmcnKS5oaWRlKCk7ICAvLyBmaXggdGhlIG15c3RlcmlvdXMgYmxhY2sgcmVjdFxyXG4gICAgfVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9