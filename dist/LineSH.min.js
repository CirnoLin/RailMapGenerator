(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,s,e){"use strict";e.r(s);var a=e(7),n=e(1);class i extends n.l{constructor(t,s){super(t,s),this.stnNum=s.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get iconHTML(){var[t,s]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){var t=this.name[1].split("\\").length;let s;s=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6;let e=0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5;return $("<g>",{transform:`translate(${this.x-s},${this.y+e})rotate(-45)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends i{constructor(t,s){super(t,s),this._intInfos=s.interchange[0]}}e.d(s,"RMGLineSH",(function(){return h}));class h extends a.a{constructor(t){super(t)}_initStnInstance(t,s){switch(s.change_type){case"int2":return new r(t,s);default:return new i(t,s)}}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var s=t.filter(t=>this.stations[t].state>=0),e=t.filter(t=>this.stations[t].state<=0);1===s.length&&(e=t),0==s.filter(t=>-1!==e.indexOf(t)).length&&s.length&&(e[0]===t[0]?e.push(s[0]):s[0]===t[0]&&s[s.length-1]===t[t.length-1]&&e.length?(e=t,s=[]):e.unshift(s[s.length-1]));var a=(n=this._linePath(s)).match(/[\d.]+/g);n=`M ${a[0]},${a[1]} H ${Number(a[2])+30}`,$("#line_main").append($("<path>",{d:n}));var n;a=(n=this._linePath(e)).match(/[\d.]+/g);n=`M ${Number(a[0])-30},${a[1]} H ${a[2]}`,$("#line_pass").append($("<path>",{d:n}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("#line_shmetro_left_use").attr("fill",this._themeColour)}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);let t=this[this._direction+"ValidDests"];var[s,e]=[0,1].map(s=>t.map(t=>this.stations[t].name[s].replace(/\\/g," ")).join("/")),a=310+$("#station_info_shmetro > g:last-child")[0].getBoundingClientRect().width+45+50;console.log("flagLength: "+a);var n="r"==this._direction?1:-1,i=(this._svgDestWidth-n*a)/20,r=90*(1-n);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${i},135)rotate(${r})`);var h=i+285*n;if($("#station_info_shmetro > #platform").attr("transform",`translate(${h},130)`),"l"===this._direction)var o="end",l=.8*this._svgDestWidth;else o="start",l=.2*this._svgDestWidth;$("#station_info_shmetro > g:last-child").attr({transform:`translate(${l},135)`,"text-anchor":o});var _="",m="";this.lValidDests.forEach(t=>{_+=this.stations[t].name[0],m+=this.stations[t].name[1]}),$("#station_info_shmetro > #dest_text > text:first-child").text(`å¾€${_}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${m}`),$("#line_shmetro_left_use").attr({transform:"translate(0,220)"})}updateStnNameBg(){$("#current_bg").hide()}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJpY29uVHlwZSIsIm51bUNsYXNzIiwic3RhdGUiLCJzdGF0aW9uX2lkIiwiJCIsInRyYW5zZm9ybSIsIngiLCJhcHBlbmQiLCJjbGFzcyIsIm5hbWVFTkxuIiwibmFtZSIsInNwbGl0IiwibGVuZ3RoIiwiZHgiLCJfbmFtZVNoaWZ0IiwiX3RpY2tSb3RhdGlvbiIsIk1hdGgiLCJjb3MiLCJkeSIsImFkZENsYXNzIiwidGV4dCIsIkludFN0YXRpb25TSCIsIl9pbnRJbmZvcyIsImludGVyY2hhbmdlIiwicGFyYW0iLCJzdG5JZCIsInN0bkluZm8iLCJjaGFuZ2VfdHlwZSIsInJlbW92ZUNsYXNzIiwiYnJhbmNoZXMiLCJtYXAiLCJicmFuY2giLCJsaW5lTWFpblN0bnMiLCJmaWx0ZXIiLCJzdGF0aW9ucyIsImxpbmVQYXNzU3RucyIsImluZGV4T2YiLCJwdXNoIiwidW5zaGlmdCIsInBhdGhzIiwicGF0aCIsIl9saW5lUGF0aCIsIm1hdGNoIiwiTnVtYmVyIiwiZCIsImh0bWwiLCJmaWxsVGhlbWVDb2xvdXIiLCJhdHRyIiwiX3RoZW1lQ29sb3VyIiwiX3BsYXRmb3JtTnVtIiwidmFsaWREZXN0IiwiX2RpcmVjdGlvbiIsImRlc3ROYW1lWkgiLCJkZXN0TmFtZUVOIiwiaWR4IiwicmVwbGFjZSIsImpvaW4iLCJmbGFnTGVuZ3RoIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwid2lkdGgiLCJjb25zb2xlIiwibG9nIiwiaXNMZWZ0IiwiYXJyb3dYIiwiX3N2Z0Rlc3RXaWR0aCIsImFycm93Um90YXRlIiwicGxhdGZvcm1OdW1YIiwidHh0QW5jaG9yIiwiZGVzdE5hbWVYIiwiZGVzdGluYXRpb25zX3poIiwiZGVzdGluYXRpb25z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LGFBQWFnQixnQkFBcUJFLE1BR2pHLElBQUlDLEVBQWVILEVBQWtCLElBQVRELEVBSzVCLEdBSkExRCxFQUFFLHFDQUFxQzJDLEtBQUssWUFBYSxhQUFhbUIsVUFJOUMsTUFBcEJ0RSxLQUFLdUQsV0FDTCxJQUFJZ0IsRUFBWSxNQUNaQyxFQUFpQyxHQUFyQnhFLEtBQUtvRSxtQkFFakJHLEVBQVksUUFDWkMsRUFBaUMsR0FBckJ4RSxLQUFLb0UsY0FFekI1RCxFQUFFLHdDQUF3QzJDLEtBQUssQ0FDM0MxQyxVQUFXLGFBQWErRCxTQUN4QixjQUFlRCxJQUluQixJQUFJRSxFQUFrQixHQUFJQyxFQUFrQixHQUM1QzFFLEtBQUsyRSxZQUFZQyxRQUFRQyxJQUNyQkosR0FBbUJ6RSxLQUFLc0MsU0FBU3VDLEdBQUsvRCxLQUFLLEdBQzNDNEQsR0FBbUIxRSxLQUFLc0MsU0FBU3VDLEdBQUsvRCxLQUFLLEtBRS9DTixFQUFFLHlEQUF5RGdCLEtBQUssSUFBSWlELEtBQ3BFakUsRUFBRSx3REFBd0RnQixLQUFLLE1BQU1rRCxLQUdyRWxFLEVBQUUsMEJBQTBCMkMsS0FBSyxDQUM3QjFDLFVBQVcscUJBSW5CLGtCQUNJRCxFQUFFLGVBQWVzRSIsImZpbGUiOiJMaW5lU0gubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUk1HU3RhdGlvbiwgSW50SW5mb1RhZywgSW50ZXJjaGFuZ2VJbmZvIH0gZnJvbSAnLi9TdGF0aW9uJztcclxuaW1wb3J0IHsgSUQsIE5hbWUsIEJyYW5jaEluZm8sIFN0YXRpb25JbmZvIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5cclxuY29uc3Qgc3RhdGlvbl9pZCA9ICdzdG5fc2gnXHJcblxyXG5jbGFzcyBSTUdTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zdG5OdW0gPSBkYXRhLm51bTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgX25hbWVTaGlmdCgpIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICBnZXQgX3RpY2tSb3RhdGlvbigpIHsgcmV0dXJuIHRoaXMueSA+IDAgPyAxODAgOiAwOyB9XHJcblxyXG4gICAgZ2V0IGljb25IVE1MKCkge1xyXG4gICAgICAgIHZhciBbaWNvblR5cGUsIG51bUNsYXNzXSA9ICh0aGlzLnN0YXRlID09IC0xKSA/IFtzdGF0aW9uX2lkICsgJ19wYXNzJywgJ1Bhc3MnXSA6IFtzdGF0aW9uX2lkLCAnRnV0dXJlJ107XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54fSwke3RoaXMueX0pYCB9KVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzx1c2U+JywgeyAneGxpbms6aHJlZic6ICcjJyArIGljb25UeXBlLCBjbGFzczogJ3JtZy1zdG4nIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgbmFtZUhUTUwoKSB7XHJcbiAgICAgICAgdmFyIG5hbWVFTkxuID0gdGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJykubGVuZ3RoO1xyXG4gICAgICAgIGxldCBkeDogbnVtYmVyO1xyXG4gICAgICAgIGlmICh0aGlzLl9uYW1lU2hpZnQpIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAtOSA6IDE2ICsgKG5hbWVFTkxuIC0gMSkgKiAxMiAqIE1hdGguY29zKC00NSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoMjQgKyAobmFtZUVOTG4gLSAxKSAqIDEyKSAqIE1hdGguY29zKC00NSkgOiAtNjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbGV0IGR4ID0gdGhpcy5fbmFtZVNoaWZ0ID8gLTggOiAoMjQgKyAobmFtZUVOTG4tMSkqMTIpICogTWF0aC5jb3MoLTQ1KTtcclxuICAgICAgICBsZXQgZHkgPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoLTQgLSAyMS45MjE4NzUgLSAobmFtZUVOTG4gLSAxKSAqIDEyICogTWF0aC5jb3MoLTQ1KSkgOiAxNy41O1xyXG4gICAgICAgIC8vIHZhciBkeSA9ICgtNCAtIDIxLjkyMTg3NSAtIChuYW1lRU5Mbi0xKSoxMipNYXRoLmNvcygtNDUpKSAqICh0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAxIDogLTEpO1xyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7dGhpcy54IC0gZHh9LCR7dGhpcy55ICsgZHl9KXJvdGF0ZSgtNDUpYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gJ3N0YXJ0JyA6ICdlbmQnLFxyXG4gICAgICAgICAgICAvLyBjbGFzczogYE5hbWUgJHt0aGlzLm5hbWVDbGFzc31gXHJcbiAgICAgICAgICAgIGNsYXNzOiBgTmFtZSBGdXR1cmVgICAvLyB0b2RvOiBmaXggdGhpc1xyXG4gICAgICAgIH0pLmFwcGVuZChcclxuICAgICAgICAgICAgJCgnPHRleHQ+JykuYWRkQ2xhc3MoJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbicpLnRleHQodGhpcy5uYW1lWzBdKVxyXG4gICAgICAgICkuYXBwZW5kKFxyXG4gICAgICAgICAgICAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICBkeTogMTUsIGNsYXNzOiAncm1nLW5hbWVfX2VuIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJ1xyXG4gICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzBdKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dHNwYW4+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICd4JzogMCwgJ2R5JzogMTJcclxuICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMV0pXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBJbnRTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uU0gge1xyXG4gICAgcHJpdmF0ZSBfaW50SW5mb3M6IEludGVyY2hhbmdlSW5mb1tdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MgPSBkYXRhLmludGVyY2hhbmdlWzBdO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBSTUdTdGF0aW9uU0gsIEludFN0YXRpb25TSCwgc3RhdGlvbl9pZCB9O1xyXG4iLCJpbXBvcnQgeyBSTUdMaW5lIH0gZnJvbSAnLi9MaW5lJztcclxuaW1wb3J0IHsgUk1HU3RhdGlvblNILCBJbnRTdGF0aW9uU0gsIHN0YXRpb25faWQgfSBmcm9tICcuLi9TdGF0aW9uL1N0YXRpb25TSCc7XHJcbmltcG9ydCB7IFJNR1N0YXRpb24gfSBmcm9tICcuLi9TdGF0aW9uL1N0YXRpb24nO1xyXG5cclxuaW1wb3J0IHsgSUQsIE5hbWUsIFN0YXRpb25JbmZvLCBSTUdQYXJhbSB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSTUdMaW5lU0ggZXh0ZW5kcyBSTUdMaW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtKSB7XHJcbiAgICAgICAgc3VwZXIocGFyYW0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0U3RuSW5zdGFuY2Uoc3RuSWQ6IElELCBzdG5JbmZvOiBTdGF0aW9uSW5mbyk6IFJNR1N0YXRpb24ge1xyXG4gICAgICAgIHN3aXRjaCAoc3RuSW5mby5jaGFuZ2VfdHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdpbnQyJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW50U3RhdGlvblNIKHN0bklkLCBzdG5JbmZvKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUk1HU3RhdGlvblNIKHN0bklkLCBzdG5JbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZHJhdyB0aGUgbGluZSBpbiByYWlsbWFwXHJcbiAgICBkcmF3TGluZSgpIHtcclxuICAgICAgICAkKCcucm1nLWxpbmUnKS5yZW1vdmVDbGFzcygncm1nLWxpbmVfX210cicpLmFkZENsYXNzKCdybWctbGluZV9fc2htZXRybycpO1xyXG5cclxuICAgICAgICB0aGlzLmJyYW5jaGVzLm1hcChicmFuY2ggPT4ge1xyXG4gICAgICAgICAgICB2YXIgbGluZU1haW5TdG5zID0gYnJhbmNoLmZpbHRlcihzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5zdGF0ZSA+PSAwKTtcclxuICAgICAgICAgICAgdmFyIGxpbmVQYXNzU3RucyA9IGJyYW5jaC5maWx0ZXIoc3RuSWQgPT4gdGhpcy5zdGF0aW9uc1tzdG5JZF0uc3RhdGUgPD0gMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobGluZU1haW5TdG5zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zID0gYnJhbmNoO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobGluZU1haW5TdG5zLmZpbHRlcihzdG5JZCA9PiBsaW5lUGFzc1N0bnMuaW5kZXhPZihzdG5JZCkgIT09IC0xKS5sZW5ndGggPT0gMCAmJiBsaW5lTWFpblN0bnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0d28gc2V0IGRpc2pvaW50XHJcbiAgICAgICAgICAgICAgICBpZiAobGluZVBhc3NTdG5zWzBdID09PSBicmFuY2hbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAtMSAtMSAxIDFcclxuICAgICAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMucHVzaChsaW5lTWFpblN0bnNbMF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lTWFpblN0bnNbMF0gPT09IGJyYW5jaFswXSAmJiBsaW5lTWFpblN0bnNbbGluZU1haW5TdG5zLmxlbmd0aCAtIDFdID09PSBicmFuY2hbYnJhbmNoLmxlbmd0aCAtIDFdICYmIGxpbmVQYXNzU3Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMgPSBicmFuY2g7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZU1haW5TdG5zID0gW107XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIDEgMSAtMSAtMVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3Rucy51bnNoaWZ0KGxpbmVNYWluU3Ruc1tsaW5lTWFpblN0bnMubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBzdHJldGNoIHRoZSBtYWluIGxpbmVcclxuICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLl9saW5lUGF0aChsaW5lTWFpblN0bnMpXHJcbiAgICAgICAgICAgIHZhciBwYXRocyA9IHBhdGgubWF0Y2goL1tcXGQuXSsvZylcclxuICAgICAgICAgICAgcGF0aCA9IGBNICR7cGF0aHNbMF19LCR7cGF0aHNbMV19IEggJHtOdW1iZXIocGF0aHNbMl0pICsgMzB9YFxyXG5cclxuICAgICAgICAgICAgLy8gZHJhdyB0aGUgbWFpbiBsaW5lXHJcbiAgICAgICAgICAgICQoJyNsaW5lX21haW4nKS5hcHBlbmQoJCgnPHBhdGg+JywgeyBkOiBwYXRoIH0pKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmV0Y2ggdGhlIHBhc3MgbGluZVxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVQYXNzU3RucylcclxuICAgICAgICAgICAgdmFyIHBhdGhzID0gcGF0aC5tYXRjaCgvW1xcZC5dKy9nKVxyXG4gICAgICAgICAgICBwYXRoID0gYE0gJHtOdW1iZXIocGF0aHNbMF0pIC0gMzB9LCR7cGF0aHNbMV19IEggJHtwYXRoc1syXX1gXHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBwYXNzIGxpbmVcclxuICAgICAgICAgICAgJCgnI2xpbmVfcGFzcycpLmFwcGVuZCgkKCc8cGF0aD4nLCB7IGQ6IHBhdGggfSkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkKCcjbGluZV9tYWluJykuaHRtbCgkKCcjbGluZV9tYWluJykuaHRtbCgpKTtcclxuICAgICAgICAkKCcjbGluZV9wYXNzJykuaHRtbCgkKCcjbGluZV9wYXNzJykuaHRtbCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBmaWxsVGhlbWVDb2xvdXIoKSB7XHJcbiAgICAgICAgc3VwZXIuZmlsbFRoZW1lQ29sb3VyKCk7XHJcblxyXG4gICAgICAgIC8vIHRoaXMgd2lsbCBhZGQgdGhlIHN0cm9rZSBvZiB0aGUgY2lyY2xlXHJcbiAgICAgICAgLy8gaG93ZXZlciB0aGUgc3Ryb2tlIHBhdGggaXMgZGVmaW5lZCBpbiBpbmRleC5odG1sXHJcbiAgICAgICAgLy8gd2hpY2ggbWFkZSBjaGFuZ2luZyBzdGF0aW9uIHN0eWxlIHN0cmFuZ2VcclxuICAgICAgICAkKCdwYXRoIycgKyBzdGF0aW9uX2lkKS5hdHRyKCdzdHJva2UnLCB0aGlzLl90aGVtZUNvbG91cik7XHJcblxyXG4gICAgICAgIC8vIHBhc3Mgc3Ryb2tlIHNob3VsZCBiZSBhZGRlZCBzb21ld2hlcmUgZWxzZVxyXG4gICAgICAgIC8vIGJ1dCBJIGNhbid0IGZpZ3VyZSBpdCBvdXRcclxuICAgICAgICAkKCdwYXRoI3N0bl9zaF9wYXNzJykuYXR0cignc3Ryb2tlJywgJyNhYWEnKTtcclxuXHJcbiAgICAgICAgLy8gdGhlIGxhc3QgZGVjb3JhdGlvbiBsaW5lXHJcbiAgICAgICAgJCgnI2xpbmVfc2htZXRyb19sZWZ0X3VzZScpLmF0dHIoJ2ZpbGwnLCB0aGlzLl90aGVtZUNvbG91cilcclxuICAgIH1cclxuXHJcbiAgICBkcmF3RGVzdEluZm8oKSB7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI3BsYXRmb3JtID4gdGV4dCcpLnRleHQodGhpcy5fcGxhdGZvcm1OdW0pO1xyXG5cclxuICAgICAgICBsZXQgdmFsaWREZXN0OiBJRFtdID0gdGhpc1t0aGlzLl9kaXJlY3Rpb24gKyAnVmFsaWREZXN0cyddO1xyXG5cclxuICAgICAgICB2YXIgW2Rlc3ROYW1lWkgsIGRlc3ROYW1lRU5dID0gWzAsIDFdLm1hcChpZHggPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsaWREZXN0Lm1hcChzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5uYW1lW2lkeF0ucmVwbGFjZSgvXFxcXC9nLCAnICcpKS5qb2luKCcvJyk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgdmFyIGJjciA9ICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+IGc6bGFzdC1jaGlsZCcpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciBmbGFnTGVuZ3RoID0gMTYwICsgMTUwICsgYmNyLndpZHRoICsgNDUgKyA1MDtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImZsYWdMZW5ndGg6IFwiICsgZmxhZ0xlbmd0aClcclxuXHJcblxyXG5cclxuICAgICAgICAvLyBhcnJvd1xyXG4gICAgICAgIHZhciBpc0xlZnQgPSAodGhpcy5fZGlyZWN0aW9uID09ICdyJykgPyAxIDogLTE7XHJcbiAgICAgICAgdmFyIGFycm93WCA9ICh0aGlzLl9zdmdEZXN0V2lkdGggLSBpc0xlZnQgKiBmbGFnTGVuZ3RoKSAvIDIwO1xyXG4gICAgICAgIHZhciBhcnJvd1JvdGF0ZSA9IDkwICogKDEgLSBpc0xlZnQpO1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNhcnJvd19sZWZ0X3VzZScpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHthcnJvd1h9LDEzNSlyb3RhdGUoJHthcnJvd1JvdGF0ZX0pYCk7XHJcblxyXG4gICAgICAgIC8vIG5vdCBpbiB1c2Ugbm93XHJcbiAgICAgICAgdmFyIHBsYXRmb3JtTnVtWCA9IGFycm93WCArIGlzTGVmdCAqICgxNjAgKyA1MCArIDc1KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjcGxhdGZvcm0nKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7cGxhdGZvcm1OdW1YfSwxMzApYCk7XHJcblxyXG4gICAgICAgIC8vIGxpc3QgdGhlIGRlc3RpbmF0aW9uIHRleHRcclxuICAgICAgICAvLyBUb2RvOiBmaXggc3ZnX2Rlc3Rfd2lkdGgqMC44LCB0aGlzIGhhcyBvbmx5IGJlZW4gdGVzdGVkIG9uIDEwMDAgd2lkdGhcclxuICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnbCcpIHtcclxuICAgICAgICAgICAgdmFyIHR4dEFuY2hvciA9ICdlbmQnO1xyXG4gICAgICAgICAgICB2YXIgZGVzdE5hbWVYID0gdGhpcy5fc3ZnRGVzdFdpZHRoICogMC44O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB0eHRBbmNob3IgPSAnc3RhcnQnO1xyXG4gICAgICAgICAgICB2YXIgZGVzdE5hbWVYID0gdGhpcy5fc3ZnRGVzdFdpZHRoICogMC4yO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiBnOmxhc3QtY2hpbGQnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7ZGVzdE5hbWVYfSwxMzUpYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdHh0QW5jaG9yXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGZvciBlYWNoIGxlZnQgdmFsaWQgZGVzdGluYXRpb25zLCBnZXQgdGhlIG5hbWUgZnJvbSBpZFxyXG4gICAgICAgIHZhciBkZXN0aW5hdGlvbnNfemggPSBcIlwiLCBkZXN0aW5hdGlvbnNfZW4gPSBcIlwiXHJcbiAgICAgICAgdGhpcy5sVmFsaWREZXN0cy5mb3JFYWNoKHN0biA9PiB7XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uc196aCArPSB0aGlzLnN0YXRpb25zW3N0bl0ubmFtZVswXVxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNfZW4gKz0gdGhpcy5zdGF0aW9uc1tzdG5dLm5hbWVbMV1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQoYOW+gCR7ZGVzdGluYXRpb25zX3pofWApXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCA+IHRleHQ6bGFzdC1jaGlsZCcpLnRleHQoYFRvICR7ZGVzdGluYXRpb25zX2VufWApXHJcblxyXG4gICAgICAgIC8vIHRoZSBsYXN0IGRlY29yYXRpb24gbGluZVxyXG4gICAgICAgICQoJyNsaW5lX3NobWV0cm9fbGVmdF91c2UnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDAsMjIwKWAsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTdG5OYW1lQmcoKSB7XHJcbiAgICAgICAgJCgnI2N1cnJlbnRfYmcnKS5oaWRlKCk7ICAvLyBmaXggdGhlIG15c3RlcmlvdXMgYmxhY2sgcmVjdFxyXG4gICAgfVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9