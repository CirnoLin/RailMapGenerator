(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,e,s){"use strict";s.r(e);var n=s(7),a=s(1);class i extends a.l{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-60)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends i{constructor(t,e){super(t,e),this._intInfos=e.interchange[0]}get html(){return $("<g>",{id:this.id}).append(...this.ungrpHTML)}get ungrpHTML(){return[this.iconHTML,this.nameHTML]}get ungrpIconHTML(){return[...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[a.d.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{id:`rmg-name__shmetro--${this.id}`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){let t=[],e=$(`#rmg-name__shmetro--${this.id}`),s=e.get(0).getBoundingClientRect(),n=s.right-s.left+5;this._intInfos.map((e,s)=>{var i=e[a.d.colour],r=$("<use>",{"xlink:href":"#int_sh",fill:i,transform:`translate(${n+25*s},-12)`,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&r.addClass("rmg-line__pass");let h=String(e[a.d.nameZH]).match(/(\d*)\w+/);if(h)var o=h[0];else o=String(e[a.d.nameZH]);var l=$("<text>",{transform:`translate(${n+6+25*s},8)`,class:"rmg-name__zh rmg-name__shmetro--line_name"}).text(o);t.push(r,l)});let i=e.parent();return i.attr("transform",`${i.attr("transform")}rotate(-60)`),t}get _nameClass(){return-1==this.state?"Pass":"Future"}}s.d(e,"RMGLineSH",(function(){return h}));class h extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":case"int3_l":case"int3_r":return new r(t,e);default:return new i(t,e)}}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50,e="l"==this._direction?1:-1,s=(this._svgDestWidth-e*t)/20;s="l"==this._direction?s:this._svgDestWidth-20;var n=90*(1-e);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${s},135)rotate(${n})`);var a=s+285*e;if($("#station_info_shmetro > #platform").attr("transform",`translate(${a},130)`),"r"===this._direction)var i="end",r=.8*this._svgDestWidth;else i="start",r=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${r},135)`,"text-anchor":i});var[h,o]=["",""];this[`${this._direction}ValidDests`].forEach(t=>{h+=this.stations[t].name[0],o+=this.stations[t].name[1]}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${h}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${o}`);let l="l"===this._direction?this._svgDestWidth:320;var[_,m]=this._lineNames,d=_.match(/(\d*)\w+/);d?(l-=180,_="号线",$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-120},70)`}),$("#station_info_shmetro > #line_number > text").text(d[0]).attr("transform",`translate(${l-100},170)`)):(l-=280,$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-10},60)`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(_),$("#station_info_shmetro > #line_name_text > text:last-child").text(m),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${l},135)`,"text-anchor":"start"});let c="l"==this._direction?"left":"right";$("#line_shmetro_use").attr({"xlink:href":`#line_shmetro_${c}`,transform:"translate(0,220)"})}drawStns(){for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||$("#stn_icons").append(e.html);$("#stn_icons").html($("#stn_icons").html());for(let[t,e]of Object.entries(this.stations).filter(t=>t[1]instanceof r))$(`#rmg-name__shmetro--${t}`).parent().append(e.ungrpIconHTML);$("#stn_icons").html($("#stn_icons").html())}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1]));var n=this._linePath(e),[a,i,r]=n.match(/[\d.]+/g).map(t=>Number(t));n="r"===this._direction?`M ${a},${i-6} H ${r+30} l 12,12 L ${a},${i+6} Z`:`M ${a-30},${i-6} H ${r} l 0,12 L ${a-42},${i+6} Z`,$("#line_main").append($("<path>",{id:"line_main_path",d:n}));n=this._linePath(s);var[a,i,r]=n.match(/[\d.]+/g).map(t=>Number(t));n="r"===this._direction?`M ${a-30},${i-6} H ${r} l 0,12 L ${a-30},${i+6} Z`:`M ${a},${i-6} H ${r+30} l 0,12 L ${a},${i+6} Z`,$("#line_pass").append($("<path>",{id:"line_pass_path",d:n}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("path#int2_sh_pass").attr("stroke","#aaa"),$("path#line_main_path").attr("fill",this._themeColour),$("path#line_pass_path").attr("fill","#aaa");let t="l"==this._direction?"left":"right";$(`#line_shmetro_${t}`).attr("fill",this._themeColour),this._lineNames[0].match(/(\d*)\w+/)?$("#station_info_shmetro > #line_number > text").attr("fill","#fff"):$("#station_info_shmetro > #line_name_text").attr("fill","#fff")}updateStnNameBg(){$("#current_bg").hide()}static initSVG(t){t.drawSVGFrame(),t.showFrameOuter(),t.drawStns(),t.drawLine(),t.fillThemeColour(),t.drawStrip(),t.drawDestInfo(),t.loadFonts(),t.updateStnNameBg()}set direction(t){super.direction=t,this.fillThemeColour()}set currentStnId(t){super.currentStnId=t,this.fillThemeColour()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),$("#stn_icons").empty(),this.drawStns()}set yPc(t){super.yPc=t;let e=t*this._svgHeight/50;$("g#main").attr("transform",`translate(0,${e})`)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJuYW1lRU5MbiIsIm5hbWUiLCJzcGxpdCIsImxlbmd0aCIsImR4IiwiX25hbWVTaGlmdCIsIl90aWNrUm90YXRpb24iLCJNYXRoIiwiY29zIiwiaWNvblR5cGUiLCJudW1DbGFzcyIsInN0YXRlIiwic3RhdGlvbl9pZCIsIiQiLCJ0cmFuc2Zvcm0iLCJ4IiwiYXBwZW5kIiwiY2xhc3MiLCJkeSIsIl9keGR5IiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiX2ludEluZm9zIiwiaW50ZXJjaGFuZ2UiLCJ1bmdycEhUTUwiLCJpY29uSFRNTCIsIm5hbWVIVE1MIiwiaW50VGlja0hUTUwiLCJzdHJva2UiLCJjb2xvdXIiLCJsaW5lRWxlbXMiLCJzdG5OYW1lRWxlbSIsImJjciIsImdldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0IiwibGVmdCIsIm1hcCIsInN0biIsImluZGV4IiwibGluZUljb25Db2xvdXIiLCJsaW5lSWNvbkVsZW0iLCJmaWxsIiwibGluZU51bWJlciIsIlN0cmluZyIsIm5hbWVaSCIsIm1hdGNoIiwibGluZU5hbWUiLCJsaW5lTmFtZUVsZW0iLCJwdXNoIiwic3RuSW5mb0VsZW0iLCJwYXJlbnQiLCJhdHRyIiwicGFyYW0iLCJzdG5JZCIsInN0bkluZm8iLCJjaGFuZ2VfdHlwZSIsIl9wbGF0Zm9ybU51bSIsImZsYWdMZW5ndGgiLCJ3aWR0aCIsImlzTGVmdCIsIl9kaXJlY3Rpb24iLCJhcnJvd1giLCJfc3ZnRGVzdFdpZHRoIiwiYXJyb3dSb3RhdGUiLCJwbGF0Zm9ybU51bVgiLCJ0eHRBbmNob3IiLCJkZXN0TmFtZVgiLCJkZXN0aW5hdGlvbnNfemgiLCJkZXN0aW5hdGlvbnNfZW4iLCJmb3JFYWNoIiwic3RhdGlvbnMiLCJsaW5lTmFtZVgiLCJsaW5lTmFtZVpIIiwibGluZU5hbWVFTiIsIl9saW5lTmFtZXMiLCJfdGhlbWVDb2xvdXIiLCJoaWRlIiwiZGlyZWN0aW9uIiwic3RuSW5zdGFuY2UiLCJPYmplY3QiLCJlbnRyaWVzIiwiaW5jbHVkZXMiLCJodG1sIiwiZmlsdGVyIiwidW5ncnBJY29uSFRNTCIsInJlbW92ZUNsYXNzIiwiYnJhbmNoZXMiLCJicmFuY2giLCJsaW5lTWFpblN0bnMiLCJsaW5lUGFzc1N0bnMiLCJpbmRleE9mIiwidW5zaGlmdCIsInBhdGgiLCJfbGluZVBhdGgiLCJoIiwicG9zIiwiTnVtYmVyIiwiZCIsImZpbGxUaGVtZUNvbG91ciIsImxpbmUiLCJkcmF3U1ZHRnJhbWUiLCJzaG93RnJhbWVPdXRlciIsImRyYXdTdG5zIiwiZHJhd0xpbmUiLCJkcmF3U3RyaXAiLCJkcmF3RGVzdEluZm8iLCJsb2FkRm9udHMiLCJ1cGRhdGVTdG5OYW1lQmciLCJ2YWwiLCJjdXJyZW50U3RuSWQiLCJ0eXBlIiwiaW5mbyIsInVwZGF0ZVN0blRyYW5zZmVyIiwiZW1wdHkiLCJ5UGMiLCJfc3ZnSGVpZ2h0Il0sIm1hcHBpbmdzIjoia0hBS0EsTUFBTSxVQUFxQixJQUN2QixZQUFZQSxFQUFRQyxHQUNoQkMsTUFBTUYsRUFBSUMsR0FDVkUsS0FBS0MsT0FBU0gsRUFBS0ksSUFHdkIsaUJBQW1CLE9BQU8sRUFDMUIsb0JBQXNCLE9BQU9GLEtBQUtHLEVBQUksRUFBSSxJQUFNLEVBQ2hELFlBQ0ksSUFBSUMsRUFBV0osS0FBS0ssS0FBSyxHQUFHQyxNQUFNLE1BQU1DLE9BQ3hDLElBQUlDLEVBU0osT0FQSUEsRUFEQVIsS0FBS1MsV0FDdUIsSUFBdkJULEtBQUtVLGVBQXVCLEVBQUksR0FBc0IsSUFBaEJOLEVBQVcsR0FBVU8sS0FBS0MsS0FBSyxJQUU5QyxJQUF2QlosS0FBS1UsZUFBdUIsR0FBc0IsSUFBaEJOLEVBQVcsSUFBV08sS0FBS0MsS0FBSyxLQUFPLEVBSzNFLENBQUNKLEVBRndCLElB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dEMvRCxFQUFFLG9CQUFvQnVDLEtBQUssU0FBVSxRQUNyQ3ZDLEVBQUUscUJBQXFCdUMsS0FBSyxTQUFVLFFBR3RDdkMsRUFBRSx1QkFBdUJ1QyxLQUFLLE9BQVF4RCxLQUFLZ0YsY0FDM0MvRCxFQUFFLHVCQUF1QnVDLEtBQUssT0FBUSxRQUd0QyxJQUFJMEIsRUFBK0IsS0FBbkJsRixLQUFLaUUsV0FBb0IsT0FBUyxRQUNsRGhELEVBQUUsaUJBQWlCaUUsS0FBYTFCLEtBQUssT0FBUXhELEtBQUtnRixjQUU5Q2hGLEtBQUsrRSxXQUFXLEdBQUc3QixNQUFNLFlBRXpCakMsRUFBRSwrQ0FBK0N1QyxLQUFLLE9BQVEsUUFHOUR2QyxFQUFFLDJDQUEyQ3VDLEtBQUssT0FBUSxRQUlsRSxrQkFDSXZDLEVBQUUsZUFBZWdFLE9BSXJCLGVBQWV1QixHQUNYQSxFQUFLQyxlQUNMRCxFQUFLRSxpQkFDTEYsRUFBS0csV0FHTEgsRUFBS0ksV0FDTEosRUFBS0Qsa0JBR0xDLEVBQUtLLFlBQ0xMLEVBQUtNLGVBQ0xOLEVBQUtPLFlBQ0xQLEVBQUtRLGtCQUlULGNBQWNDLEdBQ1ZsSCxNQUFNbUYsVUFBWStCLEVBRWxCakgsS0FBS3VHLGtCQUlULGlCQUFpQlUsR0FDYmxILE1BQU1tSCxhQUFlRCxFQUVyQmpILEtBQUt1RyxrQkFJVCxrQkFBa0I3QyxFQUFXeUQsRUFBTUMsRUFBTyxNQUN0Q3JILE1BQU1zSCxrQkFBa0IzRCxFQUFPeUQsRUFBTUMsR0FHckNuRyxFQUFFLGNBQWNxRyxRQUNoQnRILEtBQUsyRyxXQUlULFFBQVFNLEdBQ0psSCxNQUFNd0gsSUFBTU4sRUFFWixJQUFJOUcsRUFBSThHLEVBQU1qSCxLQUFLd0gsV0FBYSxHQUNoQ3ZHLEVBQUUsVUFBVXVDLEtBQUssWUFBYSxlQUFlckQiLCJmaWxlIjoiTGluZVNILm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJNR1N0YXRpb24sIEludEluZm9UYWcsIEludGVyY2hhbmdlSW5mbyB9IGZyb20gJy4vU3RhdGlvbic7XHJcbmltcG9ydCB7IElELCBOYW1lLCBCcmFuY2hJbmZvLCBTdGF0aW9uSW5mbyB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmNvbnN0IHN0YXRpb25faWQgPSAnc3RuX3NoJ1xyXG5cclxuY2xhc3MgUk1HU3RhdGlvblNIIGV4dGVuZHMgUk1HU3RhdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihpZDogSUQsIGRhdGE6IFN0YXRpb25JbmZvKSB7XHJcbiAgICAgICAgc3VwZXIoaWQsIGRhdGEpO1xyXG4gICAgICAgIHRoaXMuc3RuTnVtID0gZGF0YS5udW07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IF9uYW1lU2hpZnQoKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgZ2V0IF90aWNrUm90YXRpb24oKSB7IHJldHVybiB0aGlzLnkgPiAwID8gMTgwIDogMDsgfVxyXG4gICAgZ2V0IF9keGR5KCkge1xyXG4gICAgICAgIHZhciBuYW1lRU5MbiA9IHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpLmxlbmd0aDtcclxuICAgICAgICBsZXQgZHg6IG51bWJlcjtcclxuICAgICAgICBpZiAodGhpcy5fbmFtZVNoaWZ0KSB7XHJcbiAgICAgICAgICAgIGR4ID0gdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gLTkgOiAxNiArIChuYW1lRU5MbiAtIDEpICogMTIgKiBNYXRoLmNvcygtNDUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGR4ID0gdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gKDI0ICsgKG5hbWVFTkxuIC0gMSkgKiAxMikgKiBNYXRoLmNvcygtNDUpIDogLTY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGxldCBkeCA9IHRoaXMuX25hbWVTaGlmdCA/IC04IDogKDI0ICsgKG5hbWVFTkxuLTEpKjEyKSAqIE1hdGguY29zKC00NSk7XHJcbiAgICAgICAgbGV0IGR5ID0gdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gKC00IC0gMjEuOTIxODc1IC0gKG5hbWVFTkxuIC0gMSkgKiAxMiAqIE1hdGguY29zKC00NSkpIDogMTcuNTtcclxuICAgICAgICAvLyB2YXIgZHkgPSAoLTQgLSAyMS45MjE4NzUgLSAobmFtZUVOTG4tMSkqMTIqTWF0aC5jb3MoLTQ1KSkgKiAodGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gMSA6IC0xKTtcclxuICAgICAgICByZXR1cm4gW2R4LCBkeV1cclxuICAgIH1cclxuXHJcbiAgICBnZXQgaWNvbkhUTUwoKSB7XHJcbiAgICAgICAgdmFyIFtpY29uVHlwZSwgbnVtQ2xhc3NdID0gKHRoaXMuc3RhdGUgPT0gLTEpID8gW3N0YXRpb25faWQgKyAnX3Bhc3MnLCAnUGFzcyddIDogW3N0YXRpb25faWQsICdGdXR1cmUnXTtcclxuICAgICAgICByZXR1cm4gJCgnPGc+JywgeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHt0aGlzLnh9LCR7dGhpcy55fSlgIH0pXHJcbiAgICAgICAgICAgIC5hcHBlbmQoJCgnPHVzZT4nLCB7ICd4bGluazpocmVmJzogJyMnICsgaWNvblR5cGUsIGNsYXNzOiAncm1nLXN0bicgfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBuYW1lSFRNTCgpIHtcclxuICAgICAgICBsZXQgW2R4LCBkeV0gPSB0aGlzLl9keGR5XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHtcclxuICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHt0aGlzLnggLSBkeH0sJHt0aGlzLnkgKyBkeX0pcm90YXRlKC02MClgLFxyXG4gICAgICAgICAgICAndGV4dC1hbmNob3InOiB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAnc3RhcnQnIDogJ2VuZCcsXHJcbiAgICAgICAgICAgIC8vIGNsYXNzOiBgTmFtZSAke3RoaXMubmFtZUNsYXNzfWBcclxuICAgICAgICAgICAgY2xhc3M6IGBOYW1lIEZ1dHVyZWAgIC8vIHRvZG86IGZpeCB0aGlzXHJcbiAgICAgICAgfSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAkKCc8dGV4dD4nKS5hZGRDbGFzcygncm1nLW5hbWVfX3poIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJykudGV4dCh0aGlzLm5hbWVbMF0pXHJcbiAgICAgICAgKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICQoJzx0ZXh0PicsIHtcclxuICAgICAgICAgICAgICAgIGR5OiAxNSwgY2xhc3M6ICdybWctbmFtZV9fZW4gcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nXHJcbiAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMF0pLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICQoJzx0c3Bhbj4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ3gnOiAwLCAnZHknOiAxMlxyXG4gICAgICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVsxXSlcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIEludFN0YXRpb25TSCBleHRlbmRzIFJNR1N0YXRpb25TSCB7XHJcbiAgICBwcm90ZWN0ZWQgX2ludEluZm9zOiBJbnRlcmNoYW5nZUluZm9bXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihpZDogSUQsIGRhdGE6IFN0YXRpb25JbmZvKSB7XHJcbiAgICAgICAgc3VwZXIoaWQsIGRhdGEpO1xyXG4gICAgICAgIHRoaXMuX2ludEluZm9zID0gZGF0YS5pbnRlcmNoYW5nZVswXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gYXBwZW5kIGRvbSBhbmQgdGhlbiBnZXRCb3VuZGluZ0NsaWVudFJlY3RcclxuICAgIC8vIHRvIGdldCB0aGUgZXhhY3QgcG9zaXRpb24gd2hlcmUgaW50IGljb24gY2FuIGJlIGZpdFxyXG4gICAgZ2V0IGh0bWwoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgaWQ6IHRoaXMuaWQgfSkuYXBwZW5kKC4uLnRoaXMudW5ncnBIVE1MKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gZ2V0IGFsbCBkcmF3aW5nIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZFxyXG4gICAgZ2V0IHVuZ3JwSFRNTCgpIHtcclxuICAgICAgICByZXR1cm4gW3RoaXMuaWNvbkhUTUwsIHRoaXMubmFtZUhUTUxdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB1bmdycEljb25IVE1MKCkge1xyXG4gICAgICAgIHJldHVybiBbLi4udGhpcy5pbnRUaWNrSFRNTF1cclxuICAgIH1cclxuXHJcbiAgICAvLyBpbnRlcmNoYW5nZSBzdGF0aW9uIGljb24gb24gbWFpbiBsaW5lXHJcbiAgICBnZXQgaWNvbkhUTUwoKSB7XHJcbiAgICAgICAgdmFyIFtpY29uVHlwZSwgbnVtQ2xhc3NdID0gKHRoaXMuc3RhdGUgPT0gLTEpID8gWydpbnQyX3NoX3Bhc3MnLCAnUGFzcyddIDogWydpbnQyX3NoJywgJ0Z1dHVyZSddO1xyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke3RoaXMueH0sJHt0aGlzLnl9KWAgfSlcclxuICAgICAgICAgICAgLmFwcGVuZCgkKCc8dXNlPicsIHsgJ3hsaW5rOmhyZWYnOiAnIycgKyBpY29uVHlwZSwgY2xhc3M6ICdybWctc3RuJywgc3Ryb2tlOiB0aGlzLl9pbnRJbmZvc1tJbnRJbmZvVGFnLmNvbG91cl0gfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJlZ3VsYXIgc3RhdGlvbiBuYW1lXHJcbiAgICBnZXQgbmFtZUhUTUwoKSB7XHJcbiAgICAgICAgbGV0IFtkeCwgZHldID0gdGhpcy5fZHhkeTtcclxuICAgICAgICAvLyB3cmFwIHRoZSBuYW1lLCBkZWNyb19saW5lIGFuZCBpbnRfbGluZSB1bmRlciBnIGluIG9yZGVyIHRvIHJvdGF0ZSBhdCBvbmNlXHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54IC0gZHh9LCR7dGhpcy55ICsgZHl9KWAsICAvL3JvdGF0ZSgtNjApXHJcbiAgICAgICAgfSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgbmFtZSB0ZXh0XHJcbiAgICAgICAgICAgICQoJzxnPicsIHtcclxuICAgICAgICAgICAgICAgIGlkOiBgcm1nLW5hbWVfX3NobWV0cm8tLSR7dGhpcy5pZH1gLFxyXG4gICAgICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gJ3N0YXJ0JyA6ICdlbmQnLFxyXG4gICAgICAgICAgICAgICAgY2xhc3M6IGBOYW1lIEZ1dHVyZWAgIC8vIHRvZG86IGZpeCB0aGlzXHJcbiAgICAgICAgICAgIH0pLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICQoJzx0ZXh0PicpLmFkZENsYXNzKCdybWctbmFtZV9femggcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nKS50ZXh0KHRoaXMubmFtZVswXSlcclxuICAgICAgICAgICAgKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHk6IDE1LCBjbGFzczogJ3JtZy1uYW1lX19lbiBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbidcclxuICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMF0pLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICAkKCc8dHNwYW4+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAneCc6IDAsICdkeSc6IDEyXHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVsxXSlcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBpbnRlcmNoYW5nZSBzdGF0aW9uIGljb24gYWZ0ZXIgdGhlIHN0YXRpb24gbmFtZVxyXG4gICAgZ2V0IGludFRpY2tIVE1MKCkge1xyXG4gICAgICAgIGxldCBsaW5lRWxlbXM6IEpRdWVyeTxIVE1MRWxlbWVudD5bXSA9IFtdXHJcblxyXG4gICAgICAgIC8vIGdldCB0aGUgZXhhY3Qgc3RhdGlvbiBuYW1lIHdpZHRoIHNvIHRoYXQgdGhlXHJcbiAgICAgICAgLy8gaW50ZXJjaGFuZ2Ugc3RhdGlvbiBpY29uIGNhbiBiZSByaWdodCBhZnRlciB0aGUgc3RhdGlvbiBuYW1lXHJcbiAgICAgICAgbGV0IHN0bk5hbWVFbGVtID0gJChgI3JtZy1uYW1lX19zaG1ldHJvLS0ke3RoaXMuaWR9YClcclxuICAgICAgICBsZXQgYmNyID0gc3RuTmFtZUVsZW0uZ2V0KDApLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXHJcbiAgICAgICAgbGV0IGR4ID0gYmNyLnJpZ2h0IC0gYmNyLmxlZnQgKyA1XHJcblxyXG4gICAgICAgIHRoaXMuX2ludEluZm9zLm1hcCgoc3RuLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBpbnRlcmNoYW5nZSBsaW5lIGljb24gYWZ0ZXIgc3RhdGlvbiBuYW1lXHJcbiAgICAgICAgICAgIHZhciBsaW5lSWNvbkNvbG91ciA9IHN0bltJbnRJbmZvVGFnLmNvbG91cl07XHJcbiAgICAgICAgICAgIHZhciBsaW5lSWNvbkVsZW0gPSAkKCc8dXNlPicsIHtcclxuICAgICAgICAgICAgICAgICd4bGluazpocmVmJzogJyNpbnRfc2gnLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogbGluZUljb25Db2xvdXIsXHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtkeCArIGluZGV4ICogMjV9LC0xMilgLFxyXG4gICAgICAgICAgICAgICAgY2xhc3M6ICdybWctbGluZV9fc2htZXRybyBybWctbGluZV9fY2hhbmdlJyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5lSWNvbkVsZW0uYWRkQ2xhc3MoJ3JtZy1saW5lX19wYXNzJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGxpbmUgc3RhcnRzIHdpdGggbnVtYmVycyBvciBsZXR0ZXJzXHJcbiAgICAgICAgICAgIGxldCBsaW5lTnVtYmVyID0gU3RyaW5nKHN0bltJbnRJbmZvVGFnLm5hbWVaSF0pLm1hdGNoKC8oXFxkKilcXHcrLylcclxuICAgICAgICAgICAgaWYgKGxpbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5lTmFtZSA9IGxpbmVOdW1iZXJbMF1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaW5lTmFtZSA9IFN0cmluZyhzdG5bSW50SW5mb1RhZy5uYW1lWkhdKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGludGVyY2hhbmdlIGxpbmUgbmFtZVxyXG4gICAgICAgICAgICB2YXIgbGluZU5hbWVFbGVtID0gJCgnPHRleHQ+Jywge1xyXG4gICAgICAgICAgICAgICAgLy8gVG9kbzogZml4IHRoaXMgaGFyZC1jb2RlZCBjZW50ZXIoNikgcG9zaXRpb25cclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4ICsgNiArIGluZGV4ICogMjV9LDgpYCxcclxuICAgICAgICAgICAgICAgIGNsYXNzOiAncm1nLW5hbWVfX3poIHJtZy1uYW1lX19zaG1ldHJvLS1saW5lX25hbWUnLFxyXG4gICAgICAgICAgICB9KS50ZXh0KGxpbmVOYW1lKVxyXG5cclxuICAgICAgICAgICAgbGluZUVsZW1zLnB1c2gobGluZUljb25FbGVtLCBsaW5lTmFtZUVsZW0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gcm90YXRlIHRoZSBzdGF0aW9uIGluZm8gbm93XHJcbiAgICAgICAgLy8gb3RoZXIgd2lzZSB0aGUgYmNyIHdpbGwgYmUgaW5hY2N1cmF0ZSBkdWUgdG8gdGhlIHJvdGF0aW9uXHJcbiAgICAgICAgbGV0IHN0bkluZm9FbGVtID0gc3RuTmFtZUVsZW0ucGFyZW50KCk7XHJcbiAgICAgICAgc3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJywgYCR7c3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJyl9cm90YXRlKC02MClgKVxyXG5cclxuICAgICAgICByZXR1cm4gbGluZUVsZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZUNsYXNzKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PSAtMSkgPyAnUGFzcycgOiAnRnV0dXJlJztcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IFJNR1N0YXRpb25TSCwgSW50U3RhdGlvblNILCBzdGF0aW9uX2lkIH07XHJcbiIsImltcG9ydCB7IFJNR0xpbmUgfSBmcm9tICcuL0xpbmUnO1xyXG5pbXBvcnQgeyBSTUdTdGF0aW9uU0gsIEludFN0YXRpb25TSCwgc3RhdGlvbl9pZCB9IGZyb20gJy4uL1N0YXRpb24vU3RhdGlvblNIJztcclxuaW1wb3J0IHsgUk1HU3RhdGlvbiB9IGZyb20gJy4uL1N0YXRpb24vU3RhdGlvbic7XHJcblxyXG5pbXBvcnQgeyBJRCwgTmFtZSwgU3RhdGlvbkluZm8sIFJNR1BhcmFtLCBzZXRQYXJhbXMgfSBmcm9tICcuLi91dGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgUk1HTGluZVNIIGV4dGVuZHMgUk1HTGluZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJhbSkge1xyXG4gICAgICAgIHN1cGVyKHBhcmFtKTtcclxuICAgIH1cclxuXHJcbiAgICBfaW5pdFN0bkluc3RhbmNlKHN0bklkOiBJRCwgc3RuSW5mbzogU3RhdGlvbkluZm8pOiBSTUdTdGF0aW9uIHtcclxuICAgICAgICBzd2l0Y2ggKHN0bkluZm8uY2hhbmdlX3R5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSAnaW50Mic6XHJcbiAgICAgICAgICAgIGNhc2UgJ2ludDNfbCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ2ludDNfcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEludFN0YXRpb25TSChzdG5JZCwgc3RuSW5mbyk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJNR1N0YXRpb25TSChzdG5JZCwgc3RuSW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGRyYXcgdGhlIGRlc3RpbmF0aW9uXHJcbiAgICBkcmF3RGVzdEluZm8oKSB7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI3BsYXRmb3JtID4gdGV4dCcpLnRleHQodGhpcy5fcGxhdGZvcm1OdW0pO1xyXG5cclxuICAgICAgICB2YXIgYmNyID0gJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCcpWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciBmbGFnTGVuZ3RoID0gMTYwICsgMTUwICsgYmNyLndpZHRoICsgNDUgKyA1MDtcclxuXHJcblxyXG5cclxuICAgICAgICAvLyBhcnJvd1xyXG4gICAgICAgIHZhciBpc0xlZnQgPSAodGhpcy5fZGlyZWN0aW9uID09ICdsJykgPyAxIDogLTE7XHJcbiAgICAgICAgdmFyIGFycm93WCA9ICh0aGlzLl9zdmdEZXN0V2lkdGggLSBpc0xlZnQgKiBmbGFnTGVuZ3RoKSAvIDIwO1xyXG4gICAgICAgIGFycm93WCA9ICh0aGlzLl9kaXJlY3Rpb24gPT0gJ2wnKSA/IGFycm93WCA6IHRoaXMuX3N2Z0Rlc3RXaWR0aCAtIDIwO1xyXG4gICAgICAgIHZhciBhcnJvd1JvdGF0ZSA9IDkwICogKDEgLSBpc0xlZnQpO1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNhcnJvd19sZWZ0X3VzZScpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHthcnJvd1h9LDEzNSlyb3RhdGUoJHthcnJvd1JvdGF0ZX0pYCk7XHJcblxyXG4gICAgICAgIC8vIG5vdCBpbiB1c2Ugbm93XHJcbiAgICAgICAgdmFyIHBsYXRmb3JtTnVtWCA9IGFycm93WCArIGlzTGVmdCAqICgxNjAgKyA1MCArIDc1KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjcGxhdGZvcm0nKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7cGxhdGZvcm1OdW1YfSwxMzApYCk7XHJcblxyXG4gICAgICAgIC8vIGxpc3QgdGhlIGRlc3RpbmF0aW9uIHRleHRcclxuICAgICAgICAvLyBUb2RvOiBmaXggc3ZnX2Rlc3Rfd2lkdGgqMC44LCB0aGlzIGhhcyBvbmx5IGJlZW4gdGVzdGVkIG9uIDEwMDAgd2lkdGhcclxuICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAncicpIHtcclxuICAgICAgICAgICAgdmFyIHR4dEFuY2hvciA9ICdlbmQnO1xyXG4gICAgICAgICAgICB2YXIgZGVzdE5hbWVYID0gdGhpcy5fc3ZnRGVzdFdpZHRoICogMC44O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB0eHRBbmNob3IgPSAnc3RhcnQnO1xyXG4gICAgICAgICAgICB2YXIgZGVzdE5hbWVYID0gdGhpcy5fc3ZnRGVzdFdpZHRoICogMC4yO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0JykuYXR0cih7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2Rlc3ROYW1lWH0sMTM1KWAsXHJcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6IHR4dEFuY2hvclxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBmb3IgZWFjaCBsZWZ0IHZhbGlkIGRlc3RpbmF0aW9ucywgZ2V0IHRoZSBuYW1lIGZyb20gaWRcclxuICAgICAgICB2YXIgW2Rlc3RpbmF0aW9uc196aCwgZGVzdGluYXRpb25zX2VuXSA9IFtcIlwiLCBcIlwiXVxyXG4gICAgICAgIHRoaXNbYCR7dGhpcy5fZGlyZWN0aW9ufVZhbGlkRGVzdHNgXS5mb3JFYWNoKHN0biA9PiB7XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uc196aCArPSB0aGlzLnN0YXRpb25zW3N0bl0ubmFtZVswXVxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNfZW4gKz0gdGhpcy5zdGF0aW9uc1tzdG5dLm5hbWVbMV1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQoYOW+gCR7ZGVzdGluYXRpb25zX3pofWApXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCA+IHRleHQ6bGFzdC1jaGlsZCcpLnRleHQoYFRvICR7ZGVzdGluYXRpb25zX2VufWApXHJcblxyXG4gICAgICAgIC8vIHByZXBhcmUgZm9yIHRoZSBsaW5lIG5hbWVcclxuICAgICAgICBsZXQgbGluZU5hbWVYID0gdGhpcy5fZGlyZWN0aW9uID09PSAnbCcgPyB0aGlzLl9zdmdEZXN0V2lkdGggOiAzMjBcclxuICAgICAgICB2YXIgW2xpbmVOYW1lWkgsIGxpbmVOYW1lRU5dID0gdGhpcy5fbGluZU5hbWVzO1xyXG5cclxuICAgICAgICAvLyBsaW5lIHN0YXJ0cyB3aXRoIG51bWJlcnMgb3IgbGV0dGVyc1xyXG4gICAgICAgIHZhciBsaW5lTnVtYmVyID0gbGluZU5hbWVaSC5tYXRjaCgvKFxcZCopXFx3Ky8pXHJcbiAgICAgICAgaWYgKGxpbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgbGluZU5hbWVYIC09IDE4MDtcclxuICAgICAgICAgICAgbGluZU5hbWVaSCA9IFwi5Y+357q/XCJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gcmVjdCcpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgJ3N0eWxlJzogYGZpbGw6JHt0aGlzLl90aGVtZUNvbG91cn1gLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMjB9LDcwKWBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpXHJcbiAgICAgICAgICAgICAgICAudGV4dChsaW5lTnVtYmVyWzBdKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMDB9LDE3MClgKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxpbmVOYW1lWCAtPSAyODA7XHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHJlY3QnKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICdzdHlsZSc6IGBmaWxsOiR7dGhpcy5fdGhlbWVDb2xvdXJ9YCxcclxuICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYIC0gMTB9LDYwKWAsXHJcbiAgICAgICAgICAgICAgICAnd2lkdGgnOiAyNjAsXHJcbiAgICAgICAgICAgICAgICAnaGVpZ2h0JzogMTUwXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHRleHQnKS5oaWRlKClcclxuXHJcbiAgICAgICAgICAgIC8vIFRvZG86IHNldCB0aGUgZW5nIGluIHRoZSBtaWRkbGVcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykuYXR0cignZHgnLCAxMClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNldCB0aGUgbGluZSBuYW1lXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQobGluZU5hbWVaSClcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0Omxhc3QtY2hpbGQnKS50ZXh0KGxpbmVOYW1lRU4pXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0JykuYXR0cih7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2xpbmVOYW1lWH0sMTM1KWAsXHJcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICdzdGFydCdcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gdGhlIGxhc3QgZGVjb3JhdGlvbiBsaW5lXHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbiA9IHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcgPyAnbGVmdCcgOiAncmlnaHQnXHJcbiAgICAgICAgJCgnI2xpbmVfc2htZXRyb191c2UnKS5hdHRyKHtcclxuICAgICAgICAgICAgJ3hsaW5rOmhyZWYnOiBgI2xpbmVfc2htZXRyb18ke2RpcmVjdGlvbn1gLFxyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoMCwyMjApYCxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gYXBwZW5kIGRvbSBhbmQgdGhlbiBnZXRCb3VuZGluZ0NsaWVudFJlY3RcclxuICAgIC8vIHRvIGdldCB0aGUgZXhhY3QgcG9zaXRpb24gd2hlcmUgaW50IGljb24gY2FuIGJlIGZpdFxyXG4gICAgZHJhd1N0bnMoKSB7XHJcbiAgICAgICAgZm9yIChsZXQgW3N0bklkLCBzdG5JbnN0YW5jZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aW9ucykpIHtcclxuICAgICAgICAgICAgaWYgKFsnbGluZXN0YXJ0JywgJ2xpbmVlbmQnXS5pbmNsdWRlcyhzdG5JZCkpIHsgY29udGludWU7IH1cclxuICAgICAgICAgICAgJCgnI3N0bl9pY29ucycpLmFwcGVuZChzdG5JbnN0YW5jZS5odG1sKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0bl9pY29ucycpLmh0bWwoJCgnI3N0bl9pY29ucycpLmh0bWwoKSk7IC8vIFJlZnJlc2ggRE9NXHJcblxyXG4gICAgICAgIGZvciAobGV0IFtzdG5JZCwgc3RuSW5zdGFuY2VdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuc3RhdGlvbnMpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoc3RuID0+IHN0blsxXSBpbnN0YW5jZW9mIEludFN0YXRpb25TSCkgYXMgW0lELCBJbnRTdGF0aW9uU0hdW10pIHtcclxuICAgICAgICAgICAgJChgI3JtZy1uYW1lX19zaG1ldHJvLS0ke3N0bklkfWApLnBhcmVudCgpLmFwcGVuZChzdG5JbnN0YW5jZS51bmdycEljb25IVE1MKVxyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjc3RuX2ljb25zJykuaHRtbCgkKCcjc3RuX2ljb25zJykuaHRtbCgpKTsgLy8gUmVmcmVzaCBET01cclxuICAgIH1cclxuXHJcbiAgICAvLyBkcmF3IHRoZSBsaW5lIGluIHJhaWxtYXBcclxuICAgIGRyYXdMaW5lKCkge1xyXG4gICAgICAgICQoJy5ybWctbGluZScpLnJlbW92ZUNsYXNzKCdybWctbGluZV9fbXRyJykuYWRkQ2xhc3MoJ3JtZy1saW5lX19zaG1ldHJvJyk7XHJcblxyXG4gICAgICAgIHRoaXMuYnJhbmNoZXMubWFwKGJyYW5jaCA9PiB7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTWFpblN0bnMgPSBicmFuY2guZmlsdGVyKHN0bklkID0+IHRoaXMuc3RhdGlvbnNbc3RuSWRdLnN0YXRlID49IDApO1xyXG4gICAgICAgICAgICB2YXIgbGluZVBhc3NTdG5zID0gYnJhbmNoLmZpbHRlcihzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5zdGF0ZSA8PSAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMgPSBicmFuY2g7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMuZmlsdGVyKHN0bklkID0+IGxpbmVQYXNzU3Rucy5pbmRleE9mKHN0bklkKSAhPT0gLTEpLmxlbmd0aCA9PSAwICYmIGxpbmVNYWluU3Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHR3byBzZXQgZGlzam9pbnRcclxuICAgICAgICAgICAgICAgIGlmIChsaW5lUGFzc1N0bnNbMF0gPT09IGJyYW5jaFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIC0xIC0xIDEgMVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3Rucy5wdXNoKGxpbmVNYWluU3Ruc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmVNYWluU3Ruc1swXSA9PT0gYnJhbmNoWzBdICYmIGxpbmVNYWluU3Ruc1tsaW5lTWFpblN0bnMubGVuZ3RoIC0gMV0gPT09IGJyYW5jaFticmFuY2gubGVuZ3RoIC0gMV0gJiYgbGluZVBhc3NTdG5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3RucyA9IGJyYW5jaDtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lTWFpblN0bnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMSAxIC0xIC0xXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zLnVuc2hpZnQobGluZU1haW5TdG5zW2xpbmVNYWluU3Rucy5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmV0Y2ggdGhlIG1haW4gbGluZVxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVNYWluU3RucylcclxuICAgICAgICAgICAgdmFyIFt4LCB5LCBoXSA9IHBhdGgubWF0Y2goL1tcXGQuXSsvZykubWFwKHBvcyA9PiBOdW1iZXIocG9zKSlcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoID0gYE0gJHt4fSwke3kgLSA2fSBIICR7aCArIDMwfSBsIDEyLDEyIEwgJHt4fSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGBNICR7eCAtIDMwfSwke3kgLSA2fSBIICR7aH0gbCAwLDEyIEwgJHt4IC0gNDJ9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIG1haW4gbGluZVxyXG4gICAgICAgICAgICAkKCcjbGluZV9tYWluJykuYXBwZW5kKCQoJzxwYXRoPicsIHsgaWQ6ICdsaW5lX21haW5fcGF0aCcsIGQ6IHBhdGggfSkpO1xyXG5cclxuICAgICAgICAgICAgLy8gc3RyZXRjaCB0aGUgcGFzcyBsaW5lXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5fbGluZVBhdGgobGluZVBhc3NTdG5zKVxyXG4gICAgICAgICAgICB2YXIgW3gsIHksIGhdID0gcGF0aC5tYXRjaCgvW1xcZC5dKy9nKS5tYXAocG9zID0+IE51bWJlcihwb3MpKVxyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAncicpIHtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBgTSAke3ggLSAzMH0sJHt5IC0gNn0gSCAke2h9IGwgMCwxMiBMICR7eCAtIDMwfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGBNICR7eH0sJHt5IC0gNn0gSCAke2ggKyAzMH0gbCAwLDEyIEwgJHt4fSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBwYXNzIGxpbmVcclxuICAgICAgICAgICAgJCgnI2xpbmVfcGFzcycpLmFwcGVuZCgkKCc8cGF0aD4nLCB7IGlkOiAnbGluZV9wYXNzX3BhdGgnLCBkOiBwYXRoIH0pKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJCgnI2xpbmVfbWFpbicpLmh0bWwoJCgnI2xpbmVfbWFpbicpLmh0bWwoKSk7XHJcbiAgICAgICAgJCgnI2xpbmVfcGFzcycpLmh0bWwoJCgnI2xpbmVfcGFzcycpLmh0bWwoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsbFRoZW1lQ29sb3VyKCkge1xyXG4gICAgICAgIHN1cGVyLmZpbGxUaGVtZUNvbG91cigpO1xyXG5cclxuICAgICAgICAvLyB0aGlzIHdpbGwgYWRkIHRoZSBzdHJva2Ugb2YgdGhlIHN0YXRpb24gY2lyY2xlXHJcbiAgICAgICAgLy8gaG93ZXZlciB0aGUgc3Ryb2tlIHBhdGggaXMgZGVmaW5lZCBpbiBpbmRleC5odG1sXHJcbiAgICAgICAgLy8gd2hpY2ggbWFkZSBjaGFuZ2luZyBzdGF0aW9uIHN0eWxlIHN0cmFuZ2VcclxuICAgICAgICAkKCdwYXRoIycgKyBzdGF0aW9uX2lkKS5hdHRyKCdzdHJva2UnLCB0aGlzLl90aGVtZUNvbG91cik7XHJcbiAgICAgICAgJCgncGF0aCNpbnQyX3NoJykuYXR0cignc3Ryb2tlJywgdGhpcy5fdGhlbWVDb2xvdXIpO1xyXG5cclxuICAgICAgICAvLyBwYXNzIHN0cm9rZSBzaG91bGQgYmUgYWRkZWQgc29tZXdoZXJlIGVsc2VcclxuICAgICAgICAvLyBidXQgSSBjYW4ndCBmaWd1cmUgaXQgb3V0XHJcbiAgICAgICAgJCgncGF0aCNzdG5fc2hfcGFzcycpLmF0dHIoJ3N0cm9rZScsICcjYWFhJyk7XHJcbiAgICAgICAgJCgncGF0aCNpbnQyX3NoX3Bhc3MnKS5hdHRyKCdzdHJva2UnLCAnI2FhYScpO1xyXG5cclxuICAgICAgICAvLyB0aGUgcmFpbG1hcCBtYWluIGxpbmVcclxuICAgICAgICAkKCdwYXRoI2xpbmVfbWFpbl9wYXRoJykuYXR0cignZmlsbCcsIHRoaXMuX3RoZW1lQ29sb3VyKVxyXG4gICAgICAgICQoJ3BhdGgjbGluZV9wYXNzX3BhdGgnKS5hdHRyKCdmaWxsJywgJyNhYWEnKVxyXG5cclxuICAgICAgICAvLyB0aGUgbGFzdCBkZWNvcmF0aW9uIGxpbmVcclxuICAgICAgICBsZXQgZGlyZWN0aW9uID0gdGhpcy5fZGlyZWN0aW9uID09ICdsJyA/ICdsZWZ0JyA6ICdyaWdodCdcclxuICAgICAgICAkKGAjbGluZV9zaG1ldHJvXyR7ZGlyZWN0aW9ufWApLmF0dHIoJ2ZpbGwnLCB0aGlzLl90aGVtZUNvbG91cilcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2xpbmVOYW1lc1swXS5tYXRjaCgvKFxcZCopXFx3Ky8pKSB7XHJcbiAgICAgICAgICAgIC8vIHRoZSBsaW5lIHN0YXJ0cyB3aXRoIG51bWJlclxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiB0ZXh0JykuYXR0cignZmlsbCcsICcjZmZmJylcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGUgbGluZSBzdGFydHMgd2l0aCBsZXR0ZXJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0JykuYXR0cignZmlsbCcsICcjZmZmJylcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU3RuTmFtZUJnKCkge1xyXG4gICAgICAgICQoJyNjdXJyZW50X2JnJykuaGlkZSgpOyAgLy8gZml4IHRoZSBteXN0ZXJpb3VzIGJsYWNrIHJlY3RcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gbWFrZSBzdXJlIHRoZSBsaW5lIGlzIGRyYXcgYmVmb3JlIGNvbG9yXHJcbiAgICBzdGF0aWMgaW5pdFNWRyhsaW5lKSB7XHJcbiAgICAgICAgbGluZS5kcmF3U1ZHRnJhbWUoKTtcclxuICAgICAgICBsaW5lLnNob3dGcmFtZU91dGVyKCk7XHJcbiAgICAgICAgbGluZS5kcmF3U3RucygpO1xyXG5cclxuICAgICAgICAvLyBjaGFuZ2UgdGhlIGZ1bmMgY2FsbCBoZXJlXHJcbiAgICAgICAgbGluZS5kcmF3TGluZSgpO1xyXG4gICAgICAgIGxpbmUuZmlsbFRoZW1lQ29sb3VyKCk7XHJcbiAgICAgICAgLy8gY2hhbmdlIHRoZSBmdW5jIGNhbGwgaGVyZVxyXG5cclxuICAgICAgICBsaW5lLmRyYXdTdHJpcCgpO1xyXG4gICAgICAgIGxpbmUuZHJhd0Rlc3RJbmZvKCk7XHJcbiAgICAgICAgbGluZS5sb2FkRm9udHMoKTtcclxuICAgICAgICBsaW5lLnVwZGF0ZVN0bk5hbWVCZygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBjYWxsIGZpbGxUaGVtZUNvbG91ciB3aGVuIGZsaXAgZGlyZWN0aW9uXHJcbiAgICBzZXQgZGlyZWN0aW9uKHZhbCkge1xyXG4gICAgICAgIHN1cGVyLmRpcmVjdGlvbiA9IHZhbFxyXG5cclxuICAgICAgICB0aGlzLmZpbGxUaGVtZUNvbG91cigpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGNhbGwgZmlsbFRoZW1lQ29sb3VyIHdoZW4gc2V0IGN1cnJlbnQgc3RhdGlvblxyXG4gICAgc2V0IGN1cnJlbnRTdG5JZCh2YWwpIHtcclxuICAgICAgICBzdXBlci5jdXJyZW50U3RuSWQgPSB2YWxcclxuXHJcbiAgICAgICAgdGhpcy5maWxsVGhlbWVDb2xvdXIoKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBnZXQgZHJhd1N0bnMgcmVjYWxsZWRcclxuICAgIHVwZGF0ZVN0blRyYW5zZmVyKHN0bklkOiBJRCwgdHlwZSwgaW5mbyA9IG51bGwpIHtcclxuICAgICAgICBzdXBlci51cGRhdGVTdG5UcmFuc2ZlcihzdG5JZCwgdHlwZSwgaW5mbylcclxuXHJcbiAgICAgICAgLy8gY2xlYXIgdGhlIG9yaWdpbmFsIHN0YXRpb25zXHJcbiAgICAgICAgJCgnI3N0bl9pY29ucycpLmVtcHR5KClcclxuICAgICAgICB0aGlzLmRyYXdTdG5zKClcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2hhbmdlIHRoZSByYWlsbWFwIHBvc2l0aW9uXHJcbiAgICBzZXQgeVBjKHZhbCkge1xyXG4gICAgICAgIHN1cGVyLnlQYyA9IHZhbFxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB5ID0gdmFsICogdGhpcy5fc3ZnSGVpZ2h0IC8gNTA7XHJcbiAgICAgICAgJCgnZyNtYWluJykuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgwLCR7eX0pYCk7XHJcbiAgICB9XHJcblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=