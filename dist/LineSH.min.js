(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,e,s){"use strict";s.r(e);var n=s(8),i=s(1);class a extends i.m{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-50)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends a{constructor(t,e){super(t,e),this._intInfos=e.interchange[0]}get html(){return $("<g>",{id:this.id}).append(...this.ungrpHTML)}get ungrpHTML(){return[this.iconHTML,this.nameHTML]}get ungrpIconHTML(){return[...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[i.d.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{id:`rmg-name__shmetro--${this.id}`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){let t=[],e=$(`#rmg-name__shmetro--${this.id}`),s=e.get(0).getBoundingClientRect(),n=s.right-s.left+5;this._intInfos.map((e,s)=>{var a=e[i.d.colour],r=$("<use>",{"xlink:href":"#int_sh",fill:a,transform:`translate(${n+25*s},-12)`,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&r.addClass("rmg-line__pass");let o=String(e[i.d.nameZH]).match(/(\d*)\w+/);if(o)var h=o[0];else h=String(e[i.d.nameZH]);var l=$("<text>",{transform:`translate(${n+10+25*s},8)`,class:"rmg-name__zh rmg-name__shmetro--line_name","text-anchor":"middle",fill:e[i.d.fg]}).text(h);t.push(r,l)});let a=e.parent();return a.attr("transform",`${a.attr("transform")}rotate(-50)`),t}get _nameClass(){return-1==this.state?"Pass":"Future"}}s.d(e,"RMGLineSH",(function(){return o}));class o extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":case"int3_l":case"int3_r":return new r(t,e);case"osi11_ul":case"osi11_pl":case"osi11_ur":case"osi11_pr":case"osi12_ul":case"osi12_pl":case"osi12_ur":case"osi12_pr":case"osi21_ul":case"osi21_pl":case"osi21_ur":case"osi21_pr":case"osi22_ul":case"osi22_pl":case"osi22_ur":case"osi22_pr":default:return new a(t,e)}}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50,e="l"==this._direction?1:-1,s=(this._svgDestWidth-e*t)/20;s="l"==this._direction?s:this._svgDestWidth-20;var n=90*(1-e);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${s},135)rotate(${n})`);var i=s+285*e;if($("#station_info_shmetro > #platform").attr("transform",`translate(${i},130)`),"r"===this._direction)var a="end",r=.8*this._svgDestWidth;else a="start",r=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${r},135)`,"text-anchor":a});var[o,h]=[[],[]];this[`${this._direction}ValidDests`].forEach(t=>{o.push(this.stations[t].name[0]),h.push(this.stations[t].name[1])}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${o.join("，")}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${h.join(", ")}`);let l="l"===this._direction?this._svgDestWidth:320;var[_,m]=this._lineNames,d=_.match(/(\d*)\w+/);d?(l-=180,_="号线",$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-120},70)`}),$("#station_info_shmetro > #line_number > text").text(d[0]).attr({transform:`translate(${l-70},170)`,fill:this._fgColour})):(l-=280,$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-10},60)`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(_),$("#station_info_shmetro > #line_name_text > text:last-child").text(m),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${l},135)`,"text-anchor":"start"});let c="";c="l"==this._direction?`M30,10 H ${this._svgDestWidth-20} V 20 H 20 Z`:`M20,10 H ${this._svgDestWidth-30} l 10,10 H 20 Z`,$("#line_shmetro_use").attr({transform:"translate(0,220)",d:c})}drawStns(){for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||$("#stn_icons").append(e.html);$("#stn_icons").html($("#stn_icons").html());for(let[t,e]of Object.entries(this.stations).filter(t=>t[1]instanceof r))$(`#rmg-name__shmetro--${t}`).parent().append(e.ungrpIconHTML);$("#stn_icons").html($("#stn_icons").html())}_stnYShare(t){if(["linestart","lineend"].includes(t)||this._stnIndegree(t)>1||this._stnOutdegree(t)>1)return 0;var e=this.stations[t].parents[0];return e?1==this._stnOutdegree(e)?this._stnYShare(e):0==this.stations[e].children.indexOf(t)?3:0:0}_linePath(t,e){var[s,n,i]=[],a={};const r=30;if(t.forEach(t=>{var[e,r]=["_stnRealX","_stnRealY"].map(e=>this[e](t));if(!n&&0!==n)return[s,i,n]=[t,e,r],void(a.start=[e,r]);0===r?r!=n&&(a.bifurcate=[i,n]):r!=n&&(a.bifurcate=[e,r]),a.end=[e,r],[s,i,n]=[t,e,r]}),a.hasOwnProperty("start")){if(a.hasOwnProperty("end")){if(a.hasOwnProperty("bifurcate")){let[t,s]=a.start,[n,i]=(a.end[0],a.bifurcate),[o,h]=a.end;return"main"===e?"l"===this._direction?h>s?`M ${t-r},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t-r-12},${s+6} Z`:`M ${o},${h-6} H ${n-r} L ${t},${s-6} l 0,12 L ${n-r},${i+6} L ${o},${h+6} Z`:h>s?`M ${t},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t},${s+6} Z`:`M ${o+r},${h-6} H ${n-r} L ${t},${s-6} l 0,12 L ${n-r},${i+6} L ${o+r+12},${h+6} Z`:(this._direction,h>s?`M ${t-r},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t-r},${s+6} Z`:`M ${t},${s-6} L ${n-r},${i-6} H ${o+r} l 0,12 L ${n-r},${i+6} L ${t},${s+6} Z`)}{let[t,s]=a.start,n=a.end[0];return"main"===e?"l"===this._direction?`M ${t-r},${s-6} H ${n} l 0,12 L ${t-42},${s+6} Z`:`M ${t},${s-6} H ${n+r} l 12,12 L ${t},${s+6} Z`:(this._direction,`M ${t-r},${s-6} H ${n+r} l 0,12 L ${t-r},${s+6} Z`)}}{let[t,s]=a.start;return"main"===e?"l"===this._direction?`M ${t},${s-6} L ${t-r},${s-6} l -12,12 L ${t},${s+6} Z`:`M ${t},${s-6} L ${t+r},${s-6} l 12,12 L ${t},${s+6} Z`:"l"===this._direction?`M ${t},${s-6} L ${t+r},${s-6} l 0,12 L ${t-r},${s+6} Z`:`M ${t-r},${s-6} L ${t},${s-6} l 0,12 L ${t-r},${s+6} Z`}}return""}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1]));let n=this._linePath(e,"main");(n||""!=n)&&$("#line_main").append($("<path>",{id:"line_main_path",d:n})),n=this._linePath(s,"pass"),(n||""!=n)&&$("#line_pass").append($("<path>",{id:"line_pass_path",d:n}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("path#int2_sh_pass").attr("stroke","#aaa"),$("path#line_main_path").attr("fill",this._themeColour),$("path#line_pass_path").attr("fill","#aaa"),$("#line_shmetro_use").attr("fill",this._themeColour),this._lineNames[0].match(/(\d*)\w+/)?$("#station_info_shmetro > #line_number > text").attr("fill","#fff"):$("#station_info_shmetro > #line_name_text").attr("fill","#fff")}updateStnNameBg(){$("#current_bg").hide()}static initSVG(t){t.drawSVGFrame(),t.showFrameOuter(),t.drawStns(),t.drawLine(),t.fillThemeColour(),t.drawStrip(),t.drawDestInfo(),t.loadFonts(),t.updateStnNameBg()}set direction(t){super.direction=t,this.fillThemeColour()}set currentStnId(t){super.currentStnId=t,this.fillThemeColour()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),this.fillThemeColour(),$("#stn_icons").empty(),this.drawStns()}addStn(t,e,s,n){let[i,a]=super.addStn(t,e,s,n);return this.fillThemeColour(),[i,a]}set yPc(t){super.yPc=t;let e=t*this._svgHeight/50;$("g#main").attr("transform",`translate(0,${e})`)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJuYW1lRU5MbiIsIm5hbWUiLCJzcGxpdCIsImxlbmd0aCIsImR4IiwiX25hbWVTaGlmdCIsIl90aWNrUm90YXRpb24iLCJNYXRoIiwiY29zIiwiaWNvblR5cGUiLCJudW1DbGFzcyIsInN0YXRlIiwic3RhdGlvbl9pZCIsIiQiLCJ0cmFuc2Zvcm0iLCJ4IiwiYXBwZW5kIiwiY2xhc3MiLCJkeSIsIl9keGR5IiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiX2ludEluZm9zIiwiaW50ZXJjaGFuZ2UiLCJ1bmdycEhUTUwiLCJpY29uSFRNTCIsIm5hbWVIVE1MIiwiaW50VGlja0hUTUwiLCJzdHJva2UiLCJjb2xvdXIiLCJsaW5lRWxlbXMiLCJzdG5OYW1lRWxlbSIsImJjciIsImdldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0IiwibGVmdCIsIm1hcCIsInN0biIsImluZGV4IiwibGluZUljb25Db2xvdXIiLCJsaW5lSWNvbkVsZW0iLCJmaWxsIiwibGluZU51bWJlciIsIlN0cmluZyIsIm5hbWVaSCIsIm1hdGNoIiwibGluZU5hbWUiLCJsaW5lTmFtZUVsZW0iLCJmZyIsInB1c2giLCJzdG5JbmZvRWxlbSIsInBhcmVudCIsImF0dHIiLCJwYXJhbSIsInN0bklkIiwic3RuSW5mbyIsImNoYW5nZV90eXBlIiwiX3BsYXRmb3JtTnVtIiwiZmxhZ0xlbmd0aCIsIndpZHRoIiwiaXNMZWZ0IiwiX2RpcmVjdGlvbiIsImFycm93WCIsIl9zdmdEZXN0V2lkdGgiLCJhcnJvd1JvdGF0ZSIsInBsYXRmb3JtTnVtWCIsInR4dEFuY2hvciIsImRlc3ROYW1lWCIsImRlc3RpbmF0aW9uc196aCIsImRlc3RpbmF0aW9uc19lbiIsImZvckVhY2giLCJzdGF0aW9ucyIsImpvaW4iLCJsaW5lTmFtZVgiLCJsaW5lTmFtZVpIIiwibGluZU5hbWVFTiIsIl9saW5lTmFtZXMiLCJfdGhlbWVDb2xvdXIiLCJfZmdDb2xvdXIiLCJoaWRlIiwicGF0aCIsImQiLCJzdG5JbnN0YW5jZSIsIk9iamVjdCIsImVudHJpZXMiLCJpbmNsdWRlcyIsImh0bWwiLCJmaWx0ZXIiLCJ1bmdycEljb25IVE1MIiwiX3N0bkluZGVncmVlIiwiX3N0bk91dGRlZ3JlZSIsInN0blByZWQiLCJwYXJlbnRzIiwiX3N0bllTaGFyZSIsImNoaWxkcmVuIiwiaW5kZXhPZiIsInN0bklkcyIsInR5cGUiLCJwcmV2SWQiLCJwcmV2WSIsInByZXZYIiwiZSIsImZ1biIsImhhc093blByb3BlcnR5IiwieGIiLCJ5YiIsInhtIiwieW0iLCJoIiwicmVtb3ZlQ2xhc3MiLCJicmFuY2hlcyIsImJyYW5jaCIsImxpbmVNYWluU3RucyIsImxpbmVQYXNzU3RucyIsInVuc2hpZnQiLCJfbGluZVBhdGgiLCJmaWxsVGhlbWVDb2xvdXIiLCJsaW5lIiwiZHJhd1NWR0ZyYW1lIiwic2hvd0ZyYW1lT3V0ZXIiLCJkcmF3U3RucyIsImRyYXdMaW5lIiwiZHJhd1N0cmlwIiwiZHJhd0Rlc3RJbmZvIiwibG9hZEZvbnRzIiwidXBkYXRlU3RuTmFtZUJnIiwidmFsIiwiZGlyZWN0aW9uIiwiY3VycmVudFN0bklkIiwiaW5mbyIsInVwZGF0ZVN0blRyYW5zZmVyIiwiZW1wdHkiLCJwcmVwIiwibG9jIiwiZW5kIiwibmV3SWQiLCJuZXdJbmZvIiwiYWRkU3RuIiwieVBjIiwiX3N2Z0hlaWdodCJdLCJtYXBwaW5ncyI6ImtIQUtBLE1BQU0sVUFBcUIsSUFDdkIsWUFBWUEsRUFBUUMsR0FDaEJDLE1BQU1GLEVBQUlDLEdBQ1ZFLEtBQUtDLE9BQVNILEVBQUtJLElBR3ZCLGlCQUFtQixPQUFPLEVBQzFCLG9CQUFzQixPQUFPRixLQUFLRyxFQUFJLEVBQUksSUFBTSxFQUNoRCxZQUNJLElBQUlDLEVBQVdKLEtB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QixNQUFNLFlBRXpCakMsRUFBRSwrQ0FBK0N3QyxLQUFLLE9BQVEsUUFHOUR4QyxFQUFFLDJDQUEyQ3dDLEtBQUssT0FBUSxRQUlsRSxrQkFDSXhDLEVBQUUsZUFBZW1FLE9BSXJCLGVBQWVzQyxHQUNYQSxFQUFLQyxlQUNMRCxFQUFLRSxpQkFDTEYsRUFBS0csV0FHTEgsRUFBS0ksV0FDTEosRUFBS0Qsa0JBR0xDLEVBQUtLLFlBQ0xMLEVBQUtNLGVBQ0xOLEVBQUtPLFlBQ0xQLEVBQUtRLGtCQUlULGNBQWNDLEdBQ1ZwSSxNQUFNcUksVUFBWUQsRUFFbEJuSSxLQUFLeUgsa0JBSVQsaUJBQWlCVSxHQUNicEksTUFBTXNJLGFBQWVGLEVBRXJCbkksS0FBS3lILGtCQUlULGtCQUFrQjlELEVBQVcyQyxFQUFNZ0MsRUFBTyxNQUN0Q3ZJLE1BQU13SSxrQkFBa0I1RSxFQUFPMkMsRUFBTWdDLEdBRXJDdEksS0FBS3lILGtCQUdMeEcsRUFBRSxjQUFjdUgsUUFDaEJ4SSxLQUFLNkgsV0FJVCxPQUFPWSxFQUEwQjlFLEVBQVcrRSxFQUFLQyxHQUM3QyxJQUFLQyxFQUFPQyxHQUFXOUksTUFBTStJLE9BQU9MLEVBQU05RSxFQUFPK0UsRUFBS0MsR0FFdEQsT0FEQTNJLEtBQUt5SCxrQkFDRSxDQUFDbUIsRUFBT0MsR0FJbkIsUUFBUVYsR0FDSnBJLE1BQU1nSixJQUFNWixFQUVaLElBQUloSSxFQUFJZ0ksRUFBTW5JLEtBQUtnSixXQUFhLEdBQ2hDL0gsRUFBRSxVQUFVd0MsS0FBSyxZQUFhLGVBQWV0RCIsImZpbGUiOiJMaW5lU0gubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUk1HU3RhdGlvbiwgSW50SW5mb1RhZywgSW50ZXJjaGFuZ2VJbmZvIH0gZnJvbSAnLi9TdGF0aW9uJztcclxuaW1wb3J0IHsgSUQsIE5hbWUsIEJyYW5jaEluZm8sIFN0YXRpb25JbmZvIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5cclxuY29uc3Qgc3RhdGlvbl9pZCA9ICdzdG5fc2gnXHJcblxyXG5jbGFzcyBSTUdTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zdG5OdW0gPSBkYXRhLm51bTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgX25hbWVTaGlmdCgpIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICBnZXQgX3RpY2tSb3RhdGlvbigpIHsgcmV0dXJuIHRoaXMueSA+IDAgPyAxODAgOiAwOyB9XHJcbiAgICBnZXQgX2R4ZHkoKSB7XHJcbiAgICAgICAgdmFyIG5hbWVFTkxuID0gdGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJykubGVuZ3RoO1xyXG4gICAgICAgIGxldCBkeDogbnVtYmVyO1xyXG4gICAgICAgIGlmICh0aGlzLl9uYW1lU2hpZnQpIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAtOSA6IDE2ICsgKG5hbWVFTkxuIC0gMSkgKiAxMiAqIE1hdGguY29zKC00NSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoMjQgKyAobmFtZUVOTG4gLSAxKSAqIDEyKSAqIE1hdGguY29zKC00NSkgOiAtNjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbGV0IGR4ID0gdGhpcy5fbmFtZVNoaWZ0ID8gLTggOiAoMjQgKyAobmFtZUVOTG4tMSkqMTIpICogTWF0aC5jb3MoLTQ1KTtcclxuICAgICAgICBsZXQgZHkgPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoLTQgLSAyMS45MjE4NzUgLSAobmFtZUVOTG4gLSAxKSAqIDEyICogTWF0aC5jb3MoLTQ1KSkgOiAxNy41O1xyXG4gICAgICAgIC8vIHZhciBkeSA9ICgtNCAtIDIxLjkyMTg3NSAtIChuYW1lRU5Mbi0xKSoxMipNYXRoLmNvcygtNDUpKSAqICh0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAxIDogLTEpO1xyXG4gICAgICAgIHJldHVybiBbZHgsIGR5XVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpY29uSFRNTCgpIHtcclxuICAgICAgICB2YXIgW2ljb25UeXBlLCBudW1DbGFzc10gPSAodGhpcy5zdGF0ZSA9PSAtMSkgPyBbc3RhdGlvbl9pZCArICdfcGFzcycsICdQYXNzJ10gOiBbc3RhdGlvbl9pZCwgJ0Z1dHVyZSddO1xyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke3RoaXMueH0sJHt0aGlzLnl9KWAgfSlcclxuICAgICAgICAgICAgLmFwcGVuZCgkKCc8dXNlPicsIHsgJ3hsaW5rOmhyZWYnOiAnIycgKyBpY29uVHlwZSwgY2xhc3M6ICdybWctc3RuJyB9KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG5hbWVIVE1MKCkge1xyXG4gICAgICAgIGxldCBbZHgsIGR5XSA9IHRoaXMuX2R4ZHlcclxuICAgICAgICByZXR1cm4gJCgnPGc+Jywge1xyXG4gICAgICAgICAgICAndHJhbnNmb3JtJzogYHRyYW5zbGF0ZSgke3RoaXMueCAtIGR4fSwke3RoaXMueSArIGR5fSlyb3RhdGUoLTUwKWAsXHJcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICdzdGFydCcgOiAnZW5kJyxcclxuICAgICAgICAgICAgLy8gY2xhc3M6IGBOYW1lICR7dGhpcy5uYW1lQ2xhc3N9YFxyXG4gICAgICAgICAgICBjbGFzczogYE5hbWUgRnV0dXJlYCAgLy8gdG9kbzogZml4IHRoaXNcclxuICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgICQoJzx0ZXh0PicpLmFkZENsYXNzKCdybWctbmFtZV9femggcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nKS50ZXh0KHRoaXMubmFtZVswXSlcclxuICAgICAgICApLmFwcGVuZChcclxuICAgICAgICAgICAgJCgnPHRleHQ+Jywge1xyXG4gICAgICAgICAgICAgICAgZHk6IDE1LCBjbGFzczogJ3JtZy1uYW1lX19lbiBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbidcclxuICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVswXSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRzcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAneCc6IDAsICdkeSc6IDEyXHJcbiAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzFdKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgSW50U3RhdGlvblNIIGV4dGVuZHMgUk1HU3RhdGlvblNIIHtcclxuICAgIHByb3RlY3RlZCBfaW50SW5mb3M6IEludGVyY2hhbmdlSW5mb1tdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MgPSBkYXRhLmludGVyY2hhbmdlWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBhcHBlbmQgZG9tIGFuZCB0aGVuIGdldEJvdW5kaW5nQ2xpZW50UmVjdFxyXG4gICAgLy8gdG8gZ2V0IHRoZSBleGFjdCBwb3NpdGlvbiB3aGVyZSBpbnQgaWNvbiBjYW4gYmUgZml0XHJcbiAgICBnZXQgaHRtbCgpIHtcclxuICAgICAgICByZXR1cm4gJCgnPGc+JywgeyBpZDogdGhpcy5pZCB9KS5hcHBlbmQoLi4udGhpcy51bmdycEhUTUwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBnZXQgYWxsIGRyYXdpbmcgZnVuY3Rpb24gdG8gYmUgY2FsbGVkXHJcbiAgICBnZXQgdW5ncnBIVE1MKCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5pY29uSFRNTCwgdGhpcy5uYW1lSFRNTF07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHVuZ3JwSWNvbkhUTUwoKSB7XHJcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLmludFRpY2tIVE1MXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGludGVyY2hhbmdlIHN0YXRpb24gaWNvbiBvbiBtYWluIGxpbmVcclxuICAgIGdldCBpY29uSFRNTCgpIHtcclxuICAgICAgICB2YXIgW2ljb25UeXBlLCBudW1DbGFzc10gPSAodGhpcy5zdGF0ZSA9PSAtMSkgPyBbJ2ludDJfc2hfcGFzcycsICdQYXNzJ10gOiBbJ2ludDJfc2gnLCAnRnV0dXJlJ107XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54fSwke3RoaXMueX0pYCB9KVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzx1c2U+JywgeyAneGxpbms6aHJlZic6ICcjJyArIGljb25UeXBlLCBjbGFzczogJ3JtZy1zdG4nLCBzdHJva2U6IHRoaXMuX2ludEluZm9zW0ludEluZm9UYWcuY29sb3VyXSB9KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVndWxhciBzdGF0aW9uIG5hbWVcclxuICAgIGdldCBuYW1lSFRNTCgpIHtcclxuICAgICAgICBsZXQgW2R4LCBkeV0gPSB0aGlzLl9keGR5O1xyXG4gICAgICAgIC8vIHdyYXAgdGhlIG5hbWUsIGRlY3JvX2xpbmUgYW5kIGludF9saW5lIHVuZGVyIGcgaW4gb3JkZXIgdG8gcm90YXRlIGF0IG9uY2VcclxuICAgICAgICByZXR1cm4gJCgnPGc+Jywge1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHt0aGlzLnggLSBkeH0sJHt0aGlzLnkgKyBkeX0pYCwgIC8vcm90YXRlKC02MClcclxuICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBuYW1lIHRleHRcclxuICAgICAgICAgICAgJCgnPGc+Jywge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGBybWctbmFtZV9fc2htZXRyby0tJHt0aGlzLmlkfWAsXHJcbiAgICAgICAgICAgICAgICAndGV4dC1hbmNob3InOiB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAnc3RhcnQnIDogJ2VuZCcsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogYE5hbWUgRnV0dXJlYCAgLy8gdG9kbzogZml4IHRoaXNcclxuICAgICAgICAgICAgfSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRleHQ+JykuYWRkQ2xhc3MoJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbicpLnRleHQodGhpcy5uYW1lWzBdKVxyXG4gICAgICAgICAgICApLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICQoJzx0ZXh0PicsIHtcclxuICAgICAgICAgICAgICAgICAgICBkeTogMTUsIGNsYXNzOiAncm1nLW5hbWVfX2VuIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJ1xyXG4gICAgICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVswXSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICQoJzx0c3Bhbj4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd4JzogMCwgJ2R5JzogMTJcclxuICAgICAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzFdKVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGludGVyY2hhbmdlIHN0YXRpb24gaWNvbiBhZnRlciB0aGUgc3RhdGlvbiBuYW1lXHJcbiAgICBnZXQgaW50VGlja0hUTUwoKSB7XHJcbiAgICAgICAgbGV0IGxpbmVFbGVtczogSlF1ZXJ5PEhUTUxFbGVtZW50PltdID0gW11cclxuXHJcbiAgICAgICAgLy8gZ2V0IHRoZSBleGFjdCBzdGF0aW9uIG5hbWUgd2lkdGggc28gdGhhdCB0aGVcclxuICAgICAgICAvLyBpbnRlcmNoYW5nZSBzdGF0aW9uIGljb24gY2FuIGJlIHJpZ2h0IGFmdGVyIHRoZSBzdGF0aW9uIG5hbWVcclxuICAgICAgICBsZXQgc3RuTmFtZUVsZW0gPSAkKGAjcm1nLW5hbWVfX3NobWV0cm8tLSR7dGhpcy5pZH1gKVxyXG4gICAgICAgIGxldCBiY3IgPSBzdG5OYW1lRWxlbS5nZXQoMCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcclxuICAgICAgICBsZXQgZHggPSBiY3IucmlnaHQgLSBiY3IubGVmdCArIDVcclxuXHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MubWFwKChzdG4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGludGVyY2hhbmdlIGxpbmUgaWNvbiBhZnRlciBzdGF0aW9uIG5hbWVcclxuICAgICAgICAgICAgdmFyIGxpbmVJY29uQ29sb3VyID0gc3RuW0ludEluZm9UYWcuY29sb3VyXTtcclxuICAgICAgICAgICAgdmFyIGxpbmVJY29uRWxlbSA9ICQoJzx1c2U+Jywge1xyXG4gICAgICAgICAgICAgICAgJ3hsaW5rOmhyZWYnOiAnI2ludF9zaCcsXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBsaW5lSWNvbkNvbG91cixcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4ICsgaW5kZXggKiAyNX0sLTEyKWAsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3JtZy1saW5lX19zaG1ldHJvIHJtZy1saW5lX19jaGFuZ2UnLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGxpbmVJY29uRWxlbS5hZGRDbGFzcygncm1nLWxpbmVfX3Bhc3MnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gbGluZSBzdGFydHMgd2l0aCBudW1iZXJzIG9yIGxldHRlcnNcclxuICAgICAgICAgICAgbGV0IGxpbmVOdW1iZXIgPSBTdHJpbmcoc3RuW0ludEluZm9UYWcubmFtZVpIXSkubWF0Y2goLyhcXGQqKVxcdysvKVxyXG4gICAgICAgICAgICBpZiAobGluZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmVOYW1lID0gbGluZU51bWJlclswXVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmVOYW1lID0gU3RyaW5nKHN0bltJbnRJbmZvVGFnLm5hbWVaSF0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gaW50ZXJjaGFuZ2UgbGluZSBuYW1lXHJcbiAgICAgICAgICAgIHZhciBsaW5lTmFtZUVsZW0gPSAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICAvLyBUb2RvOiBmaXggdGhpcyBoYXJkLWNvZGVkIGNlbnRlcigxMCkgcG9zaXRpb25cclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4ICsgMTAgKyBpbmRleCAqIDI1fSw4KWAsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tbGluZV9uYW1lJyxcclxuICAgICAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICdtaWRkbGUnLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogc3RuW0ludEluZm9UYWcuZmddLFxyXG4gICAgICAgICAgICB9KS50ZXh0KGxpbmVOYW1lKVxyXG5cclxuICAgICAgICAgICAgbGluZUVsZW1zLnB1c2gobGluZUljb25FbGVtLCBsaW5lTmFtZUVsZW0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gcm90YXRlIHRoZSBzdGF0aW9uIGluZm8gbm93XHJcbiAgICAgICAgLy8gb3RoZXIgd2lzZSB0aGUgYmNyIHdpbGwgYmUgaW5hY2N1cmF0ZSBkdWUgdG8gdGhlIHJvdGF0aW9uXHJcbiAgICAgICAgbGV0IHN0bkluZm9FbGVtID0gc3RuTmFtZUVsZW0ucGFyZW50KCk7XHJcbiAgICAgICAgc3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJywgYCR7c3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJyl9cm90YXRlKC01MClgKVxyXG5cclxuICAgICAgICByZXR1cm4gbGluZUVsZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZUNsYXNzKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PSAtMSkgPyAnUGFzcycgOiAnRnV0dXJlJztcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgUk1HU3RhdGlvblNILCBJbnRTdGF0aW9uU0gsIHN0YXRpb25faWQgfTtcclxuIiwiaW1wb3J0IHsgUk1HTGluZSB9IGZyb20gJy4vTGluZSc7XHJcbmltcG9ydCB7IFJNR1N0YXRpb25TSCwgSW50U3RhdGlvblNILCBzdGF0aW9uX2lkIH0gZnJvbSAnLi4vU3RhdGlvbi9TdGF0aW9uU0gnO1xyXG5pbXBvcnQgeyBSTUdTdGF0aW9uIH0gZnJvbSAnLi4vU3RhdGlvbi9TdGF0aW9uJztcclxuXHJcbmltcG9ydCB7IElELCBOYW1lLCBTdGF0aW9uSW5mbywgUk1HUGFyYW0sIHNldFBhcmFtcyB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSTUdMaW5lU0ggZXh0ZW5kcyBSTUdMaW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtKSB7XHJcbiAgICAgICAgc3VwZXIocGFyYW0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0U3RuSW5zdGFuY2Uoc3RuSWQ6IElELCBzdG5JbmZvOiBTdGF0aW9uSW5mbyk6IFJNR1N0YXRpb24ge1xyXG4gICAgICAgIHN3aXRjaCAoc3RuSW5mby5jaGFuZ2VfdHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdpbnQyJzpcclxuICAgICAgICAgICAgY2FzZSAnaW50M19sJzpcclxuICAgICAgICAgICAgY2FzZSAnaW50M19yJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW50U3RhdGlvblNIKHN0bklkLCBzdG5JbmZvKTtcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTFfdWwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMV9wbCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTExX3VyJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTFfcHInOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMl91bCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTEyX3BsJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTJfdXInOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMl9wcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIxX3VsJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjFfcGwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kyMV91cic6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIxX3ByJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjJfdWwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kyMl9wbCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIyX3VyJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjJfcHInOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSTUdTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBkcmF3IHRoZSBkZXN0aW5hdGlvblxyXG4gICAgZHJhd0Rlc3RJbmZvKCkge1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNwbGF0Zm9ybSA+IHRleHQnKS50ZXh0KHRoaXMuX3BsYXRmb3JtTnVtKTtcclxuXHJcbiAgICAgICAgdmFyIGJjciA9ICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQnKVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgZmxhZ0xlbmd0aCA9IDE2MCArIDE1MCArIGJjci53aWR0aCArIDQ1ICsgNTA7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8gYXJyb3dcclxuICAgICAgICB2YXIgaXNMZWZ0ID0gKHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcpID8gMSA6IC0xO1xyXG4gICAgICAgIHZhciBhcnJvd1ggPSAodGhpcy5fc3ZnRGVzdFdpZHRoIC0gaXNMZWZ0ICogZmxhZ0xlbmd0aCkgLyAyMDtcclxuICAgICAgICBhcnJvd1ggPSAodGhpcy5fZGlyZWN0aW9uID09ICdsJykgPyBhcnJvd1ggOiB0aGlzLl9zdmdEZXN0V2lkdGggLSAyMDtcclxuICAgICAgICB2YXIgYXJyb3dSb3RhdGUgPSA5MCAqICgxIC0gaXNMZWZ0KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjYXJyb3dfbGVmdF91c2UnKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7YXJyb3dYfSwxMzUpcm90YXRlKCR7YXJyb3dSb3RhdGV9KWApO1xyXG5cclxuICAgICAgICAvLyBub3QgaW4gdXNlIG5vd1xyXG4gICAgICAgIHZhciBwbGF0Zm9ybU51bVggPSBhcnJvd1ggKyBpc0xlZnQgKiAoMTYwICsgNTAgKyA3NSk7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI3BsYXRmb3JtJykuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke3BsYXRmb3JtTnVtWH0sMTMwKWApO1xyXG5cclxuICAgICAgICAvLyBsaXN0IHRoZSBkZXN0aW5hdGlvbiB0ZXh0XHJcbiAgICAgICAgLy8gVG9kbzogZml4IHN2Z19kZXN0X3dpZHRoKjAuOCwgdGhpcyBoYXMgb25seSBiZWVuIHRlc3RlZCBvbiAxMDAwIHdpZHRoXHJcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgIHZhciB0eHRBbmNob3IgPSAnZW5kJztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuODtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdHh0QW5jaG9yID0gJ3N0YXJ0JztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCcpLmF0dHIoe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtkZXN0TmFtZVh9LDEzNSlgLFxyXG4gICAgICAgICAgICAndGV4dC1hbmNob3InOiB0eHRBbmNob3JcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gZm9yIGVhY2ggbGVmdCB2YWxpZCBkZXN0aW5hdGlvbnMsIGdldCB0aGUgbmFtZSBmcm9tIGlkXHJcbiAgICAgICAgdmFyIFtkZXN0aW5hdGlvbnNfemgsIGRlc3RpbmF0aW9uc19lbl06IFN0cmluZ1tdW10gPSBbW10sIFtdXVxyXG4gICAgICAgIHRoaXNbYCR7dGhpcy5fZGlyZWN0aW9ufVZhbGlkRGVzdHNgXS5mb3JFYWNoKHN0biA9PiB7XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uc196aC5wdXNoKHRoaXMuc3RhdGlvbnNbc3RuXS5uYW1lWzBdKVxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNfZW4ucHVzaCh0aGlzLnN0YXRpb25zW3N0bl0ubmFtZVsxXSlcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQoYOW+gCR7ZGVzdGluYXRpb25zX3poLmpvaW4oXCLvvIxcIil9YClcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykudGV4dChgVG8gJHtkZXN0aW5hdGlvbnNfZW4uam9pbihcIiwgXCIpfWApXHJcblxyXG4gICAgICAgIC8vIHByZXBhcmUgZm9yIHRoZSBsaW5lIG5hbWVcclxuICAgICAgICBsZXQgbGluZU5hbWVYID0gdGhpcy5fZGlyZWN0aW9uID09PSAnbCcgPyB0aGlzLl9zdmdEZXN0V2lkdGggOiAzMjBcclxuICAgICAgICB2YXIgW2xpbmVOYW1lWkgsIGxpbmVOYW1lRU5dID0gdGhpcy5fbGluZU5hbWVzO1xyXG5cclxuICAgICAgICAvLyBsaW5lIHN0YXJ0cyB3aXRoIG51bWJlcnMgb3IgbGV0dGVyc1xyXG4gICAgICAgIHZhciBsaW5lTnVtYmVyID0gbGluZU5hbWVaSC5tYXRjaCgvKFxcZCopXFx3Ky8pXHJcbiAgICAgICAgaWYgKGxpbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgbGluZU5hbWVYIC09IDE4MDtcclxuICAgICAgICAgICAgbGluZU5hbWVaSCA9IFwi5Y+357q/XCJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gcmVjdCcpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgJ3N0eWxlJzogYGZpbGw6JHt0aGlzLl90aGVtZUNvbG91cn1gLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMjB9LDcwKWBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpXHJcbiAgICAgICAgICAgICAgICAudGV4dChsaW5lTnVtYmVyWzBdKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYIC0gNzB9LDE3MClgLFxyXG4gICAgICAgICAgICAgICAgICAgICdmaWxsJzogdGhpcy5fZmdDb2xvdXIsXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxpbmVOYW1lWCAtPSAyODA7XHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHJlY3QnKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICdzdHlsZSc6IGBmaWxsOiR7dGhpcy5fdGhlbWVDb2xvdXJ9YCxcclxuICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYIC0gMTB9LDYwKWAsXHJcbiAgICAgICAgICAgICAgICAnd2lkdGgnOiAyNjAsXHJcbiAgICAgICAgICAgICAgICAnaGVpZ2h0JzogMTUwXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHRleHQnKS5oaWRlKClcclxuXHJcbiAgICAgICAgICAgIC8vIFRvZG86IHNldCB0aGUgZW5nIGluIHRoZSBtaWRkbGVcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykuYXR0cignZHgnLCAxMClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNldCB0aGUgbGluZSBuYW1lXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQobGluZU5hbWVaSClcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0Omxhc3QtY2hpbGQnKS50ZXh0KGxpbmVOYW1lRU4pXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0JykuYXR0cih7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2xpbmVOYW1lWH0sMTM1KWAsXHJcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICdzdGFydCdcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gdGhlIGxhc3QgZGVjb3JhdGlvbiBsaW5lXHJcbiAgICAgICAgbGV0IHBhdGggPSAnJ1xyXG4gICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT0gJ2wnKSB7XHJcbiAgICAgICAgICAgIHBhdGggPSBgTTMwLDEwIEggJHt0aGlzLl9zdmdEZXN0V2lkdGggLSAyMH0gViAyMCBIIDIwIFpgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcGF0aCA9IGBNMjAsMTAgSCAke3RoaXMuX3N2Z0Rlc3RXaWR0aCAtIDMwfSBsIDEwLDEwIEggMjAgWmBcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI2xpbmVfc2htZXRyb191c2UnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDAsMjIwKWAsXHJcbiAgICAgICAgICAgIGQ6IHBhdGgsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gYXBwZW5kIGRvbSBhbmQgdGhlbiBnZXRCb3VuZGluZ0NsaWVudFJlY3RcclxuICAgIC8vIHRvIGdldCB0aGUgZXhhY3QgcG9zaXRpb24gd2hlcmUgaW50IGljb24gY2FuIGJlIGZpdFxyXG4gICAgZHJhd1N0bnMoKSB7XHJcbiAgICAgICAgZm9yIChsZXQgW3N0bklkLCBzdG5JbnN0YW5jZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aW9ucykpIHtcclxuICAgICAgICAgICAgaWYgKFsnbGluZXN0YXJ0JywgJ2xpbmVlbmQnXS5pbmNsdWRlcyhzdG5JZCkpIHsgY29udGludWU7IH1cclxuICAgICAgICAgICAgJCgnI3N0bl9pY29ucycpLmFwcGVuZChzdG5JbnN0YW5jZS5odG1sKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0bl9pY29ucycpLmh0bWwoJCgnI3N0bl9pY29ucycpLmh0bWwoKSk7IC8vIFJlZnJlc2ggRE9NXHJcblxyXG4gICAgICAgIGZvciAobGV0IFtzdG5JZCwgc3RuSW5zdGFuY2VdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuc3RhdGlvbnMpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoc3RuID0+IHN0blsxXSBpbnN0YW5jZW9mIEludFN0YXRpb25TSCkgYXMgW0lELCBJbnRTdGF0aW9uU0hdW10pIHtcclxuICAgICAgICAgICAgJChgI3JtZy1uYW1lX19zaG1ldHJvLS0ke3N0bklkfWApLnBhcmVudCgpLmFwcGVuZChzdG5JbnN0YW5jZS51bmdycEljb25IVE1MKVxyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjc3RuX2ljb25zJykuaHRtbCgkKCcjc3RuX2ljb25zJykuaHRtbCgpKTsgLy8gUmVmcmVzaCBET01cclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2hhbmdlIHRoZSB5IG9mIGJyYW5jaCBzdGF0aW9uXHJcbiAgICBfc3RuWVNoYXJlKHN0bklkKTogbnVtYmVyIHtcclxuICAgICAgICBpZiAoWydsaW5lc3RhcnQnLCAnbGluZWVuZCddLmluY2x1ZGVzKHN0bklkKSB8fCB0aGlzLl9zdG5JbmRlZ3JlZShzdG5JZCkgPiAxIHx8IHRoaXMuX3N0bk91dGRlZ3JlZShzdG5JZCkgPiAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3RuUHJlZCA9IHRoaXMuc3RhdGlvbnNbc3RuSWRdLnBhcmVudHNbMF07XHJcbiAgICAgICAgaWYgKHN0blByZWQpIHtcclxuICAgICAgICAgICAgLy8gcGFyZW50IGV4aXN0XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdG5PdXRkZWdyZWUoc3RuUHJlZCkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gbm8gc2libGluZywgdGhlbiB5IHNhbWUgYXMgcGFyZW50XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RuWVNoYXJlKHN0blByZWQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gc2libGluZyBleGlzdHMsIHRoZW4geSBkZXBlbmRzIG9uIGl0cyBpZHggb2YgYmVpbmcgY2hpbGRyZW5cclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZXdyaXRlIHRoaXMgdG8gbW92ZSB0aGUgbWFpbiBsaW5lIG9uIHRoZSBzYW1lIGhlaWdodCBvZiB0aGUgcmVzdFxyXG4gICAgICAgICAgICAgICAgLy8gYW5kIGJyYW5jaCBhIGJpdCBhd2F5IGZyb20gdGhlIG1haW4gbGluZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLnN0YXRpb25zW3N0blByZWRdLmNoaWxkcmVuLmluZGV4T2Yoc3RuSWQpID09IDApID8gMyA6IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBubyBwYXJlbnQsIG11c3QgYmUgbGluZXN0YXJ0XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfbGluZVBhdGgoc3RuSWRzOiBJRFtdLCB0eXBlPzogJ21haW4nIHwgJ3Bhc3MnKTogc3RyaW5nIHtcclxuICAgICAgICB2YXIgW3ByZXZJZCwgcHJldlksIHByZXZYXTogW3N0cmluZz8sIG51bWJlcj8sIG51bWJlcj9dID0gW11cclxuICAgICAgICB2YXIgcGF0aDogeyBba2V5OiBzdHJpbmddOiBudW1iZXJbXSB9ID0ge31cclxuICAgICAgICBjb25zdCBlID0gMzBcclxuXHJcbiAgICAgICAgc3RuSWRzLmZvckVhY2goc3RuSWQgPT4ge1xyXG4gICAgICAgICAgICB2YXIgW3gsIHldID0gWydfc3RuUmVhbFgnLCAnX3N0blJlYWxZJ10ubWFwKGZ1biA9PiB0aGlzW2Z1bl0oc3RuSWQpKVxyXG4gICAgICAgICAgICBpZiAoIXByZXZZICYmIHByZXZZICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBbcHJldklkLCBwcmV2WCwgcHJldlldID0gW3N0bklkLCB4LCB5XTtcclxuICAgICAgICAgICAgICAgIHBhdGhbJ3N0YXJ0J10gPSBbeCwgeV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoeSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbWVyZ2UgYmFjayB0byBtYWluIGxpbmVcclxuICAgICAgICAgICAgICAgIGlmICh5ICE9IHByZXZZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aFsnYmlmdXJjYXRlJ10gPSBbcHJldlgsIHByZXZZXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gb24gdGhlIGJyYW5jaCBsaW5lXHJcbiAgICAgICAgICAgICAgICBpZiAoeSAhPSBwcmV2WSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGhbJ2JpZnVyY2F0ZSddID0gW3gsIHldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGF0aFsnZW5kJ10gPSBbeCwgeV07XHJcbiAgICAgICAgICAgIFtwcmV2SWQsIHByZXZYLCBwcmV2WV0gPSBbc3RuSWQsIHgsIHldO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBnZW5lcmF0ZSBwYXRoXHJcbiAgICAgICAgaWYgKCFwYXRoLmhhc093blByb3BlcnR5KCdzdGFydCcpKSB7XHJcbiAgICAgICAgICAgIC8vIG5vIGxpbmUgZ2VuZXJhdGVkXHJcbiAgICAgICAgICAgIC8vIGtleXMgaW4gcGF0aDogbm9uZVxyXG4gICAgICAgICAgICByZXR1cm4gJydcclxuICAgICAgICB9IGVsc2UgaWYgKCFwYXRoLmhhc093blByb3BlcnR5KCdlbmQnKSkge1xyXG4gICAgICAgICAgICAvLyBsaXR0ZSBsaW5lIChvbmx5IGJleW9uZCB0ZXJtaW5hbCBzdGF0aW9uKVxyXG4gICAgICAgICAgICAvLyBrZXlzIGluIHBhdGg6IHN0YXJ0XHJcbiAgICAgICAgICAgIGxldCBbeCwgeV0gPSBwYXRoWydzdGFydCddXHJcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnbWFpbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgYXQgdGVybWluYWwoZW5kKSBzdGF0aW9uLCBkcmF3IHRoZSBsaXR0ZSBtYWluIGxpbmVcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3h9LCR7eSAtIDZ9IEwgJHt4IC0gZX0sJHt5IC0gNn0gbCAtMTIsMTIgTCAke3h9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3h9LCR7eSAtIDZ9IEwgJHt4ICsgZX0sJHt5IC0gNn0gbCAxMiwxMiBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHR5cGUgPT09ICdwYXNzJ1xyXG4gICAgICAgICAgICAgICAgLy8gY3VycmVudCBhdCB0ZXJtaW5hbChzdGFydCkgc3RhdGlvbiwgZHJhdyB0aGUgbGl0dGUgcGFzcyBsaW5lXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4fSwke3kgLSA2fSBMICR7eCArIGV9LCR7eSAtIDZ9IGwgMCwxMiBMICR7eCAtIGV9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3ggLSBlfSwke3kgLSA2fSBMICR7eH0sJHt5IC0gNn0gbCAwLDEyIEwgJHt4IC0gZX0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghcGF0aC5oYXNPd25Qcm9wZXJ0eSgnYmlmdXJjYXRlJykpIHtcclxuICAgICAgICAgICAgLy8gZ2VuZXJhbCBtYWluIGxpbmVcclxuICAgICAgICAgICAgLy8ga2V5cyBpbiBwYXRoOiBzdGFydCwgZW5kXHJcbiAgICAgICAgICAgIGxldCBbeCwgeV0gPSBwYXRoWydzdGFydCddLCBoID0gcGF0aFsnZW5kJ11bMF1cclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdtYWluJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2wnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eCAtIGV9LCR7eSAtIDZ9IEggJHtofSBsIDAsMTIgTCAke3ggLSA0Mn0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eH0sJHt5IC0gNn0gSCAke2ggKyBlfSBsIDEyLDEyIEwgJHt4fSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gdHlwZSA9PT0gJ3Bhc3MnXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4IC0gZX0sJHt5IC0gNn0gSCAke2ggKyBlfSBsIDAsMTIgTCAke3ggLSBlfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4IC0gZX0sJHt5IC0gNn0gSCAke2ggKyBlfSBsIDAsMTIgTCAke3ggLSBlfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gbWFpbiBsaW5lIGJpZnVyY2F0ZSBoZXJlIHRvIGJlY29tZSB0aGUgYnJhbmNoIGxpbmVcclxuICAgICAgICAgICAgLy8gYW5kIHBhdGggcmV0dXJuIGhlcmUgYXJlIG9ubHkgYnJhbmNoIGxpbmVcclxuICAgICAgICAgICAgLy8ga2V5cyBpbiBwYXRoOiBzdGFydCwgYmlmdXJjYXRlLCBlbmRcclxuXHJcbiAgICAgICAgICAgIC8vIFRvZG86IGRpc2FibGUgbG93ZXIgYnJhbmNoXHJcbiAgICAgICAgICAgIGxldCBbeCwgeV0gPSBwYXRoWydzdGFydCddLCBoID0gcGF0aFsnZW5kJ11bMF1cclxuICAgICAgICAgICAgbGV0IFt4YiwgeWJdID0gcGF0aFsnYmlmdXJjYXRlJ10sIFt4bSwgeW1dID0gcGF0aFsnZW5kJ11cclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdtYWluJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2wnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHltID4geSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWluIGxpbmUsIGxlZnQgZGlyZWN0aW9uLCBjZW50ZXIgdG8gdXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eCAtIGV9LCR7eSAtIDZ9IEggJHt4YiArIGV9IEwgJHt4bX0sJHt5bSAtIDZ9IGwgMCwxMiBMICR7eGIgKyBlfSwke3liICsgNn0gTCAke3ggLSBlIC0gMTJ9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFpbiBsaW5lLCBsZWZ0IGRpcmVjdGlvbiwgdXBwZXIgdG8gY2VudGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgc2FtZSBhcyB0aGUgb3RoZXIsIGJ1dCByZXBsYWNlIHggd2l0aCB4bSBhbmQgeG0gd2l0aCB4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3htfSwke3ltIC0gNn0gSCAke3hiIC0gZX0gTCAke3h9LCR7eSAtIDZ9IGwgMCwxMiBMICR7eGIgLSBlfSwke3liICsgNn0gTCAke3htfSwke3ltICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5bSA+IHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFpbiBsaW5lLCByaWdodCBkaXJlY3Rpb24sIHVwcGVyIHRvIGNlbnRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4fSwke3kgLSA2fSBIICR7eGIgKyBlfSBMICR7eG19LCR7eW0gLSA2fSBsIDAsMTIgTCAke3hiICsgZX0sJHt5YiArIDZ9IEwgJHt4fSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1haW4gbGluZSwgcmlnaHQgZGlyZWN0aW9uLCBjZW50ZXIgdG8gdXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBzYW1lIGFzIHRoZSBvdGhlciwgYnV0IHJlcGxhY2UgeCB3aXRoIHhtIGFuZCB4bSB3aXRoIHhcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eG0gKyBlfSwke3ltIC0gNn0gSCAke3hiIC0gZX0gTCAke3h9LCR7eSAtIDZ9IGwgMCwxMiBMICR7eGIgLSBlfSwke3liICsgNn0gTCAke3htICsgZSArIDEyfSwke3ltICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0eXBlID09PSAncGFzcydcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5bSA+IHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGFzcyBsaW5lLCBsZWZ0IGRpcmVjdGlvbiwgY2VudGVyIHRvIHVwcGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3ggLSBlfSwke3kgLSA2fSBIICR7eGIgKyBlfSBMICR7eG19LCR7eW0gLSA2fSBsIDAsMTIgTCAke3hiICsgZX0sJHt5YiArIDZ9IEwgJHt4IC0gZX0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwYXNzIGxpbmUsIGxlZnQgZGlyZWN0aW9uLCB1cHBlciB0byBjZW50ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBzYW1lIGFzIHRoZSBvdGhlciwgYnV0IHJlcGxhY2UgeCB3aXRoIHhtIGFuZCB4bSB3aXRoIHhcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eH0sJHt5IC0gNn0gTCAke3hiIC0gZX0sJHt5YiAtIDZ9IEggJHt4bSArIGV9IGwgMCwxMiBMICR7eGIgLSBlfSwke3liICsgNn0gTCAke3h9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeW0gPiB5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhc3MgbGluZSwgcmlnaHQgZGlyZWN0aW9uLCB1cHBlciB0byBjZW50ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eCAtIGV9LCR7eSAtIDZ9IEggJHt4YiArIGV9IEwgJHt4bX0sJHt5bSAtIDZ9IGwgMCwxMiBMICR7eGIgKyBlfSwke3liICsgNn0gTCAke3ggLSBlfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhc3MgbGluZSwgcmlnaHQgZGlyZWN0aW9uLCBjZW50ZXIgdG8gdXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBzYW1lIGFzIHRoZSBvdGhlciwgYnV0IHJlcGxhY2UgeCB3aXRoIHhtIGFuZCB4bSB3aXRoIHhcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eH0sJHt5IC0gNn0gTCAke3hiIC0gZX0sJHt5YiAtIDZ9IEggJHt4bSArIGV9IGwgMCwxMiBMICR7eGIgLSBlfSwke3liICsgNn0gTCAke3h9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGRyYXcgdGhlIGxpbmUgaW4gcmFpbG1hcFxyXG4gICAgZHJhd0xpbmUoKSB7XHJcbiAgICAgICAgJCgnLnJtZy1saW5lJykucmVtb3ZlQ2xhc3MoJ3JtZy1saW5lX19tdHInKS5hZGRDbGFzcygncm1nLWxpbmVfX3NobWV0cm8nKTtcclxuXHJcbiAgICAgICAgdGhpcy5icmFuY2hlcy5tYXAoYnJhbmNoID0+IHtcclxuICAgICAgICAgICAgdmFyIGxpbmVNYWluU3RucyA9IGJyYW5jaC5maWx0ZXIoc3RuSWQgPT4gdGhpcy5zdGF0aW9uc1tzdG5JZF0uc3RhdGUgPj0gMCk7XHJcbiAgICAgICAgICAgIHZhciBsaW5lUGFzc1N0bnMgPSBicmFuY2guZmlsdGVyKHN0bklkID0+IHRoaXMuc3RhdGlvbnNbc3RuSWRdLnN0YXRlIDw9IDApO1xyXG5cclxuICAgICAgICAgICAgaWYgKGxpbmVNYWluU3Rucy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIGxpbmVQYXNzU3RucyA9IGJyYW5jaDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGxpbmVNYWluU3Rucy5maWx0ZXIoc3RuSWQgPT4gbGluZVBhc3NTdG5zLmluZGV4T2Yoc3RuSWQpICE9PSAtMSkubGVuZ3RoID09IDAgJiYgbGluZU1haW5TdG5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgdHdvIHNldCBkaXNqb2ludFxyXG4gICAgICAgICAgICAgICAgaWYgKGxpbmVQYXNzU3Ruc1swXSA9PT0gYnJhbmNoWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gLTEgLTEgMSAxXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zLnB1c2gobGluZU1haW5TdG5zWzBdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZU1haW5TdG5zWzBdID09PSBicmFuY2hbMF0gJiYgbGluZU1haW5TdG5zW2xpbmVNYWluU3Rucy5sZW5ndGggLSAxXSA9PT0gYnJhbmNoW2JyYW5jaC5sZW5ndGggLSAxXSAmJiBsaW5lUGFzc1N0bnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zID0gYnJhbmNoO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVNYWluU3RucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAxIDEgLTEgLTFcclxuICAgICAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMudW5zaGlmdChsaW5lTWFpblN0bnNbbGluZU1haW5TdG5zLmxlbmd0aCAtIDFdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZHJhdyB0aGUgbWFpbiBsaW5lXHJcbiAgICAgICAgICAgIGxldCBwYXRoID0gdGhpcy5fbGluZVBhdGgobGluZU1haW5TdG5zLCAnbWFpbicpXHJcbiAgICAgICAgICAgIGlmIChwYXRoIHx8IHBhdGggIT0gJycpIHtcclxuICAgICAgICAgICAgICAgICQoJyNsaW5lX21haW4nKS5hcHBlbmQoJCgnPHBhdGg+JywgeyBpZDogJ2xpbmVfbWFpbl9wYXRoJywgZDogcGF0aCB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIHBhc3MgbGluZVxyXG4gICAgICAgICAgICBwYXRoID0gdGhpcy5fbGluZVBhdGgobGluZVBhc3NTdG5zLCAncGFzcycpXHJcbiAgICAgICAgICAgIGlmIChwYXRoIHx8IHBhdGggIT0gJycpIHtcclxuICAgICAgICAgICAgICAgICQoJyNsaW5lX3Bhc3MnKS5hcHBlbmQoJCgnPHBhdGg+JywgeyBpZDogJ2xpbmVfcGFzc19wYXRoJywgZDogcGF0aCB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJCgnI2xpbmVfbWFpbicpLmh0bWwoJCgnI2xpbmVfbWFpbicpLmh0bWwoKSk7XHJcbiAgICAgICAgJCgnI2xpbmVfcGFzcycpLmh0bWwoJCgnI2xpbmVfcGFzcycpLmh0bWwoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZmlsbFRoZW1lQ29sb3VyKCkge1xyXG4gICAgICAgIHN1cGVyLmZpbGxUaGVtZUNvbG91cigpO1xyXG5cclxuICAgICAgICAvLyB0aGlzIHdpbGwgYWRkIHRoZSBzdHJva2Ugb2YgdGhlIHN0YXRpb24gY2lyY2xlXHJcbiAgICAgICAgLy8gaG93ZXZlciB0aGUgc3Ryb2tlIHBhdGggaXMgZGVmaW5lZCBpbiBpbmRleC5odG1sXHJcbiAgICAgICAgLy8gd2hpY2ggbWFkZSBjaGFuZ2luZyBzdGF0aW9uIHN0eWxlIHN0cmFuZ2VcclxuICAgICAgICAkKCdwYXRoIycgKyBzdGF0aW9uX2lkKS5hdHRyKCdzdHJva2UnLCB0aGlzLl90aGVtZUNvbG91cik7XHJcbiAgICAgICAgJCgncGF0aCNpbnQyX3NoJykuYXR0cignc3Ryb2tlJywgdGhpcy5fdGhlbWVDb2xvdXIpO1xyXG5cclxuICAgICAgICAvLyBwYXNzIHN0cm9rZSBzaG91bGQgYmUgYWRkZWQgc29tZXdoZXJlIGVsc2VcclxuICAgICAgICAvLyBidXQgSSBjYW4ndCBmaWd1cmUgaXQgb3V0XHJcbiAgICAgICAgJCgncGF0aCNzdG5fc2hfcGFzcycpLmF0dHIoJ3N0cm9rZScsICcjYWFhJyk7XHJcbiAgICAgICAgJCgncGF0aCNpbnQyX3NoX3Bhc3MnKS5hdHRyKCdzdHJva2UnLCAnI2FhYScpO1xyXG5cclxuICAgICAgICAvLyB0aGUgcmFpbG1hcCBsaW5lXHJcbiAgICAgICAgJCgncGF0aCNsaW5lX21haW5fcGF0aCcpLmF0dHIoJ2ZpbGwnLCB0aGlzLl90aGVtZUNvbG91cilcclxuICAgICAgICAkKCdwYXRoI2xpbmVfcGFzc19wYXRoJykuYXR0cignZmlsbCcsICcjYWFhJylcclxuXHJcbiAgICAgICAgLy8gdGhlIGxhc3QgZGVjb3JhdGlvbiBsaW5lXHJcbiAgICAgICAgJChgI2xpbmVfc2htZXRyb191c2VgKS5hdHRyKCdmaWxsJywgdGhpcy5fdGhlbWVDb2xvdXIpXHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9saW5lTmFtZXNbMF0ubWF0Y2goLyhcXGQqKVxcdysvKSkge1xyXG4gICAgICAgICAgICAvLyB0aGUgbGluZSBzdGFydHMgd2l0aCBudW1iZXJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhlIGxpbmUgc3RhcnRzIHdpdGggbGV0dGVyXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVN0bk5hbWVCZygpIHtcclxuICAgICAgICAkKCcjY3VycmVudF9iZycpLmhpZGUoKTsgIC8vIGZpeCB0aGUgbXlzdGVyaW91cyBibGFjayByZWN0XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIG1ha2Ugc3VyZSB0aGUgbGluZSBpcyBkcmF3IGJlZm9yZSBjb2xvclxyXG4gICAgc3RhdGljIGluaXRTVkcobGluZSkge1xyXG4gICAgICAgIGxpbmUuZHJhd1NWR0ZyYW1lKCk7XHJcbiAgICAgICAgbGluZS5zaG93RnJhbWVPdXRlcigpO1xyXG4gICAgICAgIGxpbmUuZHJhd1N0bnMoKTtcclxuXHJcbiAgICAgICAgLy8gY2hhbmdlIHRoZSBmdW5jIGNhbGwgaGVyZVxyXG4gICAgICAgIGxpbmUuZHJhd0xpbmUoKTtcclxuICAgICAgICBsaW5lLmZpbGxUaGVtZUNvbG91cigpO1xyXG4gICAgICAgIC8vIGNoYW5nZSB0aGUgZnVuYyBjYWxsIGhlcmVcclxuXHJcbiAgICAgICAgbGluZS5kcmF3U3RyaXAoKTtcclxuICAgICAgICBsaW5lLmRyYXdEZXN0SW5mbygpO1xyXG4gICAgICAgIGxpbmUubG9hZEZvbnRzKCk7XHJcbiAgICAgICAgbGluZS51cGRhdGVTdG5OYW1lQmcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2FsbCBmaWxsVGhlbWVDb2xvdXIgd2hlbiBmbGlwIGRpcmVjdGlvblxyXG4gICAgc2V0IGRpcmVjdGlvbih2YWwpIHtcclxuICAgICAgICBzdXBlci5kaXJlY3Rpb24gPSB2YWxcclxuXHJcbiAgICAgICAgdGhpcy5maWxsVGhlbWVDb2xvdXIoKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBjYWxsIGZpbGxUaGVtZUNvbG91ciB3aGVuIHNldCBjdXJyZW50IHN0YXRpb25cclxuICAgIHNldCBjdXJyZW50U3RuSWQodmFsKSB7XHJcbiAgICAgICAgc3VwZXIuY3VycmVudFN0bklkID0gdmFsXHJcblxyXG4gICAgICAgIHRoaXMuZmlsbFRoZW1lQ29sb3VyKClcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gZ2V0IGRyYXdTdG5zIGFuZCByZWNhbGxlZFxyXG4gICAgdXBkYXRlU3RuVHJhbnNmZXIoc3RuSWQ6IElELCB0eXBlLCBpbmZvID0gbnVsbCkge1xyXG4gICAgICAgIHN1cGVyLnVwZGF0ZVN0blRyYW5zZmVyKHN0bklkLCB0eXBlLCBpbmZvKVxyXG5cclxuICAgICAgICB0aGlzLmZpbGxUaGVtZUNvbG91cigpXHJcblxyXG4gICAgICAgIC8vIGNsZWFyIHRoZSBvcmlnaW5hbCBzdGF0aW9uc1xyXG4gICAgICAgICQoJyNzdG5faWNvbnMnKS5lbXB0eSgpXHJcbiAgICAgICAgdGhpcy5kcmF3U3RucygpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGNhbGwgZmlsbFRoZW1lQ29sb3VyIHdoZW4gYWRkIHN0YXRpb25cclxuICAgIGFkZFN0bihwcmVwOiAnYmVmb3JlJyB8ICdhZnRlcicsIHN0bklkOiBJRCwgbG9jLCBlbmQ6IElEKTogW0lELCBTdGF0aW9uSW5mb10ge1xyXG4gICAgICAgIGxldCBbbmV3SWQsIG5ld0luZm9dID0gc3VwZXIuYWRkU3RuKHByZXAsIHN0bklkLCBsb2MsIGVuZClcclxuICAgICAgICB0aGlzLmZpbGxUaGVtZUNvbG91cigpXHJcbiAgICAgICAgcmV0dXJuIFtuZXdJZCwgbmV3SW5mb11cclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2hhbmdlIHRoZSByYWlsbWFwIHBvc2l0aW9uXHJcbiAgICBzZXQgeVBjKHZhbCkge1xyXG4gICAgICAgIHN1cGVyLnlQYyA9IHZhbFxyXG5cclxuICAgICAgICBsZXQgeSA9IHZhbCAqIHRoaXMuX3N2Z0hlaWdodCAvIDUwO1xyXG4gICAgICAgICQoJ2cjbWFpbicpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoMCwke3l9KWApO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9