(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,e,s){"use strict";s.r(e);var n=s(7),a=s(1);class i extends a.l{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-60)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends i{constructor(t,e){super(t,e),this._intInfos=e.interchange[0]}get html(){return $("<g>",{id:this.id}).append(...this.ungrpHTML)}get ungrpHTML(){return[this.iconHTML,this.nameHTML]}get ungrpIconHTML(){return[...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[a.d.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{id:`rmg-name__shmetro--${this.id}`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){let t=[],e=$(`#rmg-name__shmetro--${this.id}`),s=e.get(0).getBoundingClientRect(),n=s.right-s.left+5;this._intInfos.map((e,s)=>{var i=e[a.d.colour],r=$("<use>",{"xlink:href":"#int_sh",fill:i,transform:`translate(${n+25*s},-12)`,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&r.addClass("rmg-line__pass");let h=String(e[a.d.nameZH]).match(/(\d*)\w+/);if(h)var o=h[0];else o=String(e[a.d.nameZH]);var l=$("<text>",{transform:`translate(${n+6+25*s},8)`,class:"rmg-name__zh rmg-name__shmetro--line_name"}).text(o);t.push(r,l)});let i=e.parent();return i.attr("transform",`${i.attr("transform")}rotate(-60)`),t}get _nameClass(){return-1==this.state?"Pass":"Future"}}var h=s(0);s.d(e,"RMGLineSH",(function(){return o}));class o extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":case"int3_l":case"int3_r":return new r(t,e);default:return new i(t,e)}}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50,e="l"==this._direction?1:-1,s=(this._svgDestWidth-e*t)/20;s="l"==this._direction?s:this._svgDestWidth-20;var n=90*(1-e);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${s},135)rotate(${n})`);var a=s+285*e;if($("#station_info_shmetro > #platform").attr("transform",`translate(${a},130)`),"r"===this._direction)var i="end",r=.8*this._svgDestWidth;else i="start",r=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${r},135)`,"text-anchor":i});var[h,o]=["",""];this[`${this._direction}ValidDests`].forEach(t=>{h+=this.stations[t].name[0],o+=this.stations[t].name[1]}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${h}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${o}`);let l="l"===this._direction?this._svgDestWidth:320;var[_,m]=this._lineNames,d=_.match(/(\d*)\w+/);d?(l-=180,_="号线",$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-120},70)`}),$("#station_info_shmetro > #line_number > text").text(d[0]).attr("transform",`translate(${l-100},170)`)):(l-=280,$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-10},60)`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(_),$("#station_info_shmetro > #line_name_text > text:last-child").text(m),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${l},135)`,"text-anchor":"start"});let c="l"==this._direction?"left":"right";$("#line_shmetro_use").attr({"xlink:href":`#line_shmetro_${c}`,transform:"translate(0,220)"})}drawStns(){for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||$("#stn_icons").append(e.html);$("#stn_icons").html($("#stn_icons").html());for(let[t,e]of Object.entries(this.stations).filter(t=>t[1]instanceof r))$(`#rmg-name__shmetro--${t}`).parent().append(e.ungrpIconHTML);$("#stn_icons").html($("#stn_icons").html())}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1]));var n=this._linePath(e),[a,i,r]=n.match(/[\d.]+/g).map(t=>Number(t));n="r"===this._direction?`M ${a},${i-6} H ${r+30} l 12,12 L ${a},${i+6} Z`:`M ${a-30},${i-6} H ${r} l 0,12 L ${a-42},${i+6} Z`,$("#line_main").append($("<path>",{id:"line_main_path",d:n}));n=this._linePath(s);var[a,i,r]=n.match(/[\d.]+/g).map(t=>Number(t));n="r"===this._direction?`M ${a-30},${i-6} H ${r} l 0,12 L ${a-30},${i+6} Z`:`M ${a},${i-6} H ${r+30} l 0,12 L ${a},${i+6} Z`,$("#line_pass").append($("<path>",{id:"line_pass_path",d:n}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("path#int2_sh_pass").attr("stroke","#aaa"),$("path#line_main_path").attr("fill",this._themeColour),$("path#line_pass_path").attr("fill","#aaa");let t="l"==this._direction?"left":"right";$(`#line_shmetro_${t}`).attr("fill",this._themeColour),this._lineNames[0].match(/(\d*)\w+/)?$("#station_info_shmetro > #line_number > text").attr("fill","#fff"):$("#station_info_shmetro > #line_name_text").attr("fill","#fff")}updateStnNameBg(){$("#current_bg").hide()}static initSVG(t){t.drawSVGFrame(),t.showFrameOuter(),t.drawStns(),t.drawLine(),t.fillThemeColour(),t.drawStrip(),t.drawDestInfo(),t.loadFonts(),t.updateStnNameBg()}set direction(t){this._direction=t,Object(h.l)("direction",t);for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||(e.state=this._stnState(t));n.a.clearSVG(),this.drawStns(),this.drawLine(),this.fillThemeColour(),this.drawDestInfo(),this.loadFonts()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),$("#stn_icons").empty(),this.drawStns()}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJuYW1lRU5MbiIsIm5hbWUiLCJzcGxpdCIsImxlbmd0aCIsImR4IiwiX25hbWVTaGlmdCIsIl90aWNrUm90YXRpb24iLCJNYXRoIiwiY29zIiwiaWNvblR5cGUiLCJudW1DbGFzcyIsInN0YXRlIiwic3RhdGlvbl9pZCIsIiQiLCJ0cmFuc2Zvcm0iLCJ4IiwiYXBwZW5kIiwiY2xhc3MiLCJkeSIsIl9keGR5IiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiX2ludEluZm9zIiwiaW50ZXJjaGFuZ2UiLCJ1bmdycEhUTUwiLCJpY29uSFRNTCIsIm5hbWVIVE1MIiwiaW50VGlja0hUTUwiLCJzdHJva2UiLCJjb2xvdXIiLCJsaW5lRWxlbXMiLCJzdG5OYW1lRWxlbSIsImJjciIsImdldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0IiwibGVmdCIsIm1hcCIsInN0biIsImluZGV4IiwibGluZUljb25Db2xvdXIiLCJsaW5lSWNvbkVsZW0iLCJmaWxsIiwibGluZU51bWJlciIsIlN0cmluZyIsIm5hbWVaSCIsIm1hdGNoIiwibGluZU5hbWUiLCJsaW5lTmFtZUVsZW0iLCJwdXNoIiwic3RuSW5mb0VsZW0iLCJwYXJlbnQiLCJhdHRyIiwicGFyYW0iLCJzdG5JZCIsInN0bkluZm8iLCJjaGFuZ2VfdHlwZSIsIl9wbGF0Zm9ybU51bSIsImZsYWdMZW5ndGgiLCJ3aWR0aCIsImlzTGVmdCIsIl9kaXJlY3Rpb24iLCJhcnJvd1giLCJfc3ZnRGVzdFdpZHRoIiwiYXJyb3dSb3RhdGUiLCJwbGF0Zm9ybU51bVgiLCJ0eHRBbmNob3IiLCJkZXN0TmFtZVgiLCJkZXN0aW5hdGlvbnNfemgiLCJkZXN0aW5hdGlvbnNfZW4iLCJmb3JFYWNoIiwic3RhdGlvbnMiLCJsaW5lTmFtZVgiLCJsaW5lTmFtZVpIIiwibGluZU5hbWVFTiIsIl9saW5lTmFtZXMiLCJfdGhlbWVDb2xvdXIiLCJoaWRlIiwiZGlyZWN0aW9uIiwic3RuSW5zdGFuY2UiLCJPYmplY3QiLCJlbnRyaWVzIiwiaW5jbHVkZXMiLCJodG1sIiwiZmlsdGVyIiwidW5ncnBJY29uSFRNTCIsInJlbW92ZUNsYXNzIiwiYnJhbmNoZXMiLCJicmFuY2giLCJsaW5lTWFpblN0bnMiLCJsaW5lUGFzc1N0bnMiLCJpbmRleE9mIiwidW5zaGlmdCIsInBhdGgiLCJfbGluZVBhdGgiLCJoIiwicG9zIiwiTnVtYmVyIiwiZCIsImZpbGxUaGVtZUNvbG91ciIsImxpbmUiLCJkcmF3U1ZHRnJhbWUiLCJzaG93RnJhbWVPdXRlciIsImRyYXdTdG5zIiwiZHJhd0xpbmUiLCJkcmF3U3RyaXAiLCJkcmF3RGVzdEluZm8iLCJsb2FkRm9udHMiLCJ1cGRhdGVTdG5OYW1lQmciLCJ2YWwiLCJfc3RuU3RhdGUiLCJjbGVhclNWRyIsInR5cGUiLCJpbmZvIiwidXBkYXRlU3RuVHJhbnNmZXIiLCJlbXB0eSJdLCJtYXBwaW5ncyI6ImtIQUtBLE1BQU0sVUFBcUIsSUFDdkIsWUFBWUEsRUFBUUMsR0FDaEJDLE1BQU1GLEVBQUlDLEdBQ1ZFLEtBQUtDLE9BQVNILEVBQUtJLElBR3ZCLGlCQUFtQixPQUFPLEVBQzFCLG9CQUFzQixPQUFPRixLQUFLRyxFQUFJLEVBQUksSUFBTSxFQUNoRCxZQUNJLElBQUlDLEVBQVdKLEtBQUtLLEtBQUssR0FBR0MsTUFBTSxNQUFNQyxPQUN4QyxJQUFJQyxFQVNKLE9BUElBLEVBREFSLEtBQUtTLFdBQ3VCLElBQXZCVCxLQUFLVSxlQUF1QixFQUFJLEdBQXNCLElBQWhCTixFQUFXLEdBQVVPLEtBQUtDLEtBQUssSUFFOUMsSUFBdkJaLEtBQUtVLGVBQXVCLEdBQXNCLElBQWhCTixFQUFXLElBQVdPLEtBQUtDLEtBQUssS0FBTyxFQUszRSxDQUFDSixFQUZ3QixJQUF2QlIsS0FBS1Us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LG9CQUFvQnVDLEtBQUssU0FBVSxRQUNyQ3ZDLEVBQUUscUJBQXFCdUMsS0FBSyxTQUFVLFFBR3RDdkMsRUFBRSx1QkFBdUJ1QyxLQUFLLE9BQVF4RCxLQUFLZ0YsY0FDM0MvRCxFQUFFLHVCQUF1QnVDLEtBQUssT0FBUSxRQUd0QyxJQUFJMEIsRUFBK0IsS0FBbkJsRixLQUFLaUUsV0FBb0IsT0FBUyxRQUNsRGhELEVBQUUsaUJBQWlCaUUsS0FBYTFCLEtBQUssT0FBUXhELEtBQUtnRixjQUU5Q2hGLEtBQUsrRSxXQUFXLEdBQUc3QixNQUFNLFlBRXpCakMsRUFBRSwrQ0FBK0N1QyxLQUFLLE9BQVEsUUFHOUR2QyxFQUFFLDJDQUEyQ3VDLEtBQUssT0FBUSxRQUlsRSxrQkFDSXZDLEVBQUUsZUFBZWdFLE9BSXJCLGVBQWV1QixHQUNYQSxFQUFLQyxlQUNMRCxFQUFLRSxpQkFDTEYsRUFBS0csV0FHTEgsRUFBS0ksV0FDTEosRUFBS0Qsa0JBR0xDLEVBQUtLLFlBQ0xMLEVBQUtNLGVBQ0xOLEVBQUtPLFlBQ0xQLEVBQUtRLGtCQUlULGNBQWNDLEdBQ1ZqSCxLQUFLaUUsV0FBYWdELEVBQ2xCLFlBQVUsWUFBYUEsR0FFdkIsSUFBSyxJQUFLdkQsRUFBT3lCLEtBQWdCQyxPQUFPQyxRQUFRckYsS0FBSzJFLFVBQzdDLENBQUMsWUFBYSxXQUFXVyxTQUFTNUIsS0FDdEN5QixFQUFZcEUsTUFBUWYsS0FBS2tILFVBQVV4RCxJQUd2QyxJQUFReUQsV0FDUm5ILEtBQUsyRyxXQUNMM0csS0FBSzRHLFdBR0w1RyxLQUFLdUcsa0JBRUx2RyxLQUFLOEcsZUFFTDlHLEtBQUsrRyxZQUlULGtCQUFrQnJELEVBQVcwRCxFQUFNQyxFQUFPLE1BQ3RDdEgsTUFBTXVILGtCQUFrQjVELEVBQU8wRCxFQUFNQyxHQUdyQ3BHLEVBQUUsY0FBY3NHLFFBQ2hCdkgsS0FBSzJHIiwiZmlsZSI6IkxpbmVTSC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSTUdTdGF0aW9uLCBJbnRJbmZvVGFnLCBJbnRlcmNoYW5nZUluZm8gfSBmcm9tICcuL1N0YXRpb24nO1xyXG5pbXBvcnQgeyBJRCwgTmFtZSwgQnJhbmNoSW5mbywgU3RhdGlvbkluZm8gfSBmcm9tICcuLi91dGlscyc7XHJcblxyXG5jb25zdCBzdGF0aW9uX2lkID0gJ3N0bl9zaCdcclxuXHJcbmNsYXNzIFJNR1N0YXRpb25TSCBleHRlbmRzIFJNR1N0YXRpb24ge1xyXG4gICAgY29uc3RydWN0b3IoaWQ6IElELCBkYXRhOiBTdGF0aW9uSW5mbykge1xyXG4gICAgICAgIHN1cGVyKGlkLCBkYXRhKTtcclxuICAgICAgICB0aGlzLnN0bk51bSA9IGRhdGEubnVtO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZVNoaWZ0KCkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgIGdldCBfdGlja1JvdGF0aW9uKCkgeyByZXR1cm4gdGhpcy55ID4gMCA/IDE4MCA6IDA7IH1cclxuICAgIGdldCBfZHhkeSgpIHtcclxuICAgICAgICB2YXIgbmFtZUVOTG4gPSB0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKS5sZW5ndGg7XHJcbiAgICAgICAgbGV0IGR4OiBudW1iZXI7XHJcbiAgICAgICAgaWYgKHRoaXMuX25hbWVTaGlmdCkge1xyXG4gICAgICAgICAgICBkeCA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/IC05IDogMTYgKyAobmFtZUVOTG4gLSAxKSAqIDEyICogTWF0aC5jb3MoLTQ1KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkeCA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICgyNCArIChuYW1lRU5MbiAtIDEpICogMTIpICogTWF0aC5jb3MoLTQ1KSA6IC02O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBsZXQgZHggPSB0aGlzLl9uYW1lU2hpZnQgPyAtOCA6ICgyNCArIChuYW1lRU5Mbi0xKSoxMikgKiBNYXRoLmNvcygtNDUpO1xyXG4gICAgICAgIGxldCBkeSA9IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICgtNCAtIDIxLjkyMTg3NSAtIChuYW1lRU5MbiAtIDEpICogMTIgKiBNYXRoLmNvcygtNDUpKSA6IDE3LjU7XHJcbiAgICAgICAgLy8gdmFyIGR5ID0gKC00IC0gMjEuOTIxODc1IC0gKG5hbWVFTkxuLTEpKjEyKk1hdGguY29zKC00NSkpICogKHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/IDEgOiAtMSk7XHJcbiAgICAgICAgcmV0dXJuIFtkeCwgZHldXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGljb25IVE1MKCkge1xyXG4gICAgICAgIHZhciBbaWNvblR5cGUsIG51bUNsYXNzXSA9ICh0aGlzLnN0YXRlID09IC0xKSA/IFtzdGF0aW9uX2lkICsgJ19wYXNzJywgJ1Bhc3MnXSA6IFtzdGF0aW9uX2lkLCAnRnV0dXJlJ107XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54fSwke3RoaXMueX0pYCB9KVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzx1c2U+JywgeyAneGxpbms6aHJlZic6ICcjJyArIGljb25UeXBlLCBjbGFzczogJ3JtZy1zdG4nIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgbmFtZUhUTUwoKSB7XHJcbiAgICAgICAgbGV0IFtkeCwgZHldID0gdGhpcy5fZHhkeVxyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7dGhpcy54IC0gZHh9LCR7dGhpcy55ICsgZHl9KXJvdGF0ZSgtNjApYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogdGhpcy5fdGlja1JvdGF0aW9uID09PSAwID8gJ3N0YXJ0JyA6ICdlbmQnLFxyXG4gICAgICAgICAgICAvLyBjbGFzczogYE5hbWUgJHt0aGlzLm5hbWVDbGFzc31gXHJcbiAgICAgICAgICAgIGNsYXNzOiBgTmFtZSBGdXR1cmVgICAvLyB0b2RvOiBmaXggdGhpc1xyXG4gICAgICAgIH0pLmFwcGVuZChcclxuICAgICAgICAgICAgJCgnPHRleHQ+JykuYWRkQ2xhc3MoJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbicpLnRleHQodGhpcy5uYW1lWzBdKVxyXG4gICAgICAgICkuYXBwZW5kKFxyXG4gICAgICAgICAgICAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICBkeTogMTUsIGNsYXNzOiAncm1nLW5hbWVfX2VuIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJ1xyXG4gICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzBdKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dHNwYW4+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgICd4JzogMCwgJ2R5JzogMTJcclxuICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMV0pXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBJbnRTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uU0gge1xyXG4gICAgcHJvdGVjdGVkIF9pbnRJbmZvczogSW50ZXJjaGFuZ2VJbmZvW107XHJcblxyXG4gICAgY29uc3RydWN0b3IoaWQ6IElELCBkYXRhOiBTdGF0aW9uSW5mbykge1xyXG4gICAgICAgIHN1cGVyKGlkLCBkYXRhKTtcclxuICAgICAgICB0aGlzLl9pbnRJbmZvcyA9IGRhdGEuaW50ZXJjaGFuZ2VbMF07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGFwcGVuZCBkb20gYW5kIHRoZW4gZ2V0Qm91bmRpbmdDbGllbnRSZWN0XHJcbiAgICAvLyB0byBnZXQgdGhlIGV4YWN0IHBvc2l0aW9uIHdoZXJlIGludCBpY29uIGNhbiBiZSBmaXRcclxuICAgIGdldCBodG1sKCkge1xyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7IGlkOiB0aGlzLmlkIH0pLmFwcGVuZCguLi50aGlzLnVuZ3JwSFRNTCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGdldCBhbGwgZHJhd2luZyBmdW5jdGlvbiB0byBiZSBjYWxsZWRcclxuICAgIGdldCB1bmdycEhUTUwoKSB7XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLmljb25IVE1MLCB0aGlzLm5hbWVIVE1MXTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdW5ncnBJY29uSFRNTCgpIHtcclxuICAgICAgICByZXR1cm4gWy4uLnRoaXMuaW50VGlja0hUTUxdXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaW50ZXJjaGFuZ2Ugc3RhdGlvbiBpY29uIG9uIG1haW4gbGluZVxyXG4gICAgZ2V0IGljb25IVE1MKCkge1xyXG4gICAgICAgIHZhciBbaWNvblR5cGUsIG51bUNsYXNzXSA9ICh0aGlzLnN0YXRlID09IC0xKSA/IFsnaW50Ml9zaF9wYXNzJywgJ1Bhc3MnXSA6IFsnaW50Ml9zaCcsICdGdXR1cmUnXTtcclxuICAgICAgICByZXR1cm4gJCgnPGc+JywgeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHt0aGlzLnh9LCR7dGhpcy55fSlgIH0pXHJcbiAgICAgICAgICAgIC5hcHBlbmQoJCgnPHVzZT4nLCB7ICd4bGluazpocmVmJzogJyMnICsgaWNvblR5cGUsIGNsYXNzOiAncm1nLXN0bicsIHN0cm9rZTogdGhpcy5faW50SW5mb3NbSW50SW5mb1RhZy5jb2xvdXJdIH0pKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZWd1bGFyIHN0YXRpb24gbmFtZVxyXG4gICAgZ2V0IG5hbWVIVE1MKCkge1xyXG4gICAgICAgIGxldCBbZHgsIGR5XSA9IHRoaXMuX2R4ZHk7XHJcbiAgICAgICAgLy8gd3JhcCB0aGUgbmFtZSwgZGVjcm9fbGluZSBhbmQgaW50X2xpbmUgdW5kZXIgZyBpbiBvcmRlciB0byByb3RhdGUgYXQgb25jZVxyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke3RoaXMueCAtIGR4fSwke3RoaXMueSArIGR5fSlgLCAgLy9yb3RhdGUoLTYwKVxyXG4gICAgICAgIH0pLmFwcGVuZChcclxuICAgICAgICAgICAgLy8gdGhlIG9yaWdpbmFsIG5hbWUgdGV4dFxyXG4gICAgICAgICAgICAkKCc8Zz4nLCB7XHJcbiAgICAgICAgICAgICAgICBpZDogYHJtZy1uYW1lX19zaG1ldHJvLS0ke3RoaXMuaWR9YCxcclxuICAgICAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICdzdGFydCcgOiAnZW5kJyxcclxuICAgICAgICAgICAgICAgIGNsYXNzOiBgTmFtZSBGdXR1cmVgICAvLyB0b2RvOiBmaXggdGhpc1xyXG4gICAgICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAkKCc8dGV4dD4nKS5hZGRDbGFzcygncm1nLW5hbWVfX3poIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJykudGV4dCh0aGlzLm5hbWVbMF0pXHJcbiAgICAgICAgICAgICkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRleHQ+Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIGR5OiAxNSwgY2xhc3M6ICdybWctbmFtZV9fZW4gcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nXHJcbiAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzBdKS5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgJCgnPHRzcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3gnOiAwLCAnZHknOiAxMlxyXG4gICAgICAgICAgICAgICAgICAgIH0pLnRleHQodGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJylbMV0pXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaW50ZXJjaGFuZ2Ugc3RhdGlvbiBpY29uIGFmdGVyIHRoZSBzdGF0aW9uIG5hbWVcclxuICAgIGdldCBpbnRUaWNrSFRNTCgpIHtcclxuICAgICAgICBsZXQgbGluZUVsZW1zOiBKUXVlcnk8SFRNTEVsZW1lbnQ+W10gPSBbXVxyXG5cclxuICAgICAgICAvLyBnZXQgdGhlIGV4YWN0IHN0YXRpb24gbmFtZSB3aWR0aCBzbyB0aGF0IHRoZVxyXG4gICAgICAgIC8vIGludGVyY2hhbmdlIHN0YXRpb24gaWNvbiBjYW4gYmUgcmlnaHQgYWZ0ZXIgdGhlIHN0YXRpb24gbmFtZVxyXG4gICAgICAgIGxldCBzdG5OYW1lRWxlbSA9ICQoYCNybWctbmFtZV9fc2htZXRyby0tJHt0aGlzLmlkfWApXHJcbiAgICAgICAgbGV0IGJjciA9IHN0bk5hbWVFbGVtLmdldCgwKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxyXG4gICAgICAgIGxldCBkeCA9IGJjci5yaWdodCAtIGJjci5sZWZ0ICsgNVxyXG5cclxuICAgICAgICB0aGlzLl9pbnRJbmZvcy5tYXAoKHN0biwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgLy8gaW50ZXJjaGFuZ2UgbGluZSBpY29uIGFmdGVyIHN0YXRpb24gbmFtZVxyXG4gICAgICAgICAgICB2YXIgbGluZUljb25Db2xvdXIgPSBzdG5bSW50SW5mb1RhZy5jb2xvdXJdO1xyXG4gICAgICAgICAgICB2YXIgbGluZUljb25FbGVtID0gJCgnPHVzZT4nLCB7XHJcbiAgICAgICAgICAgICAgICAneGxpbms6aHJlZic6ICcjaW50X3NoJyxcclxuICAgICAgICAgICAgICAgIGZpbGw6IGxpbmVJY29uQ29sb3VyLFxyXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7ZHggKyBpbmRleCAqIDI1fSwtMTIpYCxcclxuICAgICAgICAgICAgICAgIGNsYXNzOiAncm1nLWxpbmVfX3NobWV0cm8gcm1nLWxpbmVfX2NoYW5nZScsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgbGluZUljb25FbGVtLmFkZENsYXNzKCdybWctbGluZV9fcGFzcycpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBsaW5lIHN0YXJ0cyB3aXRoIG51bWJlcnMgb3IgbGV0dGVyc1xyXG4gICAgICAgICAgICBsZXQgbGluZU51bWJlciA9IFN0cmluZyhzdG5bSW50SW5mb1RhZy5uYW1lWkhdKS5tYXRjaCgvKFxcZCopXFx3Ky8pXHJcbiAgICAgICAgICAgIGlmIChsaW5lTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluZU5hbWUgPSBsaW5lTnVtYmVyWzBdXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluZU5hbWUgPSBTdHJpbmcoc3RuW0ludEluZm9UYWcubmFtZVpIXSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBpbnRlcmNoYW5nZSBsaW5lIG5hbWVcclxuICAgICAgICAgICAgdmFyIGxpbmVOYW1lRWxlbSA9ICQoJzx0ZXh0PicsIHtcclxuICAgICAgICAgICAgICAgIC8vIFRvZG86IGZpeCB0aGlzIGhhcmQtY29kZWQgY2VudGVyKDYpIHBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtkeCArIDYgKyBpbmRleCAqIDI1fSw4KWAsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tbGluZV9uYW1lJyxcclxuICAgICAgICAgICAgfSkudGV4dChsaW5lTmFtZSlcclxuXHJcbiAgICAgICAgICAgIGxpbmVFbGVtcy5wdXNoKGxpbmVJY29uRWxlbSwgbGluZU5hbWVFbGVtKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vIHJvdGF0ZSB0aGUgc3RhdGlvbiBpbmZvIG5vd1xyXG4gICAgICAgIC8vIG90aGVyIHdpc2UgdGhlIGJjciB3aWxsIGJlIGluYWNjdXJhdGUgZHVlIHRvIHRoZSByb3RhdGlvblxyXG4gICAgICAgIGxldCBzdG5JbmZvRWxlbSA9IHN0bk5hbWVFbGVtLnBhcmVudCgpO1xyXG4gICAgICAgIHN0bkluZm9FbGVtLmF0dHIoJ3RyYW5zZm9ybScsIGAke3N0bkluZm9FbGVtLmF0dHIoJ3RyYW5zZm9ybScpfXJvdGF0ZSgtNjApYClcclxuXHJcbiAgICAgICAgcmV0dXJuIGxpbmVFbGVtcztcclxuICAgIH1cclxuXHJcbiAgICBnZXQgX25hbWVDbGFzcygpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuc3RhdGUgPT0gLTEpID8gJ1Bhc3MnIDogJ0Z1dHVyZSc7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgeyBSTUdTdGF0aW9uU0gsIEludFN0YXRpb25TSCwgc3RhdGlvbl9pZCB9O1xyXG4iLCJpbXBvcnQgeyBSTUdMaW5lIH0gZnJvbSAnLi9MaW5lJztcclxuaW1wb3J0IHsgUk1HU3RhdGlvblNILCBJbnRTdGF0aW9uU0gsIHN0YXRpb25faWQgfSBmcm9tICcuLi9TdGF0aW9uL1N0YXRpb25TSCc7XHJcbmltcG9ydCB7IFJNR1N0YXRpb24gfSBmcm9tICcuLi9TdGF0aW9uL1N0YXRpb24nO1xyXG5cclxuaW1wb3J0IHsgSUQsIE5hbWUsIFN0YXRpb25JbmZvLCBSTUdQYXJhbSwgc2V0UGFyYW1zIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJNR0xpbmVTSCBleHRlbmRzIFJNR0xpbmUge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW0pIHtcclxuICAgICAgICBzdXBlcihwYXJhbSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2luaXRTdG5JbnN0YW5jZShzdG5JZDogSUQsIHN0bkluZm86IFN0YXRpb25JbmZvKTogUk1HU3RhdGlvbiB7XHJcbiAgICAgICAgc3dpdGNoIChzdG5JbmZvLmNoYW5nZV90eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2ludDInOlxyXG4gICAgICAgICAgICBjYXNlICdpbnQzX2wnOlxyXG4gICAgICAgICAgICBjYXNlICdpbnQzX3InOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSTUdTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBkcmF3IHRoZSBkZXN0aW5hdGlvblxyXG4gICAgZHJhd0Rlc3RJbmZvKCkge1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNwbGF0Zm9ybSA+IHRleHQnKS50ZXh0KHRoaXMuX3BsYXRmb3JtTnVtKTtcclxuXHJcbiAgICAgICAgdmFyIGJjciA9ICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQnKVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgZmxhZ0xlbmd0aCA9IDE2MCArIDE1MCArIGJjci53aWR0aCArIDQ1ICsgNTA7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8gYXJyb3dcclxuICAgICAgICB2YXIgaXNMZWZ0ID0gKHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcpID8gMSA6IC0xO1xyXG4gICAgICAgIHZhciBhcnJvd1ggPSAodGhpcy5fc3ZnRGVzdFdpZHRoIC0gaXNMZWZ0ICogZmxhZ0xlbmd0aCkgLyAyMDtcclxuICAgICAgICBhcnJvd1ggPSAodGhpcy5fZGlyZWN0aW9uID09ICdsJykgPyBhcnJvd1ggOiB0aGlzLl9zdmdEZXN0V2lkdGggLSAyMDtcclxuICAgICAgICB2YXIgYXJyb3dSb3RhdGUgPSA5MCAqICgxIC0gaXNMZWZ0KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjYXJyb3dfbGVmdF91c2UnKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7YXJyb3dYfSwxMzUpcm90YXRlKCR7YXJyb3dSb3RhdGV9KWApO1xyXG5cclxuICAgICAgICAvLyBub3QgaW4gdXNlIG5vd1xyXG4gICAgICAgIHZhciBwbGF0Zm9ybU51bVggPSBhcnJvd1ggKyBpc0xlZnQgKiAoMTYwICsgNTAgKyA3NSk7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI3BsYXRmb3JtJykuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke3BsYXRmb3JtTnVtWH0sMTMwKWApO1xyXG5cclxuICAgICAgICAvLyBsaXN0IHRoZSBkZXN0aW5hdGlvbiB0ZXh0XHJcbiAgICAgICAgLy8gVG9kbzogZml4IHN2Z19kZXN0X3dpZHRoKjAuOCwgdGhpcyBoYXMgb25seSBiZWVuIHRlc3RlZCBvbiAxMDAwIHdpZHRoXHJcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgIHZhciB0eHRBbmNob3IgPSAnZW5kJztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuODtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdHh0QW5jaG9yID0gJ3N0YXJ0JztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCcpLmF0dHIoe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtkZXN0TmFtZVh9LDEzNSlgLFxyXG4gICAgICAgICAgICAndGV4dC1hbmNob3InOiB0eHRBbmNob3JcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gZm9yIGVhY2ggbGVmdCB2YWxpZCBkZXN0aW5hdGlvbnMsIGdldCB0aGUgbmFtZSBmcm9tIGlkXHJcbiAgICAgICAgdmFyIFtkZXN0aW5hdGlvbnNfemgsIGRlc3RpbmF0aW9uc19lbl0gPSBbXCJcIiwgXCJcIl1cclxuICAgICAgICB0aGlzW2Ake3RoaXMuX2RpcmVjdGlvbn1WYWxpZERlc3RzYF0uZm9yRWFjaChzdG4gPT4ge1xyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNfemggKz0gdGhpcy5zdGF0aW9uc1tzdG5dLm5hbWVbMF1cclxuICAgICAgICAgICAgZGVzdGluYXRpb25zX2VuICs9IHRoaXMuc3RhdGlvbnNbc3RuXS5uYW1lWzFdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCA+IHRleHQ6Zmlyc3QtY2hpbGQnKS50ZXh0KGDlvoAke2Rlc3RpbmF0aW9uc196aH1gKVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQgPiB0ZXh0Omxhc3QtY2hpbGQnKS50ZXh0KGBUbyAke2Rlc3RpbmF0aW9uc19lbn1gKVxyXG5cclxuICAgICAgICAvLyBwcmVwYXJlIGZvciB0aGUgbGluZSBuYW1lXHJcbiAgICAgICAgbGV0IGxpbmVOYW1lWCA9IHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2wnID8gdGhpcy5fc3ZnRGVzdFdpZHRoIDogMzIwXHJcbiAgICAgICAgdmFyIFtsaW5lTmFtZVpILCBsaW5lTmFtZUVOXSA9IHRoaXMuX2xpbmVOYW1lcztcclxuXHJcbiAgICAgICAgLy8gbGluZSBzdGFydHMgd2l0aCBudW1iZXJzIG9yIGxldHRlcnNcclxuICAgICAgICB2YXIgbGluZU51bWJlciA9IGxpbmVOYW1lWkgubWF0Y2goLyhcXGQqKVxcdysvKVxyXG4gICAgICAgIGlmIChsaW5lTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIGxpbmVOYW1lWCAtPSAxODA7XHJcbiAgICAgICAgICAgIGxpbmVOYW1lWkggPSBcIuWPt+e6v1wiXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHJlY3QnKS5hdHRyKHtcclxuICAgICAgICAgICAgICAgICdzdHlsZSc6IGBmaWxsOiR7dGhpcy5fdGhlbWVDb2xvdXJ9YCxcclxuICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYIC0gMTIwfSw3MClgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHRleHQnKVxyXG4gICAgICAgICAgICAgICAgLnRleHQobGluZU51bWJlclswXSlcclxuICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7bGluZU5hbWVYIC0gMTAwfSwxNzApYClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsaW5lTmFtZVggLT0gMjgwO1xyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiByZWN0JykuYXR0cih7XHJcbiAgICAgICAgICAgICAgICAnc3R5bGUnOiBgZmlsbDoke3RoaXMuX3RoZW1lQ29sb3VyfWAsXHJcbiAgICAgICAgICAgICAgICAndHJhbnNmb3JtJzogYHRyYW5zbGF0ZSgke2xpbmVOYW1lWCAtIDEwfSw2MClgLFxyXG4gICAgICAgICAgICAgICAgJ3dpZHRoJzogMjYwLFxyXG4gICAgICAgICAgICAgICAgJ2hlaWdodCc6IDE1MFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiB0ZXh0JykuaGlkZSgpXHJcblxyXG4gICAgICAgICAgICAvLyBUb2RvOiBzZXQgdGhlIGVuZyBpbiB0aGUgbWlkZGxlXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCA+IHRleHQ6bGFzdC1jaGlsZCcpLmF0dHIoJ2R4JywgMTApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBzZXQgdGhlIGxpbmUgbmFtZVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCA+IHRleHQ6Zmlyc3QtY2hpbGQnKS50ZXh0KGxpbmVOYW1lWkgpXHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbmFtZV90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykudGV4dChsaW5lTmFtZUVOKVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCcpLmF0dHIoe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVh9LDEzNSlgLFxyXG4gICAgICAgICAgICAndGV4dC1hbmNob3InOiAnc3RhcnQnXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHRoZSBsYXN0IGRlY29yYXRpb24gbGluZVxyXG4gICAgICAgIGxldCBkaXJlY3Rpb24gPSB0aGlzLl9kaXJlY3Rpb24gPT0gJ2wnID8gJ2xlZnQnIDogJ3JpZ2h0J1xyXG4gICAgICAgICQoJyNsaW5lX3NobWV0cm9fdXNlJykuYXR0cih7XHJcbiAgICAgICAgICAgICd4bGluazpocmVmJzogYCNsaW5lX3NobWV0cm9fJHtkaXJlY3Rpb259YCxcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKDAsMjIwKWAsXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGFwcGVuZCBkb20gYW5kIHRoZW4gZ2V0Qm91bmRpbmdDbGllbnRSZWN0XHJcbiAgICAvLyB0byBnZXQgdGhlIGV4YWN0IHBvc2l0aW9uIHdoZXJlIGludCBpY29uIGNhbiBiZSBmaXRcclxuICAgIGRyYXdTdG5zKCkge1xyXG4gICAgICAgIGZvciAobGV0IFtzdG5JZCwgc3RuSW5zdGFuY2VdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuc3RhdGlvbnMpKSB7XHJcbiAgICAgICAgICAgIGlmIChbJ2xpbmVzdGFydCcsICdsaW5lZW5kJ10uaW5jbHVkZXMoc3RuSWQpKSB7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICQoJyNzdG5faWNvbnMnKS5hcHBlbmQoc3RuSW5zdGFuY2UuaHRtbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJyNzdG5faWNvbnMnKS5odG1sKCQoJyNzdG5faWNvbnMnKS5odG1sKCkpOyAvLyBSZWZyZXNoIERPTVxyXG5cclxuICAgICAgICBmb3IgKGxldCBbc3RuSWQsIHN0bkluc3RhbmNlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnN0YXRpb25zKVxyXG4gICAgICAgICAgICAuZmlsdGVyKHN0biA9PiBzdG5bMV0gaW5zdGFuY2VvZiBJbnRTdGF0aW9uU0gpIGFzIFtJRCwgSW50U3RhdGlvblNIXVtdKSB7XHJcbiAgICAgICAgICAgICQoYCNybWctbmFtZV9fc2htZXRyby0tJHtzdG5JZH1gKS5wYXJlbnQoKS5hcHBlbmQoc3RuSW5zdGFuY2UudW5ncnBJY29uSFRNTClcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0bl9pY29ucycpLmh0bWwoJCgnI3N0bl9pY29ucycpLmh0bWwoKSk7IC8vIFJlZnJlc2ggRE9NXHJcbiAgICB9XHJcblxyXG4gICAgLy8gZHJhdyB0aGUgbGluZSBpbiByYWlsbWFwXHJcbiAgICBkcmF3TGluZSgpIHtcclxuICAgICAgICAkKCcucm1nLWxpbmUnKS5yZW1vdmVDbGFzcygncm1nLWxpbmVfX210cicpLmFkZENsYXNzKCdybWctbGluZV9fc2htZXRybycpO1xyXG5cclxuICAgICAgICB0aGlzLmJyYW5jaGVzLm1hcChicmFuY2ggPT4ge1xyXG4gICAgICAgICAgICB2YXIgbGluZU1haW5TdG5zID0gYnJhbmNoLmZpbHRlcihzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5zdGF0ZSA+PSAwKTtcclxuICAgICAgICAgICAgdmFyIGxpbmVQYXNzU3RucyA9IGJyYW5jaC5maWx0ZXIoc3RuSWQgPT4gdGhpcy5zdGF0aW9uc1tzdG5JZF0uc3RhdGUgPD0gMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobGluZU1haW5TdG5zLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zID0gYnJhbmNoO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobGluZU1haW5TdG5zLmZpbHRlcihzdG5JZCA9PiBsaW5lUGFzc1N0bnMuaW5kZXhPZihzdG5JZCkgIT09IC0xKS5sZW5ndGggPT0gMCAmJiBsaW5lTWFpblN0bnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0d28gc2V0IGRpc2pvaW50XHJcbiAgICAgICAgICAgICAgICBpZiAobGluZVBhc3NTdG5zWzBdID09PSBicmFuY2hbMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAtMSAtMSAxIDFcclxuICAgICAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMucHVzaChsaW5lTWFpblN0bnNbMF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lTWFpblN0bnNbMF0gPT09IGJyYW5jaFswXSAmJiBsaW5lTWFpblN0bnNbbGluZU1haW5TdG5zLmxlbmd0aCAtIDFdID09PSBicmFuY2hbYnJhbmNoLmxlbmd0aCAtIDFdICYmIGxpbmVQYXNzU3Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMgPSBicmFuY2g7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZU1haW5TdG5zID0gW107XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIDEgMSAtMSAtMVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3Rucy51bnNoaWZ0KGxpbmVNYWluU3Ruc1tsaW5lTWFpblN0bnMubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBzdHJldGNoIHRoZSBtYWluIGxpbmVcclxuICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLl9saW5lUGF0aChsaW5lTWFpblN0bnMpXHJcbiAgICAgICAgICAgIHZhciBbeCwgeSwgaF0gPSBwYXRoLm1hdGNoKC9bXFxkLl0rL2cpLm1hcChwb3MgPT4gTnVtYmVyKHBvcykpXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdyJykge1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGBNICR7eH0sJHt5IC0gNn0gSCAke2ggKyAzMH0gbCAxMiwxMiBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBgTSAke3ggLSAzMH0sJHt5IC0gNn0gSCAke2h9IGwgMCwxMiBMICR7eCAtIDQyfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBtYWluIGxpbmVcclxuICAgICAgICAgICAgJCgnI2xpbmVfbWFpbicpLmFwcGVuZCgkKCc8cGF0aD4nLCB7IGlkOiAnbGluZV9tYWluX3BhdGgnLCBkOiBwYXRoIH0pKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmV0Y2ggdGhlIHBhc3MgbGluZVxyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVQYXNzU3RucylcclxuICAgICAgICAgICAgdmFyIFt4LCB5LCBoXSA9IHBhdGgubWF0Y2goL1tcXGQuXSsvZykubWFwKHBvcyA9PiBOdW1iZXIocG9zKSlcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoID0gYE0gJHt4IC0gMzB9LCR7eSAtIDZ9IEggJHtofSBsIDAsMTIgTCAke3ggLSAzMH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBgTSAke3h9LCR7eSAtIDZ9IEggJHtoICsgMzB9IGwgMCwxMiBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZHJhdyB0aGUgcGFzcyBsaW5lXHJcbiAgICAgICAgICAgICQoJyNsaW5lX3Bhc3MnKS5hcHBlbmQoJCgnPHBhdGg+JywgeyBpZDogJ2xpbmVfcGFzc19wYXRoJywgZDogcGF0aCB9KSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoJyNsaW5lX21haW4nKS5odG1sKCQoJyNsaW5lX21haW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyNsaW5lX3Bhc3MnKS5odG1sKCQoJyNsaW5lX3Bhc3MnKS5odG1sKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbGxUaGVtZUNvbG91cigpIHtcclxuICAgICAgICBzdXBlci5maWxsVGhlbWVDb2xvdXIoKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcyB3aWxsIGFkZCB0aGUgc3Ryb2tlIG9mIHRoZSBzdGF0aW9uIGNpcmNsZVxyXG4gICAgICAgIC8vIGhvd2V2ZXIgdGhlIHN0cm9rZSBwYXRoIGlzIGRlZmluZWQgaW4gaW5kZXguaHRtbFxyXG4gICAgICAgIC8vIHdoaWNoIG1hZGUgY2hhbmdpbmcgc3RhdGlvbiBzdHlsZSBzdHJhbmdlXHJcbiAgICAgICAgJCgncGF0aCMnICsgc3RhdGlvbl9pZCkuYXR0cignc3Ryb2tlJywgdGhpcy5fdGhlbWVDb2xvdXIpO1xyXG4gICAgICAgICQoJ3BhdGgjaW50Ml9zaCcpLmF0dHIoJ3N0cm9rZScsIHRoaXMuX3RoZW1lQ29sb3VyKTtcclxuXHJcbiAgICAgICAgLy8gcGFzcyBzdHJva2Ugc2hvdWxkIGJlIGFkZGVkIHNvbWV3aGVyZSBlbHNlXHJcbiAgICAgICAgLy8gYnV0IEkgY2FuJ3QgZmlndXJlIGl0IG91dFxyXG4gICAgICAgICQoJ3BhdGgjc3RuX3NoX3Bhc3MnKS5hdHRyKCdzdHJva2UnLCAnI2FhYScpO1xyXG4gICAgICAgICQoJ3BhdGgjaW50Ml9zaF9wYXNzJykuYXR0cignc3Ryb2tlJywgJyNhYWEnKTtcclxuXHJcbiAgICAgICAgLy8gdGhlIHJhaWxtYXAgbWFpbiBsaW5lXHJcbiAgICAgICAgJCgncGF0aCNsaW5lX21haW5fcGF0aCcpLmF0dHIoJ2ZpbGwnLCB0aGlzLl90aGVtZUNvbG91cilcclxuICAgICAgICAkKCdwYXRoI2xpbmVfcGFzc19wYXRoJykuYXR0cignZmlsbCcsICcjYWFhJylcclxuXHJcbiAgICAgICAgLy8gdGhlIGxhc3QgZGVjb3JhdGlvbiBsaW5lXHJcbiAgICAgICAgbGV0IGRpcmVjdGlvbiA9IHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcgPyAnbGVmdCcgOiAncmlnaHQnXHJcbiAgICAgICAgJChgI2xpbmVfc2htZXRyb18ke2RpcmVjdGlvbn1gKS5hdHRyKCdmaWxsJywgdGhpcy5fdGhlbWVDb2xvdXIpXHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9saW5lTmFtZXNbMF0ubWF0Y2goLyhcXGQqKVxcdysvKSkge1xyXG4gICAgICAgICAgICAvLyB0aGUgbGluZSBzdGFydHMgd2l0aCBudW1iZXJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhlIGxpbmUgc3RhcnRzIHdpdGggbGV0dGVyXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCcpLmF0dHIoJ2ZpbGwnLCAnI2ZmZicpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVN0bk5hbWVCZygpIHtcclxuICAgICAgICAkKCcjY3VycmVudF9iZycpLmhpZGUoKTsgIC8vIGZpeCB0aGUgbXlzdGVyaW91cyBibGFjayByZWN0XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIG1ha2Ugc3VyZSB0aGUgbGluZSBpcyBkcmF3IGJlZm9yZSBjb2xvclxyXG4gICAgc3RhdGljIGluaXRTVkcobGluZSkge1xyXG4gICAgICAgIGxpbmUuZHJhd1NWR0ZyYW1lKCk7XHJcbiAgICAgICAgbGluZS5zaG93RnJhbWVPdXRlcigpO1xyXG4gICAgICAgIGxpbmUuZHJhd1N0bnMoKTtcclxuXHJcbiAgICAgICAgLy8gY2hhbmdlIHRoZSBmdW5jIGNhbGwgaGVyZVxyXG4gICAgICAgIGxpbmUuZHJhd0xpbmUoKTtcclxuICAgICAgICBsaW5lLmZpbGxUaGVtZUNvbG91cigpO1xyXG4gICAgICAgIC8vIGNoYW5nZSB0aGUgZnVuYyBjYWxsIGhlcmVcclxuXHJcbiAgICAgICAgbGluZS5kcmF3U3RyaXAoKTtcclxuICAgICAgICBsaW5lLmRyYXdEZXN0SW5mbygpO1xyXG4gICAgICAgIGxpbmUubG9hZEZvbnRzKCk7XHJcbiAgICAgICAgbGluZS51cGRhdGVTdG5OYW1lQmcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2FsbCBmaWxsVGhlbWVDb2xvdXIgd2hlbiBmbGlwIGRpcmVjdGlvblxyXG4gICAgc2V0IGRpcmVjdGlvbih2YWwpIHtcclxuICAgICAgICB0aGlzLl9kaXJlY3Rpb24gPSB2YWw7XHJcbiAgICAgICAgc2V0UGFyYW1zKCdkaXJlY3Rpb24nLCB2YWwpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBbc3RuSWQsIHN0bkluc3RhbmNlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnN0YXRpb25zKSkge1xyXG4gICAgICAgICAgICBpZiAoWydsaW5lc3RhcnQnLCAnbGluZWVuZCddLmluY2x1ZGVzKHN0bklkKSkgeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICBzdG5JbnN0YW5jZS5zdGF0ZSA9IHRoaXMuX3N0blN0YXRlKHN0bklkKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFJNR0xpbmUuY2xlYXJTVkcoKTtcclxuICAgICAgICB0aGlzLmRyYXdTdG5zKCk7XHJcbiAgICAgICAgdGhpcy5kcmF3TGluZSgpO1xyXG5cclxuICAgICAgICAvLyBhZGQgdGhlIGZ1bmMgY2FsbCBoZXJlXHJcbiAgICAgICAgdGhpcy5maWxsVGhlbWVDb2xvdXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5kcmF3RGVzdEluZm8oKTtcclxuXHJcbiAgICAgICAgdGhpcy5sb2FkRm9udHMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gZ2V0IGRyYXdTdG5zIHJlY2FsbGVkXHJcbiAgICB1cGRhdGVTdG5UcmFuc2ZlcihzdG5JZDogSUQsIHR5cGUsIGluZm8gPSBudWxsKSB7XHJcbiAgICAgICAgc3VwZXIudXBkYXRlU3RuVHJhbnNmZXIoc3RuSWQsIHR5cGUsIGluZm8pXHJcblxyXG4gICAgICAgIC8vIGNsZWFyIHRoZSBvcmlnaW5hbCBzdGF0aW9uc1xyXG4gICAgICAgICQoJyNzdG5faWNvbnMnKS5lbXB0eSgpXHJcbiAgICAgICAgdGhpcy5kcmF3U3RucygpXHJcbiAgICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==