(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{16:function(t,e,s){"use strict";s.r(e);var n=s(8),i=s(1);class a extends i.m{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-50)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class r extends a{constructor(t,e){super(t,e),this._intInfos=e.interchange[0]}get html(){return $("<g>",{id:this.id}).append(...this.ungrpHTML)}get ungrpHTML(){return[this.iconHTML,this.nameHTML]}get ungrpIconHTML(){return[...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[i.d.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{id:`rmg-name__shmetro--${this.id}`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){let t=[],e=$(`#rmg-name__shmetro--${this.id}`),s=e.get(0).getBoundingClientRect(),n=s.right-s.left+5;this._intInfos.map((e,s)=>{var a=e[i.d.colour],r=$("<use>",{"xlink:href":"#int_sh",fill:a,transform:`translate(${n+25*s},-12)`,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&r.addClass("rmg-line__pass");let o=String(e[i.d.nameZH]).match(/(\d*)\w+/);if(o)var h=o[0];else h=String(e[i.d.nameZH]);var l=$("<text>",{transform:`translate(${n+10+25*s},8)`,class:"rmg-name__zh rmg-name__shmetro--line_name","text-anchor":"middle",fill:e[i.d.fg]}).text(h);t.push(r,l)});let a=e.parent();return a.attr("transform",`${a.attr("transform")}rotate(-50)`),t}get _nameClass(){return-1==this.state?"Pass":"Future"}}s.d(e,"RMGLineSH",(function(){return o}));class o extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":case"int3_l":case"int3_r":return new r(t,e);case"osi11_ul":case"osi11_pl":case"osi11_ur":case"osi11_pr":case"osi12_ul":case"osi12_pl":case"osi12_ur":case"osi12_pr":case"osi21_ul":case"osi21_pl":case"osi21_ur":case"osi21_pr":case"osi22_ul":case"osi22_pl":case"osi22_ur":case"osi22_pr":default:return new a(t,e)}}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50,e="l"==this._direction?1:-1,s=(this._svgDestWidth-e*t)/20;s="l"==this._direction?s:this._svgDestWidth-20;var n=90*(1-e);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${s},135)rotate(${n})`);var i=s+285*e;if($("#station_info_shmetro > #platform").attr("transform",`translate(${i},130)`),"r"===this._direction)var a="end",r=.8*this._svgDestWidth;else a="start",r=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${r},135)`,"text-anchor":a});var[o,h]=[[],[]];this[`${this._direction}ValidDests`].forEach(t=>{o.push(this.stations[t].name[0]),h.push(this.stations[t].name[1])}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${o.join("，")}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${h.join(", ")}`);let l="l"===this._direction?this._svgDestWidth:320;var[_,m]=this._lineNames,d=_.match(/(\d*)\w+/);d?(l-=180,_="号线",$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-120},70)`}),$("#station_info_shmetro > #line_number > text").text(d[0]).attr("transform",`translate(${l-70},170)`)):(l-=280,$("#station_info_shmetro > #line_number > rect").attr({style:`fill:${this._themeColour}`,transform:`translate(${l-10},60)`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(_),$("#station_info_shmetro > #line_name_text > text:last-child").text(m),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${l},135)`,"text-anchor":"start"});let c="";c="l"==this._direction?`M30,10 H ${this._svgDestWidth-20} V 20 H 20 Z`:`M20,10 H ${this._svgDestWidth-30} l 10,10 H 20 Z`,$("#line_shmetro_use").attr({transform:"translate(0,220)",d:c})}drawStns(){for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||$("#stn_icons").append(e.html);$("#stn_icons").html($("#stn_icons").html());for(let[t,e]of Object.entries(this.stations).filter(t=>t[1]instanceof r))$(`#rmg-name__shmetro--${t}`).parent().append(e.ungrpIconHTML);$("#stn_icons").html($("#stn_icons").html())}_stnYShare(t){if(["linestart","lineend"].includes(t)||this._stnIndegree(t)>1||this._stnOutdegree(t)>1)return 0;var e=this.stations[t].parents[0];return e?1==this._stnOutdegree(e)?this._stnYShare(e):0==this.stations[e].children.indexOf(t)?3:0:0}_linePath(t,e){var[s,n,i]=[],a={};const r=30;if(t.forEach(t=>{var[e,r]=["_stnRealX","_stnRealY"].map(e=>this[e](t));if(!n&&0!==n)return[s,i,n]=[t,e,r],void(a.start=[e,r]);0===r?r!=n&&(a.bifurcate=[i,n]):r!=n&&(a.bifurcate=[e,r]),a.end=[e,r],[s,i,n]=[t,e,r]}),a.hasOwnProperty("start")){if(a.hasOwnProperty("end")){if(a.hasOwnProperty("bifurcate")){let[t,s]=a.start,[n,i]=(a.end[0],a.bifurcate),[o,h]=a.end;return"main"===e?"l"===this._direction?h>s?`M ${t-r},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t-r-12},${s+6} Z`:`M ${o},${h-6} H ${n-r} L ${t},${s-6} l 0,12 L ${n-r},${i+6} L ${o},${h+6} Z`:h>s?`M ${t},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t},${s+6} Z`:`M ${o+r},${h-6} H ${n-r} L ${t},${s-6} l 0,12 L ${n-r},${i+6} L ${o+r+12},${h+6} Z`:(this._direction,h>s?`M ${t-r},${s-6} H ${n+r} L ${o},${h-6} l 0,12 L ${n+r},${i+6} L ${t-r},${s+6} Z`:`M ${t},${s-6} L ${n-r},${i-6} H ${o+r} l 0,12 L ${n-r},${i+6} L ${t},${s+6} Z`)}{let[t,s]=a.start,n=a.end[0];return"main"===e?"l"===this._direction?`M ${t-r},${s-6} H ${n} l 0,12 L ${t-42},${s+6} Z`:`M ${t},${s-6} H ${n+r} l 12,12 L ${t},${s+6} Z`:(this._direction,`M ${t-r},${s-6} H ${n+r} l 0,12 L ${t-r},${s+6} Z`)}}{let[t,s]=a.start;return"main"===e?"l"===this._direction?`M ${t},${s-6} L ${t-r},${s-6} l -12,12 L ${t},${s+6} Z`:`M ${t},${s-6} L ${t+r},${s-6} l 12,12 L ${t},${s+6} Z`:"l"===this._direction?`M ${t},${s-6} L ${t+r},${s-6} l 0,12 L ${t-r},${s+6} Z`:`M ${t-r},${s-6} L ${t},${s-6} l 0,12 L ${t-r},${s+6} Z`}}return""}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1]));let n=this._linePath(e,"main");(n||""!=n)&&$("#line_main").append($("<path>",{id:"line_main_path",d:n})),n=this._linePath(s,"pass"),(n||""!=n)&&$("#line_pass").append($("<path>",{id:"line_pass_path",d:n}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html())}fillThemeColour(){super.fillThemeColour(),$("path#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("path#stn_sh_pass").attr("stroke","#aaa"),$("path#int2_sh_pass").attr("stroke","#aaa"),$("path#line_main_path").attr("fill",this._themeColour),$("path#line_pass_path").attr("fill","#aaa"),$("#line_shmetro_use").attr("fill",this._themeColour),this._lineNames[0].match(/(\d*)\w+/)?$("#station_info_shmetro > #line_number > text").attr("fill","#fff"):$("#station_info_shmetro > #line_name_text").attr("fill","#fff"),$("#station_info_shmetro > #line_number > text").attr("fill",this._fgColour)}updateStnNameBg(){$("#current_bg").hide()}static initSVG(t){t.drawSVGFrame(),t.showFrameOuter(),t.drawStns(),t.drawLine(),t.fillThemeColour(),t.drawStrip(),t.drawDestInfo(),t.loadFonts(),t.updateStnNameBg()}set direction(t){super.direction=t,this.fillThemeColour()}set currentStnId(t){super.currentStnId=t,this.fillThemeColour()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),this.fillThemeColour(),$("#stn_icons").empty(),this.drawStns()}addStn(t,e,s,n){let[i,a]=super.addStn(t,e,s,n);return this.fillThemeColour(),[i,a]}set yPc(t){super.yPc=t;let e=t*this._svgHeight/50;$("g#main").attr("transform",`translate(0,${e})`)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvU3RhdGlvbi9TdGF0aW9uU0gudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0xpbmUvTGluZVNILnRzIl0sIm5hbWVzIjpbImlkIiwiZGF0YSIsInN1cGVyIiwidGhpcyIsInN0bk51bSIsIm51bSIsInkiLCJuYW1lRU5MbiIsIm5hbWUiLCJzcGxpdCIsImxlbmd0aCIsImR4IiwiX25hbWVTaGlmdCIsIl90aWNrUm90YXRpb24iLCJNYXRoIiwiY29zIiwiaWNvblR5cGUiLCJudW1DbGFzcyIsInN0YXRlIiwic3RhdGlvbl9pZCIsIiQiLCJ0cmFuc2Zvcm0iLCJ4IiwiYXBwZW5kIiwiY2xhc3MiLCJkeSIsIl9keGR5IiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiX2ludEluZm9zIiwiaW50ZXJjaGFuZ2UiLCJ1bmdycEhUTUwiLCJpY29uSFRNTCIsIm5hbWVIVE1MIiwiaW50VGlja0hUTUwiLCJzdHJva2UiLCJjb2xvdXIiLCJsaW5lRWxlbXMiLCJzdG5OYW1lRWxlbSIsImJjciIsImdldCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInJpZ2h0IiwibGVmdCIsIm1hcCIsInN0biIsImluZGV4IiwibGluZUljb25Db2xvdXIiLCJsaW5lSWNvbkVsZW0iLCJmaWxsIiwibGluZU51bWJlciIsIlN0cmluZyIsIm5hbWVaSCIsIm1hdGNoIiwibGluZU5hbWUiLCJsaW5lTmFtZUVsZW0iLCJmZyIsInB1c2giLCJzdG5JbmZvRWxlbSIsInBhcmVudCIsImF0dHIiLCJwYXJhbSIsInN0bklkIiwic3RuSW5mbyIsImNoYW5nZV90eXBlIiwiX3BsYXRmb3JtTnVtIiwiZmxhZ0xlbmd0aCIsIndpZHRoIiwiaXNMZWZ0IiwiX2RpcmVjdGlvbiIsImFycm93WCIsIl9zdmdEZXN0V2lkdGgiLCJhcnJvd1JvdGF0ZSIsInBsYXRmb3JtTnVtWCIsInR4dEFuY2hvciIsImRlc3ROYW1lWCIsImRlc3RpbmF0aW9uc196aCIsImRlc3RpbmF0aW9uc19lbiIsImZvckVhY2giLCJzdGF0aW9ucyIsImpvaW4iLCJsaW5lTmFtZVgiLCJsaW5lTmFtZVpIIiwibGluZU5hbWVFTiIsIl9saW5lTmFtZXMiLCJfdGhlbWVDb2xvdXIiLCJoaWRlIiwicGF0aCIsImQiLCJzdG5JbnN0YW5jZSIsIk9iamVjdCIsImVudHJpZXMiLCJpbmNsdWRlcyIsImh0bWwiLCJmaWx0ZXIiLCJ1bmdycEljb25IVE1MIiwiX3N0bkluZGVncmVlIiwiX3N0bk91dGRlZ3JlZSIsInN0blByZWQiLCJwYXJlbnRzIiwiX3N0bllTaGFyZSIsImNoaWxkcmVuIiwiaW5kZXhPZiIsInN0bklkcyIsInR5cGUiLCJwcmV2SWQiLCJwcmV2WSIsInByZXZYIiwiZSIsImZ1biIsImhhc093blByb3BlcnR5IiwieGIiLCJ5YiIsInhtIiwieW0iLCJoIiwicmVtb3ZlQ2xhc3MiLCJicmFuY2hlcyIsImJyYW5jaCIsImxpbmVNYWluU3RucyIsImxpbmVQYXNzU3RucyIsInVuc2hpZnQiLCJfbGluZVBhdGgiLCJmaWxsVGhlbWVDb2xvdXIiLCJfZmdDb2xvdXIiLCJsaW5lIiwiZHJhd1NWR0ZyYW1lIiwic2hvd0ZyYW1lT3V0ZXIiLCJkcmF3U3RucyIsImRyYXdMaW5lIiwiZHJhd1N0cmlwIiwiZHJhd0Rlc3RJbmZvIiwibG9hZEZvbnRzIiwidXBkYXRlU3RuTmFtZUJnIiwidmFsIiwiZGlyZWN0aW9uIiwiY3VycmVudFN0bklkIiwiaW5mbyIsInVwZGF0ZVN0blRyYW5zZmVyIiwiZW1wdHkiLCJwcmVwIiwibG9jIiwiZW5kIiwibmV3SWQiLCJuZXdJbmZvIiwiYWRkU3RuIiwieVBjIiwiX3N2Z0hlaWdodCJdLCJtYXBwaW5ncyI6ImtIQUtBLE1BQU0sVUFBcUIsSUFDdkIsWUFBWUEsRUFBUUMsR0FDaEJDLE1BQU1GLEVBQUlDLEdBQ1ZFLEtBQUtDLE9BQVNILEVBQUtJLElBR3ZCLGlCQUFtQixPQUFPLEVBQzFCLG9CQUFzQixPQUFPRixLQUFLRyxFQUFJLEVBQUksSUFBTSxFQUNoRCxZQUNJLElBQUlDLEVBQVdKLEtB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d0MsS0FBSyxPQUFRLFFBRzlEeEMsRUFBRSwyQ0FBMkN3QyxLQUFLLE9BQVEsUUFJOUR4QyxFQUFFLCtDQUErQ3dDLEtBQUssT0FBUXpELEtBQUt5SCxXQUd2RSxrQkFDSXhHLEVBQUUsZUFBZWtFLE9BSXJCLGVBQWV1QyxHQUNYQSxFQUFLQyxlQUNMRCxFQUFLRSxpQkFDTEYsRUFBS0csV0FHTEgsRUFBS0ksV0FDTEosRUFBS0Ysa0JBR0xFLEVBQUtLLFlBQ0xMLEVBQUtNLGVBQ0xOLEVBQUtPLFlBQ0xQLEVBQUtRLGtCQUlULGNBQWNDLEdBQ1ZwSSxNQUFNcUksVUFBWUQsRUFFbEJuSSxLQUFLd0gsa0JBSVQsaUJBQWlCVyxHQUNicEksTUFBTXNJLGFBQWVGLEVBRXJCbkksS0FBS3dILGtCQUlULGtCQUFrQjdELEVBQVcwQyxFQUFNaUMsRUFBTyxNQUN0Q3ZJLE1BQU13SSxrQkFBa0I1RSxFQUFPMEMsRUFBTWlDLEdBRXJDdEksS0FBS3dILGtCQUdMdkcsRUFBRSxjQUFjdUgsUUFDaEJ4SSxLQUFLNkgsV0FJVCxPQUFPWSxFQUEwQjlFLEVBQVcrRSxFQUFLQyxHQUM3QyxJQUFLQyxFQUFPQyxHQUFXOUksTUFBTStJLE9BQU9MLEVBQU05RSxFQUFPK0UsRUFBS0MsR0FFdEQsT0FEQTNJLEtBQUt3SCxrQkFDRSxDQUFDb0IsRUFBT0MsR0FJbkIsUUFBUVYsR0FDSnBJLE1BQU1nSixJQUFNWixFQUVaLElBQUloSSxFQUFJZ0ksRUFBTW5JLEtBQUtnSixXQUFhLEdBQ2hDL0gsRUFBRSxVQUFVd0MsS0FBSyxZQUFhLGVBQWV0RCIsImZpbGUiOiJMaW5lU0gubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUk1HU3RhdGlvbiwgSW50SW5mb1RhZywgSW50ZXJjaGFuZ2VJbmZvIH0gZnJvbSAnLi9TdGF0aW9uJztcclxuaW1wb3J0IHsgSUQsIE5hbWUsIEJyYW5jaEluZm8sIFN0YXRpb25JbmZvIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5cclxuY29uc3Qgc3RhdGlvbl9pZCA9ICdzdG5fc2gnXHJcblxyXG5jbGFzcyBSTUdTdGF0aW9uU0ggZXh0ZW5kcyBSTUdTdGF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zdG5OdW0gPSBkYXRhLm51bTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgX25hbWVTaGlmdCgpIHsgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICBnZXQgX3RpY2tSb3RhdGlvbigpIHsgcmV0dXJuIHRoaXMueSA+IDAgPyAxODAgOiAwOyB9XHJcbiAgICBnZXQgX2R4ZHkoKSB7XHJcbiAgICAgICAgdmFyIG5hbWVFTkxuID0gdGhpcy5uYW1lWzFdLnNwbGl0KCdcXFxcJykubGVuZ3RoO1xyXG4gICAgICAgIGxldCBkeDogbnVtYmVyO1xyXG4gICAgICAgIGlmICh0aGlzLl9uYW1lU2hpZnQpIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAtOSA6IDE2ICsgKG5hbWVFTkxuIC0gMSkgKiAxMiAqIE1hdGguY29zKC00NSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHggPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoMjQgKyAobmFtZUVOTG4gLSAxKSAqIDEyKSAqIE1hdGguY29zKC00NSkgOiAtNjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbGV0IGR4ID0gdGhpcy5fbmFtZVNoaWZ0ID8gLTggOiAoMjQgKyAobmFtZUVOTG4tMSkqMTIpICogTWF0aC5jb3MoLTQ1KTtcclxuICAgICAgICBsZXQgZHkgPSB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAoLTQgLSAyMS45MjE4NzUgLSAobmFtZUVOTG4gLSAxKSAqIDEyICogTWF0aC5jb3MoLTQ1KSkgOiAxNy41O1xyXG4gICAgICAgIC8vIHZhciBkeSA9ICgtNCAtIDIxLjkyMTg3NSAtIChuYW1lRU5Mbi0xKSoxMipNYXRoLmNvcygtNDUpKSAqICh0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAxIDogLTEpO1xyXG4gICAgICAgIHJldHVybiBbZHgsIGR5XVxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpY29uSFRNTCgpIHtcclxuICAgICAgICB2YXIgW2ljb25UeXBlLCBudW1DbGFzc10gPSAodGhpcy5zdGF0ZSA9PSAtMSkgPyBbc3RhdGlvbl9pZCArICdfcGFzcycsICdQYXNzJ10gOiBbc3RhdGlvbl9pZCwgJ0Z1dHVyZSddO1xyXG4gICAgICAgIHJldHVybiAkKCc8Zz4nLCB7IHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke3RoaXMueH0sJHt0aGlzLnl9KWAgfSlcclxuICAgICAgICAgICAgLmFwcGVuZCgkKCc8dXNlPicsIHsgJ3hsaW5rOmhyZWYnOiAnIycgKyBpY29uVHlwZSwgY2xhc3M6ICdybWctc3RuJyB9KSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG5hbWVIVE1MKCkge1xyXG4gICAgICAgIGxldCBbZHgsIGR5XSA9IHRoaXMuX2R4ZHlcclxuICAgICAgICByZXR1cm4gJCgnPGc+Jywge1xyXG4gICAgICAgICAgICAndHJhbnNmb3JtJzogYHRyYW5zbGF0ZSgke3RoaXMueCAtIGR4fSwke3RoaXMueSArIGR5fSlyb3RhdGUoLTUwKWAsXHJcbiAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6IHRoaXMuX3RpY2tSb3RhdGlvbiA9PT0gMCA/ICdzdGFydCcgOiAnZW5kJyxcclxuICAgICAgICAgICAgLy8gY2xhc3M6IGBOYW1lICR7dGhpcy5uYW1lQ2xhc3N9YFxyXG4gICAgICAgICAgICBjbGFzczogYE5hbWUgRnV0dXJlYCAgLy8gdG9kbzogZml4IHRoaXNcclxuICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgICQoJzx0ZXh0PicpLmFkZENsYXNzKCdybWctbmFtZV9femggcm1nLW5hbWVfX3NobWV0cm8tLXN0YXRpb24nKS50ZXh0KHRoaXMubmFtZVswXSlcclxuICAgICAgICApLmFwcGVuZChcclxuICAgICAgICAgICAgJCgnPHRleHQ+Jywge1xyXG4gICAgICAgICAgICAgICAgZHk6IDE1LCBjbGFzczogJ3JtZy1uYW1lX19lbiBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbidcclxuICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVswXSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRzcGFuPicsIHtcclxuICAgICAgICAgICAgICAgICAgICAneCc6IDAsICdkeSc6IDEyXHJcbiAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzFdKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgSW50U3RhdGlvblNIIGV4dGVuZHMgUk1HU3RhdGlvblNIIHtcclxuICAgIHByb3RlY3RlZCBfaW50SW5mb3M6IEludGVyY2hhbmdlSW5mb1tdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGlkOiBJRCwgZGF0YTogU3RhdGlvbkluZm8pIHtcclxuICAgICAgICBzdXBlcihpZCwgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MgPSBkYXRhLmludGVyY2hhbmdlWzBdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBhcHBlbmQgZG9tIGFuZCB0aGVuIGdldEJvdW5kaW5nQ2xpZW50UmVjdFxyXG4gICAgLy8gdG8gZ2V0IHRoZSBleGFjdCBwb3NpdGlvbiB3aGVyZSBpbnQgaWNvbiBjYW4gYmUgZml0XHJcbiAgICBnZXQgaHRtbCgpIHtcclxuICAgICAgICByZXR1cm4gJCgnPGc+JywgeyBpZDogdGhpcy5pZCB9KS5hcHBlbmQoLi4udGhpcy51bmdycEhUTUwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBnZXQgYWxsIGRyYXdpbmcgZnVuY3Rpb24gdG8gYmUgY2FsbGVkXHJcbiAgICBnZXQgdW5ncnBIVE1MKCkge1xyXG4gICAgICAgIHJldHVybiBbdGhpcy5pY29uSFRNTCwgdGhpcy5uYW1lSFRNTF07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHVuZ3JwSWNvbkhUTUwoKSB7XHJcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLmludFRpY2tIVE1MXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGludGVyY2hhbmdlIHN0YXRpb24gaWNvbiBvbiBtYWluIGxpbmVcclxuICAgIGdldCBpY29uSFRNTCgpIHtcclxuICAgICAgICB2YXIgW2ljb25UeXBlLCBudW1DbGFzc10gPSAodGhpcy5zdGF0ZSA9PSAtMSkgPyBbJ2ludDJfc2hfcGFzcycsICdQYXNzJ10gOiBbJ2ludDJfc2gnLCAnRnV0dXJlJ107XHJcbiAgICAgICAgcmV0dXJuICQoJzxnPicsIHsgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7dGhpcy54fSwke3RoaXMueX0pYCB9KVxyXG4gICAgICAgICAgICAuYXBwZW5kKCQoJzx1c2U+JywgeyAneGxpbms6aHJlZic6ICcjJyArIGljb25UeXBlLCBjbGFzczogJ3JtZy1zdG4nLCBzdHJva2U6IHRoaXMuX2ludEluZm9zW0ludEluZm9UYWcuY29sb3VyXSB9KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVndWxhciBzdGF0aW9uIG5hbWVcclxuICAgIGdldCBuYW1lSFRNTCgpIHtcclxuICAgICAgICBsZXQgW2R4LCBkeV0gPSB0aGlzLl9keGR5O1xyXG4gICAgICAgIC8vIHdyYXAgdGhlIG5hbWUsIGRlY3JvX2xpbmUgYW5kIGludF9saW5lIHVuZGVyIGcgaW4gb3JkZXIgdG8gcm90YXRlIGF0IG9uY2VcclxuICAgICAgICByZXR1cm4gJCgnPGc+Jywge1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHt0aGlzLnggLSBkeH0sJHt0aGlzLnkgKyBkeX0pYCwgIC8vcm90YXRlKC02MClcclxuICAgICAgICB9KS5hcHBlbmQoXHJcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBuYW1lIHRleHRcclxuICAgICAgICAgICAgJCgnPGc+Jywge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGBybWctbmFtZV9fc2htZXRyby0tJHt0aGlzLmlkfWAsXHJcbiAgICAgICAgICAgICAgICAndGV4dC1hbmNob3InOiB0aGlzLl90aWNrUm90YXRpb24gPT09IDAgPyAnc3RhcnQnIDogJ2VuZCcsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogYE5hbWUgRnV0dXJlYCAgLy8gdG9kbzogZml4IHRoaXNcclxuICAgICAgICAgICAgfSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgJCgnPHRleHQ+JykuYWRkQ2xhc3MoJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tc3RhdGlvbicpLnRleHQodGhpcy5uYW1lWzBdKVxyXG4gICAgICAgICAgICApLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICQoJzx0ZXh0PicsIHtcclxuICAgICAgICAgICAgICAgICAgICBkeTogMTUsIGNsYXNzOiAncm1nLW5hbWVfX2VuIHJtZy1uYW1lX19zaG1ldHJvLS1zdGF0aW9uJ1xyXG4gICAgICAgICAgICAgICAgfSkudGV4dCh0aGlzLm5hbWVbMV0uc3BsaXQoJ1xcXFwnKVswXSkuYXBwZW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICQoJzx0c3Bhbj4nLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd4JzogMCwgJ2R5JzogMTJcclxuICAgICAgICAgICAgICAgICAgICB9KS50ZXh0KHRoaXMubmFtZVsxXS5zcGxpdCgnXFxcXCcpWzFdKVxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGludGVyY2hhbmdlIHN0YXRpb24gaWNvbiBhZnRlciB0aGUgc3RhdGlvbiBuYW1lXHJcbiAgICBnZXQgaW50VGlja0hUTUwoKSB7XHJcbiAgICAgICAgbGV0IGxpbmVFbGVtczogSlF1ZXJ5PEhUTUxFbGVtZW50PltdID0gW11cclxuXHJcbiAgICAgICAgLy8gZ2V0IHRoZSBleGFjdCBzdGF0aW9uIG5hbWUgd2lkdGggc28gdGhhdCB0aGVcclxuICAgICAgICAvLyBpbnRlcmNoYW5nZSBzdGF0aW9uIGljb24gY2FuIGJlIHJpZ2h0IGFmdGVyIHRoZSBzdGF0aW9uIG5hbWVcclxuICAgICAgICBsZXQgc3RuTmFtZUVsZW0gPSAkKGAjcm1nLW5hbWVfX3NobWV0cm8tLSR7dGhpcy5pZH1gKVxyXG4gICAgICAgIGxldCBiY3IgPSBzdG5OYW1lRWxlbS5nZXQoMCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcclxuICAgICAgICBsZXQgZHggPSBiY3IucmlnaHQgLSBiY3IubGVmdCArIDVcclxuXHJcbiAgICAgICAgdGhpcy5faW50SW5mb3MubWFwKChzdG4sIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGludGVyY2hhbmdlIGxpbmUgaWNvbiBhZnRlciBzdGF0aW9uIG5hbWVcclxuICAgICAgICAgICAgdmFyIGxpbmVJY29uQ29sb3VyID0gc3RuW0ludEluZm9UYWcuY29sb3VyXTtcclxuICAgICAgICAgICAgdmFyIGxpbmVJY29uRWxlbSA9ICQoJzx1c2U+Jywge1xyXG4gICAgICAgICAgICAgICAgJ3hsaW5rOmhyZWYnOiAnI2ludF9zaCcsXHJcbiAgICAgICAgICAgICAgICBmaWxsOiBsaW5lSWNvbkNvbG91cixcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4ICsgaW5kZXggKiAyNX0sLTEyKWAsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3JtZy1saW5lX19zaG1ldHJvIHJtZy1saW5lX19jaGFuZ2UnLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGxpbmVJY29uRWxlbS5hZGRDbGFzcygncm1nLWxpbmVfX3Bhc3MnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gbGluZSBzdGFydHMgd2l0aCBudW1iZXJzIG9yIGxldHRlcnNcclxuICAgICAgICAgICAgbGV0IGxpbmVOdW1iZXIgPSBTdHJpbmcoc3RuW0ludEluZm9UYWcubmFtZVpIXSkubWF0Y2goLyhcXGQqKVxcdysvKVxyXG4gICAgICAgICAgICBpZiAobGluZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmVOYW1lID0gbGluZU51bWJlclswXVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbmVOYW1lID0gU3RyaW5nKHN0bltJbnRJbmZvVGFnLm5hbWVaSF0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gaW50ZXJjaGFuZ2UgbGluZSBuYW1lXHJcbiAgICAgICAgICAgIHZhciBsaW5lTmFtZUVsZW0gPSAkKCc8dGV4dD4nLCB7XHJcbiAgICAgICAgICAgICAgICAvLyBUb2RvOiBmaXggdGhpcyBoYXJkLWNvZGVkIGNlbnRlcigxMCkgcG9zaXRpb25cclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgke2R4ICsgMTAgKyBpbmRleCAqIDI1fSw4KWAsXHJcbiAgICAgICAgICAgICAgICBjbGFzczogJ3JtZy1uYW1lX196aCBybWctbmFtZV9fc2htZXRyby0tbGluZV9uYW1lJyxcclxuICAgICAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICdtaWRkbGUnLFxyXG4gICAgICAgICAgICAgICAgZmlsbDogc3RuW0ludEluZm9UYWcuZmddLFxyXG4gICAgICAgICAgICB9KS50ZXh0KGxpbmVOYW1lKVxyXG5cclxuICAgICAgICAgICAgbGluZUVsZW1zLnB1c2gobGluZUljb25FbGVtLCBsaW5lTmFtZUVsZW0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy8gcm90YXRlIHRoZSBzdGF0aW9uIGluZm8gbm93XHJcbiAgICAgICAgLy8gb3RoZXIgd2lzZSB0aGUgYmNyIHdpbGwgYmUgaW5hY2N1cmF0ZSBkdWUgdG8gdGhlIHJvdGF0aW9uXHJcbiAgICAgICAgbGV0IHN0bkluZm9FbGVtID0gc3RuTmFtZUVsZW0ucGFyZW50KCk7XHJcbiAgICAgICAgc3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJywgYCR7c3RuSW5mb0VsZW0uYXR0cigndHJhbnNmb3JtJyl9cm90YXRlKC01MClgKVxyXG5cclxuICAgICAgICByZXR1cm4gbGluZUVsZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCBfbmFtZUNsYXNzKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5zdGF0ZSA9PSAtMSkgPyAnUGFzcycgOiAnRnV0dXJlJztcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgUk1HU3RhdGlvblNILCBJbnRTdGF0aW9uU0gsIHN0YXRpb25faWQgfTtcclxuIiwiaW1wb3J0IHsgUk1HTGluZSB9IGZyb20gJy4vTGluZSc7XHJcbmltcG9ydCB7IFJNR1N0YXRpb25TSCwgSW50U3RhdGlvblNILCBzdGF0aW9uX2lkIH0gZnJvbSAnLi4vU3RhdGlvbi9TdGF0aW9uU0gnO1xyXG5pbXBvcnQgeyBSTUdTdGF0aW9uIH0gZnJvbSAnLi4vU3RhdGlvbi9TdGF0aW9uJztcclxuXHJcbmltcG9ydCB7IElELCBOYW1lLCBTdGF0aW9uSW5mbywgUk1HUGFyYW0sIHNldFBhcmFtcyB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBSTUdMaW5lU0ggZXh0ZW5kcyBSTUdMaW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtKSB7XHJcbiAgICAgICAgc3VwZXIocGFyYW0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9pbml0U3RuSW5zdGFuY2Uoc3RuSWQ6IElELCBzdG5JbmZvOiBTdGF0aW9uSW5mbyk6IFJNR1N0YXRpb24ge1xyXG4gICAgICAgIHN3aXRjaCAoc3RuSW5mby5jaGFuZ2VfdHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlICdpbnQyJzpcclxuICAgICAgICAgICAgY2FzZSAnaW50M19sJzpcclxuICAgICAgICAgICAgY2FzZSAnaW50M19yJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW50U3RhdGlvblNIKHN0bklkLCBzdG5JbmZvKTtcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTFfdWwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMV9wbCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTExX3VyJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTFfcHInOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMl91bCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTEyX3BsJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMTJfdXInOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kxMl9wcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIxX3VsJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjFfcGwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kyMV91cic6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIxX3ByJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjJfdWwnOlxyXG4gICAgICAgICAgICBjYXNlICdvc2kyMl9wbCc6XHJcbiAgICAgICAgICAgIGNhc2UgJ29zaTIyX3VyJzpcclxuICAgICAgICAgICAgY2FzZSAnb3NpMjJfcHInOlxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSTUdTdGF0aW9uU0goc3RuSWQsIHN0bkluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBkcmF3IHRoZSBkZXN0aW5hdGlvblxyXG4gICAgZHJhd0Rlc3RJbmZvKCkge1xyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNwbGF0Zm9ybSA+IHRleHQnKS50ZXh0KHRoaXMuX3BsYXRmb3JtTnVtKTtcclxuXHJcbiAgICAgICAgdmFyIGJjciA9ICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNkZXN0X3RleHQnKVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgZmxhZ0xlbmd0aCA9IDE2MCArIDE1MCArIGJjci53aWR0aCArIDQ1ICsgNTA7XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8gYXJyb3dcclxuICAgICAgICB2YXIgaXNMZWZ0ID0gKHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcpID8gMSA6IC0xO1xyXG4gICAgICAgIHZhciBhcnJvd1ggPSAodGhpcy5fc3ZnRGVzdFdpZHRoIC0gaXNMZWZ0ICogZmxhZ0xlbmd0aCkgLyAyMDtcclxuICAgICAgICBhcnJvd1ggPSAodGhpcy5fZGlyZWN0aW9uID09ICdsJykgPyBhcnJvd1ggOiB0aGlzLl9zdmdEZXN0V2lkdGggLSAyMDtcclxuICAgICAgICB2YXIgYXJyb3dSb3RhdGUgPSA5MCAqICgxIC0gaXNMZWZ0KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjYXJyb3dfbGVmdF91c2UnKS5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7YXJyb3dYfSwxMzUpcm90YXRlKCR7YXJyb3dSb3RhdGV9KWApO1xyXG5cclxuICAgICAgICAvLyBub3QgaW4gdXNlIG5vd1xyXG4gICAgICAgIHZhciBwbGF0Zm9ybU51bVggPSBhcnJvd1ggKyBpc0xlZnQgKiAoMTYwICsgNTAgKyA3NSk7XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI3BsYXRmb3JtJykuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke3BsYXRmb3JtTnVtWH0sMTMwKWApO1xyXG5cclxuICAgICAgICAvLyBsaXN0IHRoZSBkZXN0aW5hdGlvbiB0ZXh0XHJcbiAgICAgICAgLy8gVG9kbzogZml4IHN2Z19kZXN0X3dpZHRoKjAuOCwgdGhpcyBoYXMgb25seSBiZWVuIHRlc3RlZCBvbiAxMDAwIHdpZHRoXHJcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ3InKSB7XHJcbiAgICAgICAgICAgIHZhciB0eHRBbmNob3IgPSAnZW5kJztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuODtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdHh0QW5jaG9yID0gJ3N0YXJ0JztcclxuICAgICAgICAgICAgdmFyIGRlc3ROYW1lWCA9IHRoaXMuX3N2Z0Rlc3RXaWR0aCAqIDAuMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2Rlc3RfdGV4dCcpLmF0dHIoe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoJHtkZXN0TmFtZVh9LDEzNSlgLFxyXG4gICAgICAgICAgICAndGV4dC1hbmNob3InOiB0eHRBbmNob3JcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gZm9yIGVhY2ggbGVmdCB2YWxpZCBkZXN0aW5hdGlvbnMsIGdldCB0aGUgbmFtZSBmcm9tIGlkXHJcbiAgICAgICAgdmFyIFtkZXN0aW5hdGlvbnNfemgsIGRlc3RpbmF0aW9uc19lbl06IFN0cmluZ1tdW10gPSBbW10sIFtdXVxyXG4gICAgICAgIHRoaXNbYCR7dGhpcy5fZGlyZWN0aW9ufVZhbGlkRGVzdHNgXS5mb3JFYWNoKHN0biA9PiB7XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uc196aC5wdXNoKHRoaXMuc3RhdGlvbnNbc3RuXS5uYW1lWzBdKVxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNfZW4ucHVzaCh0aGlzLnN0YXRpb25zW3N0bl0ubmFtZVsxXSlcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpmaXJzdC1jaGlsZCcpLnRleHQoYOW+gCR7ZGVzdGluYXRpb25zX3poLmpvaW4oXCLvvIxcIil9YClcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjZGVzdF90ZXh0ID4gdGV4dDpsYXN0LWNoaWxkJykudGV4dChgVG8gJHtkZXN0aW5hdGlvbnNfZW4uam9pbihcIiwgXCIpfWApXHJcblxyXG4gICAgICAgIC8vIHByZXBhcmUgZm9yIHRoZSBsaW5lIG5hbWVcclxuICAgICAgICBsZXQgbGluZU5hbWVYID0gdGhpcy5fZGlyZWN0aW9uID09PSAnbCcgPyB0aGlzLl9zdmdEZXN0V2lkdGggOiAzMjBcclxuICAgICAgICB2YXIgW2xpbmVOYW1lWkgsIGxpbmVOYW1lRU5dID0gdGhpcy5fbGluZU5hbWVzO1xyXG5cclxuICAgICAgICAvLyBsaW5lIHN0YXJ0cyB3aXRoIG51bWJlcnMgb3IgbGV0dGVyc1xyXG4gICAgICAgIHZhciBsaW5lTnVtYmVyID0gbGluZU5hbWVaSC5tYXRjaCgvKFxcZCopXFx3Ky8pXHJcbiAgICAgICAgaWYgKGxpbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgbGluZU5hbWVYIC09IDE4MDtcclxuICAgICAgICAgICAgbGluZU5hbWVaSCA9IFwi5Y+357q/XCJcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gcmVjdCcpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgJ3N0eWxlJzogYGZpbGw6JHt0aGlzLl90aGVtZUNvbG91cn1gLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMjB9LDcwKWBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpXHJcbiAgICAgICAgICAgICAgICAudGV4dChsaW5lTnVtYmVyWzBdKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSA3MH0sMTcwKWApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGluZU5hbWVYIC09IDI4MDtcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gcmVjdCcpLmF0dHIoe1xyXG4gICAgICAgICAgICAgICAgJ3N0eWxlJzogYGZpbGw6JHt0aGlzLl90aGVtZUNvbG91cn1gLFxyXG4gICAgICAgICAgICAgICAgJ3RyYW5zZm9ybSc6IGB0cmFuc2xhdGUoJHtsaW5lTmFtZVggLSAxMH0sNjApYCxcclxuICAgICAgICAgICAgICAgICd3aWR0aCc6IDI2MCxcclxuICAgICAgICAgICAgICAgICdoZWlnaHQnOiAxNTBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgJCgnI3N0YXRpb25faW5mb19zaG1ldHJvID4gI2xpbmVfbnVtYmVyID4gdGV4dCcpLmhpZGUoKVxyXG5cclxuICAgICAgICAgICAgLy8gVG9kbzogc2V0IHRoZSBlbmcgaW4gdGhlIG1pZGRsZVxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0Omxhc3QtY2hpbGQnKS5hdHRyKCdkeCcsIDEwKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0IHRoZSBsaW5lIG5hbWVcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQgPiB0ZXh0OmZpcnN0LWNoaWxkJykudGV4dChsaW5lTmFtZVpIKVxyXG4gICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX25hbWVfdGV4dCA+IHRleHQ6bGFzdC1jaGlsZCcpLnRleHQobGluZU5hbWVFTilcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQnKS5hdHRyKHtcclxuICAgICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlKCR7bGluZU5hbWVYfSwxMzUpYCxcclxuICAgICAgICAgICAgJ3RleHQtYW5jaG9yJzogJ3N0YXJ0J1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyB0aGUgbGFzdCBkZWNvcmF0aW9uIGxpbmVcclxuICAgICAgICBsZXQgcGF0aCA9ICcnXHJcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PSAnbCcpIHtcclxuICAgICAgICAgICAgcGF0aCA9IGBNMzAsMTAgSCAke3RoaXMuX3N2Z0Rlc3RXaWR0aCAtIDIwfSBWIDIwIEggMjAgWmBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwYXRoID0gYE0yMCwxMCBIICR7dGhpcy5fc3ZnRGVzdFdpZHRoIC0gMzB9IGwgMTAsMTAgSCAyMCBaYFxyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjbGluZV9zaG1ldHJvX3VzZScpLmF0dHIoe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGUoMCwyMjApYCxcclxuICAgICAgICAgICAgZDogcGF0aCxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBhcHBlbmQgZG9tIGFuZCB0aGVuIGdldEJvdW5kaW5nQ2xpZW50UmVjdFxyXG4gICAgLy8gdG8gZ2V0IHRoZSBleGFjdCBwb3NpdGlvbiB3aGVyZSBpbnQgaWNvbiBjYW4gYmUgZml0XHJcbiAgICBkcmF3U3RucygpIHtcclxuICAgICAgICBmb3IgKGxldCBbc3RuSWQsIHN0bkluc3RhbmNlXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLnN0YXRpb25zKSkge1xyXG4gICAgICAgICAgICBpZiAoWydsaW5lc3RhcnQnLCAnbGluZWVuZCddLmluY2x1ZGVzKHN0bklkKSkgeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAkKCcjc3RuX2ljb25zJykuYXBwZW5kKHN0bkluc3RhbmNlLmh0bWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcjc3RuX2ljb25zJykuaHRtbCgkKCcjc3RuX2ljb25zJykuaHRtbCgpKTsgLy8gUmVmcmVzaCBET01cclxuXHJcbiAgICAgICAgZm9yIChsZXQgW3N0bklkLCBzdG5JbnN0YW5jZV0gb2YgT2JqZWN0LmVudHJpZXModGhpcy5zdGF0aW9ucylcclxuICAgICAgICAgICAgLmZpbHRlcihzdG4gPT4gc3RuWzFdIGluc3RhbmNlb2YgSW50U3RhdGlvblNIKSBhcyBbSUQsIEludFN0YXRpb25TSF1bXSkge1xyXG4gICAgICAgICAgICAkKGAjcm1nLW5hbWVfX3NobWV0cm8tLSR7c3RuSWR9YCkucGFyZW50KCkuYXBwZW5kKHN0bkluc3RhbmNlLnVuZ3JwSWNvbkhUTUwpXHJcbiAgICAgICAgfVxyXG4gICAgICAgICQoJyNzdG5faWNvbnMnKS5odG1sKCQoJyNzdG5faWNvbnMnKS5odG1sKCkpOyAvLyBSZWZyZXNoIERPTVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBjaGFuZ2UgdGhlIHkgb2YgYnJhbmNoIHN0YXRpb25cclxuICAgIF9zdG5ZU2hhcmUoc3RuSWQpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChbJ2xpbmVzdGFydCcsICdsaW5lZW5kJ10uaW5jbHVkZXMoc3RuSWQpIHx8IHRoaXMuX3N0bkluZGVncmVlKHN0bklkKSA+IDEgfHwgdGhpcy5fc3RuT3V0ZGVncmVlKHN0bklkKSA+IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdG5QcmVkID0gdGhpcy5zdGF0aW9uc1tzdG5JZF0ucGFyZW50c1swXTtcclxuICAgICAgICBpZiAoc3RuUHJlZCkge1xyXG4gICAgICAgICAgICAvLyBwYXJlbnQgZXhpc3RcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0bk91dGRlZ3JlZShzdG5QcmVkKSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBubyBzaWJsaW5nLCB0aGVuIHkgc2FtZSBhcyBwYXJlbnRcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdG5ZU2hhcmUoc3RuUHJlZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzaWJsaW5nIGV4aXN0cywgdGhlbiB5IGRlcGVuZHMgb24gaXRzIGlkeCBvZiBiZWluZyBjaGlsZHJlblxyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJld3JpdGUgdGhpcyB0byBtb3ZlIHRoZSBtYWluIGxpbmUgb24gdGhlIHNhbWUgaGVpZ2h0IG9mIHRoZSByZXN0XHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgYnJhbmNoIGEgYml0IGF3YXkgZnJvbSB0aGUgbWFpbiBsaW5lXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuc3RhdGlvbnNbc3RuUHJlZF0uY2hpbGRyZW4uaW5kZXhPZihzdG5JZCkgPT0gMCkgPyAzIDogMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG5vIHBhcmVudCwgbXVzdCBiZSBsaW5lc3RhcnRcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9saW5lUGF0aChzdG5JZHM6IElEW10sIHR5cGU/OiAnbWFpbicgfCAncGFzcycpOiBzdHJpbmcge1xyXG4gICAgICAgIHZhciBbcHJldklkLCBwcmV2WSwgcHJldlhdOiBbc3RyaW5nPywgbnVtYmVyPywgbnVtYmVyP10gPSBbXVxyXG4gICAgICAgIHZhciBwYXRoOiB7IFtrZXk6IHN0cmluZ106IG51bWJlcltdIH0gPSB7fVxyXG4gICAgICAgIGNvbnN0IGUgPSAzMFxyXG5cclxuICAgICAgICBzdG5JZHMuZm9yRWFjaChzdG5JZCA9PiB7XHJcbiAgICAgICAgICAgIHZhciBbeCwgeV0gPSBbJ19zdG5SZWFsWCcsICdfc3RuUmVhbFknXS5tYXAoZnVuID0+IHRoaXNbZnVuXShzdG5JZCkpXHJcbiAgICAgICAgICAgIGlmICghcHJldlkgJiYgcHJldlkgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIFtwcmV2SWQsIHByZXZYLCBwcmV2WV0gPSBbc3RuSWQsIHgsIHldO1xyXG4gICAgICAgICAgICAgICAgcGF0aFsnc3RhcnQnXSA9IFt4LCB5XTtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh5ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtZXJnZSBiYWNrIHRvIG1haW4gbGluZVxyXG4gICAgICAgICAgICAgICAgaWYgKHkgIT0gcHJldlkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoWydiaWZ1cmNhdGUnXSA9IFtwcmV2WCwgcHJldlldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBvbiB0aGUgYnJhbmNoIGxpbmVcclxuICAgICAgICAgICAgICAgIGlmICh5ICE9IHByZXZZKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGF0aFsnYmlmdXJjYXRlJ10gPSBbeCwgeV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXRoWydlbmQnXSA9IFt4LCB5XTtcclxuICAgICAgICAgICAgW3ByZXZJZCwgcHJldlgsIHByZXZZXSA9IFtzdG5JZCwgeCwgeV07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGdlbmVyYXRlIHBhdGhcclxuICAgICAgICBpZiAoIXBhdGguaGFzT3duUHJvcGVydHkoJ3N0YXJ0JykpIHtcclxuICAgICAgICAgICAgLy8gbm8gbGluZSBnZW5lcmF0ZWRcclxuICAgICAgICAgICAgLy8ga2V5cyBpbiBwYXRoOiBub25lXHJcbiAgICAgICAgICAgIHJldHVybiAnJ1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIXBhdGguaGFzT3duUHJvcGVydHkoJ2VuZCcpKSB7XHJcbiAgICAgICAgICAgIC8vIGxpdHRlIGxpbmUgKG9ubHkgYmV5b25kIHRlcm1pbmFsIHN0YXRpb24pXHJcbiAgICAgICAgICAgIC8vIGtleXMgaW4gcGF0aDogc3RhcnRcclxuICAgICAgICAgICAgbGV0IFt4LCB5XSA9IHBhdGhbJ3N0YXJ0J11cclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdtYWluJykge1xyXG4gICAgICAgICAgICAgICAgLy8gY3VycmVudCBhdCB0ZXJtaW5hbChlbmQpIHN0YXRpb24sIGRyYXcgdGhlIGxpdHRlIG1haW4gbGluZVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2wnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eH0sJHt5IC0gNn0gTCAke3ggLSBlfSwke3kgLSA2fSBsIC0xMiwxMiBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eH0sJHt5IC0gNn0gTCAke3ggKyBlfSwke3kgLSA2fSBsIDEyLDEyIEwgJHt4fSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gdHlwZSA9PT0gJ3Bhc3MnXHJcbiAgICAgICAgICAgICAgICAvLyBjdXJyZW50IGF0IHRlcm1pbmFsKHN0YXJ0KSBzdGF0aW9uLCBkcmF3IHRoZSBsaXR0ZSBwYXNzIGxpbmVcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3h9LCR7eSAtIDZ9IEwgJHt4ICsgZX0sJHt5IC0gNn0gbCAwLDEyIEwgJHt4IC0gZX0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eCAtIGV9LCR7eSAtIDZ9IEwgJHt4fSwke3kgLSA2fSBsIDAsMTIgTCAke3ggLSBlfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCFwYXRoLmhhc093blByb3BlcnR5KCdiaWZ1cmNhdGUnKSkge1xyXG4gICAgICAgICAgICAvLyBnZW5lcmFsIG1haW4gbGluZVxyXG4gICAgICAgICAgICAvLyBrZXlzIGluIHBhdGg6IHN0YXJ0LCBlbmRcclxuICAgICAgICAgICAgbGV0IFt4LCB5XSA9IHBhdGhbJ3N0YXJ0J10sIGggPSBwYXRoWydlbmQnXVswXVxyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ21haW4nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4IC0gZX0sJHt5IC0gNn0gSCAke2h9IGwgMCwxMiBMICR7eCAtIDQyfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4fSwke3kgLSA2fSBIICR7aCArIGV9IGwgMTIsMTIgTCAke3h9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0eXBlID09PSAncGFzcydcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09ICdsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3ggLSBlfSwke3kgLSA2fSBIICR7aCArIGV9IGwgMCwxMiBMICR7eCAtIGV9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3ggLSBlfSwke3kgLSA2fSBIICR7aCArIGV9IGwgMCwxMiBMICR7eCAtIGV9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBtYWluIGxpbmUgYmlmdXJjYXRlIGhlcmUgdG8gYmVjb21lIHRoZSBicmFuY2ggbGluZVxyXG4gICAgICAgICAgICAvLyBhbmQgcGF0aCByZXR1cm4gaGVyZSBhcmUgb25seSBicmFuY2ggbGluZVxyXG4gICAgICAgICAgICAvLyBrZXlzIGluIHBhdGg6IHN0YXJ0LCBiaWZ1cmNhdGUsIGVuZFxyXG5cclxuICAgICAgICAgICAgLy8gVG9kbzogZGlzYWJsZSBsb3dlciBicmFuY2hcclxuICAgICAgICAgICAgbGV0IFt4LCB5XSA9IHBhdGhbJ3N0YXJ0J10sIGggPSBwYXRoWydlbmQnXVswXVxyXG4gICAgICAgICAgICBsZXQgW3hiLCB5Yl0gPSBwYXRoWydiaWZ1cmNhdGUnXSwgW3htLCB5bV0gPSBwYXRoWydlbmQnXVxyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ21haW4nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSAnbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeW0gPiB5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1haW4gbGluZSwgbGVmdCBkaXJlY3Rpb24sIGNlbnRlciB0byB1cHBlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4IC0gZX0sJHt5IC0gNn0gSCAke3hiICsgZX0gTCAke3htfSwke3ltIC0gNn0gbCAwLDEyIEwgJHt4YiArIGV9LCR7eWIgKyA2fSBMICR7eCAtIGUgLSAxMn0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWluIGxpbmUsIGxlZnQgZGlyZWN0aW9uLCB1cHBlciB0byBjZW50ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBzYW1lIGFzIHRoZSBvdGhlciwgYnV0IHJlcGxhY2UgeCB3aXRoIHhtIGFuZCB4bSB3aXRoIHhcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eG19LCR7eW0gLSA2fSBIICR7eGIgLSBlfSBMICR7eH0sJHt5IC0gNn0gbCAwLDEyIEwgJHt4YiAtIGV9LCR7eWIgKyA2fSBMICR7eG19LCR7eW0gKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHltID4geSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWluIGxpbmUsIHJpZ2h0IGRpcmVjdGlvbiwgdXBwZXIgdG8gY2VudGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgTSAke3h9LCR7eSAtIDZ9IEggJHt4YiArIGV9IEwgJHt4bX0sJHt5bSAtIDZ9IGwgMCwxMiBMICR7eGIgKyBlfSwke3liICsgNn0gTCAke3h9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFpbiBsaW5lLCByaWdodCBkaXJlY3Rpb24sIGNlbnRlciB0byB1cHBlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHNhbWUgYXMgdGhlIG90aGVyLCBidXQgcmVwbGFjZSB4IHdpdGggeG0gYW5kIHhtIHdpdGggeFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4bSArIGV9LCR7eW0gLSA2fSBIICR7eGIgLSBlfSBMICR7eH0sJHt5IC0gNn0gbCAwLDEyIEwgJHt4YiAtIGV9LCR7eWIgKyA2fSBMICR7eG0gKyBlICsgMTJ9LCR7eW0gKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHR5cGUgPT09ICdwYXNzJ1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2wnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHltID4geSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwYXNzIGxpbmUsIGxlZnQgZGlyZWN0aW9uLCBjZW50ZXIgdG8gdXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBNICR7eCAtIGV9LCR7eSAtIDZ9IEggJHt4YiArIGV9IEwgJHt4bX0sJHt5bSAtIDZ9IGwgMCwxMiBMICR7eGIgKyBlfSwke3liICsgNn0gTCAke3ggLSBlfSwke3kgKyA2fSBaYFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhc3MgbGluZSwgbGVmdCBkaXJlY3Rpb24sIHVwcGVyIHRvIGNlbnRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHNhbWUgYXMgdGhlIG90aGVyLCBidXQgcmVwbGFjZSB4IHdpdGggeG0gYW5kIHhtIHdpdGggeFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4fSwke3kgLSA2fSBMICR7eGIgLSBlfSwke3liIC0gNn0gSCAke3htICsgZX0gbCAwLDEyIEwgJHt4YiAtIGV9LCR7eWIgKyA2fSBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh5bSA+IHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGFzcyBsaW5lLCByaWdodCBkaXJlY3Rpb24sIHVwcGVyIHRvIGNlbnRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4IC0gZX0sJHt5IC0gNn0gSCAke3hiICsgZX0gTCAke3htfSwke3ltIC0gNn0gbCAwLDEyIEwgJHt4YiArIGV9LCR7eWIgKyA2fSBMICR7eCAtIGV9LCR7eSArIDZ9IFpgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGFzcyBsaW5lLCByaWdodCBkaXJlY3Rpb24sIGNlbnRlciB0byB1cHBlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHNhbWUgYXMgdGhlIG90aGVyLCBidXQgcmVwbGFjZSB4IHdpdGggeG0gYW5kIHhtIHdpdGggeFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYE0gJHt4fSwke3kgLSA2fSBMICR7eGIgLSBlfSwke3liIC0gNn0gSCAke3htICsgZX0gbCAwLDEyIEwgJHt4YiAtIGV9LCR7eWIgKyA2fSBMICR7eH0sJHt5ICsgNn0gWmBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZHJhdyB0aGUgbGluZSBpbiByYWlsbWFwXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gYWRkIGlkIHRvIGVsZW1lbnRcclxuICAgIGRyYXdMaW5lKCkge1xyXG4gICAgICAgICQoJy5ybWctbGluZScpLnJlbW92ZUNsYXNzKCdybWctbGluZV9fbXRyJykuYWRkQ2xhc3MoJ3JtZy1saW5lX19zaG1ldHJvJyk7XHJcblxyXG4gICAgICAgIHRoaXMuYnJhbmNoZXMubWFwKGJyYW5jaCA9PiB7XHJcbiAgICAgICAgICAgIHZhciBsaW5lTWFpblN0bnMgPSBicmFuY2guZmlsdGVyKHN0bklkID0+IHRoaXMuc3RhdGlvbnNbc3RuSWRdLnN0YXRlID49IDApO1xyXG4gICAgICAgICAgICB2YXIgbGluZVBhc3NTdG5zID0gYnJhbmNoLmZpbHRlcihzdG5JZCA9PiB0aGlzLnN0YXRpb25zW3N0bklkXS5zdGF0ZSA8PSAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5lUGFzc1N0bnMgPSBicmFuY2g7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChsaW5lTWFpblN0bnMuZmlsdGVyKHN0bklkID0+IGxpbmVQYXNzU3Rucy5pbmRleE9mKHN0bklkKSAhPT0gLTEpLmxlbmd0aCA9PSAwICYmIGxpbmVNYWluU3Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIHR3byBzZXQgZGlzam9pbnRcclxuICAgICAgICAgICAgICAgIGlmIChsaW5lUGFzc1N0bnNbMF0gPT09IGJyYW5jaFswXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIC0xIC0xIDEgMVxyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3Rucy5wdXNoKGxpbmVNYWluU3Ruc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmVNYWluU3Ruc1swXSA9PT0gYnJhbmNoWzBdICYmIGxpbmVNYWluU3Ruc1tsaW5lTWFpblN0bnMubGVuZ3RoIC0gMV0gPT09IGJyYW5jaFticmFuY2gubGVuZ3RoIC0gMV0gJiYgbGluZVBhc3NTdG5zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVQYXNzU3RucyA9IGJyYW5jaDtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lTWFpblN0bnMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMSAxIC0xIC0xXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZVBhc3NTdG5zLnVuc2hpZnQobGluZU1haW5TdG5zW2xpbmVNYWluU3Rucy5sZW5ndGggLSAxXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGRyYXcgdGhlIG1haW4gbGluZVxyXG4gICAgICAgICAgICBsZXQgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVNYWluU3RucywgJ21haW4nKVxyXG4gICAgICAgICAgICBpZiAocGF0aCB8fCBwYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjbGluZV9tYWluJykuYXBwZW5kKCQoJzxwYXRoPicsIHsgaWQ6ICdsaW5lX21haW5fcGF0aCcsIGQ6IHBhdGggfSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBkcmF3IHRoZSBwYXNzIGxpbmVcclxuICAgICAgICAgICAgcGF0aCA9IHRoaXMuX2xpbmVQYXRoKGxpbmVQYXNzU3RucywgJ3Bhc3MnKVxyXG4gICAgICAgICAgICBpZiAocGF0aCB8fCBwYXRoICE9ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcjbGluZV9wYXNzJykuYXBwZW5kKCQoJzxwYXRoPicsIHsgaWQ6ICdsaW5lX3Bhc3NfcGF0aCcsIGQ6IHBhdGggfSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoJyNsaW5lX21haW4nKS5odG1sKCQoJyNsaW5lX21haW4nKS5odG1sKCkpO1xyXG4gICAgICAgICQoJyNsaW5lX3Bhc3MnKS5odG1sKCQoJyNsaW5lX3Bhc3MnKS5odG1sKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpbGxUaGVtZUNvbG91cigpIHtcclxuICAgICAgICBzdXBlci5maWxsVGhlbWVDb2xvdXIoKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcyB3aWxsIGFkZCB0aGUgc3Ryb2tlIG9mIHRoZSBzdGF0aW9uIGNpcmNsZVxyXG4gICAgICAgIC8vIGhvd2V2ZXIgdGhlIHN0cm9rZSBwYXRoIGlzIGRlZmluZWQgaW4gaW5kZXguaHRtbFxyXG4gICAgICAgIC8vIHdoaWNoIG1hZGUgY2hhbmdpbmcgc3RhdGlvbiBzdHlsZSBzdHJhbmdlXHJcbiAgICAgICAgJCgncGF0aCMnICsgc3RhdGlvbl9pZCkuYXR0cignc3Ryb2tlJywgdGhpcy5fdGhlbWVDb2xvdXIpO1xyXG4gICAgICAgICQoJ3BhdGgjaW50Ml9zaCcpLmF0dHIoJ3N0cm9rZScsIHRoaXMuX3RoZW1lQ29sb3VyKTtcclxuXHJcbiAgICAgICAgLy8gcGFzcyBzdHJva2Ugc2hvdWxkIGJlIGFkZGVkIHNvbWV3aGVyZSBlbHNlXHJcbiAgICAgICAgLy8gYnV0IEkgY2FuJ3QgZmlndXJlIGl0IG91dFxyXG4gICAgICAgICQoJ3BhdGgjc3RuX3NoX3Bhc3MnKS5hdHRyKCdzdHJva2UnLCAnI2FhYScpO1xyXG4gICAgICAgICQoJ3BhdGgjaW50Ml9zaF9wYXNzJykuYXR0cignc3Ryb2tlJywgJyNhYWEnKTtcclxuXHJcbiAgICAgICAgLy8gdGhlIHJhaWxtYXAgbGluZVxyXG4gICAgICAgICQoJ3BhdGgjbGluZV9tYWluX3BhdGgnKS5hdHRyKCdmaWxsJywgdGhpcy5fdGhlbWVDb2xvdXIpXHJcbiAgICAgICAgJCgncGF0aCNsaW5lX3Bhc3NfcGF0aCcpLmF0dHIoJ2ZpbGwnLCAnI2FhYScpXHJcblxyXG4gICAgICAgIC8vIHRoZSBsYXN0IGRlY29yYXRpb24gbGluZVxyXG4gICAgICAgICQoYCNsaW5lX3NobWV0cm9fdXNlYCkuYXR0cignZmlsbCcsIHRoaXMuX3RoZW1lQ29sb3VyKVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fbGluZU5hbWVzWzBdLm1hdGNoKC8oXFxkKilcXHcrLykpIHtcclxuICAgICAgICAgICAgLy8gdGhlIGxpbmUgc3RhcnRzIHdpdGggbnVtYmVyXHJcbiAgICAgICAgICAgICQoJyNzdGF0aW9uX2luZm9fc2htZXRybyA+ICNsaW5lX251bWJlciA+IHRleHQnKS5hdHRyKCdmaWxsJywgJyNmZmYnKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRoZSBsaW5lIHN0YXJ0cyB3aXRoIGxldHRlclxyXG4gICAgICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9uYW1lX3RleHQnKS5hdHRyKCdmaWxsJywgJyNmZmYnKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gZGVzdCBpbmZvIGxpbmUgY29sb3JcclxuICAgICAgICAkKCcjc3RhdGlvbl9pbmZvX3NobWV0cm8gPiAjbGluZV9udW1iZXIgPiB0ZXh0JykuYXR0cignZmlsbCcsIHRoaXMuX2ZnQ29sb3VyKVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVN0bk5hbWVCZygpIHtcclxuICAgICAgICAkKCcjY3VycmVudF9iZycpLmhpZGUoKTsgIC8vIGZpeCB0aGUgbXlzdGVyaW91cyBibGFjayByZWN0XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIG1ha2Ugc3VyZSB0aGUgbGluZSBpcyBkcmF3IGJlZm9yZSBjb2xvclxyXG4gICAgc3RhdGljIGluaXRTVkcobGluZSkge1xyXG4gICAgICAgIGxpbmUuZHJhd1NWR0ZyYW1lKCk7XHJcbiAgICAgICAgbGluZS5zaG93RnJhbWVPdXRlcigpO1xyXG4gICAgICAgIGxpbmUuZHJhd1N0bnMoKTtcclxuXHJcbiAgICAgICAgLy8gY2hhbmdlIHRoZSBmdW5jIGNhbGwgaGVyZVxyXG4gICAgICAgIGxpbmUuZHJhd0xpbmUoKTtcclxuICAgICAgICBsaW5lLmZpbGxUaGVtZUNvbG91cigpO1xyXG4gICAgICAgIC8vIGNoYW5nZSB0aGUgZnVuYyBjYWxsIGhlcmVcclxuXHJcbiAgICAgICAgbGluZS5kcmF3U3RyaXAoKTtcclxuICAgICAgICBsaW5lLmRyYXdEZXN0SW5mbygpO1xyXG4gICAgICAgIGxpbmUubG9hZEZvbnRzKCk7XHJcbiAgICAgICAgbGluZS51cGRhdGVTdG5OYW1lQmcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2FsbCBmaWxsVGhlbWVDb2xvdXIgd2hlbiBmbGlwIGRpcmVjdGlvblxyXG4gICAgc2V0IGRpcmVjdGlvbih2YWwpIHtcclxuICAgICAgICBzdXBlci5kaXJlY3Rpb24gPSB2YWxcclxuXHJcbiAgICAgICAgdGhpcy5maWxsVGhlbWVDb2xvdXIoKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHJld3JpdGUgdGhpcyB0byBjYWxsIGZpbGxUaGVtZUNvbG91ciB3aGVuIHNldCBjdXJyZW50IHN0YXRpb25cclxuICAgIHNldCBjdXJyZW50U3RuSWQodmFsKSB7XHJcbiAgICAgICAgc3VwZXIuY3VycmVudFN0bklkID0gdmFsXHJcblxyXG4gICAgICAgIHRoaXMuZmlsbFRoZW1lQ29sb3VyKClcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gZ2V0IGRyYXdTdG5zIGFuZCByZWNhbGxlZFxyXG4gICAgdXBkYXRlU3RuVHJhbnNmZXIoc3RuSWQ6IElELCB0eXBlLCBpbmZvID0gbnVsbCkge1xyXG4gICAgICAgIHN1cGVyLnVwZGF0ZVN0blRyYW5zZmVyKHN0bklkLCB0eXBlLCBpbmZvKVxyXG5cclxuICAgICAgICB0aGlzLmZpbGxUaGVtZUNvbG91cigpXHJcblxyXG4gICAgICAgIC8vIGNsZWFyIHRoZSBvcmlnaW5hbCBzdGF0aW9uc1xyXG4gICAgICAgICQoJyNzdG5faWNvbnMnKS5lbXB0eSgpXHJcbiAgICAgICAgdGhpcy5kcmF3U3RucygpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmV3cml0ZSB0aGlzIHRvIGNhbGwgZmlsbFRoZW1lQ29sb3VyIHdoZW4gYWRkIHN0YXRpb25cclxuICAgIGFkZFN0bihwcmVwOiAnYmVmb3JlJyB8ICdhZnRlcicsIHN0bklkOiBJRCwgbG9jLCBlbmQ6IElEKTogW0lELCBTdGF0aW9uSW5mb10ge1xyXG4gICAgICAgIGxldCBbbmV3SWQsIG5ld0luZm9dID0gc3VwZXIuYWRkU3RuKHByZXAsIHN0bklkLCBsb2MsIGVuZClcclxuICAgICAgICB0aGlzLmZpbGxUaGVtZUNvbG91cigpXHJcbiAgICAgICAgcmV0dXJuIFtuZXdJZCwgbmV3SW5mb11cclxuICAgIH1cclxuXHJcbiAgICAvLyByZXdyaXRlIHRoaXMgdG8gY2hhbmdlIHRoZSByYWlsbWFwIHBvc2l0aW9uXHJcbiAgICBzZXQgeVBjKHZhbCkge1xyXG4gICAgICAgIHN1cGVyLnlQYyA9IHZhbFxyXG5cclxuICAgICAgICBsZXQgeSA9IHZhbCAqIHRoaXMuX3N2Z0hlaWdodCAvIDUwO1xyXG4gICAgICAgICQoJ2cjbWFpbicpLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoMCwke3l9KWApO1xyXG4gICAgfVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9